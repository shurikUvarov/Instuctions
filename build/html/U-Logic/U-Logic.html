

<!DOCTYPE html>
<html class="writer-html5" lang="ru" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>U-Logic &mdash; документация База знаний 1.0.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=e35015f7"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=cd1d70c9"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Алфавитный указатель" href="../genindex.html" />
    <link rel="search" title="Поиск" href="../search.html" />
    <link rel="next" title="UI-Designer" href="../UI-Designer.html" />
    <link rel="prev" title="Начало работы с контроллером Uvatron 3000PRO" href="../guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            База знаний
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Поиск в документации" aria-label="Поиск в документации" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Меню навигации">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Начало работы с контроллером Uvatron 3000PRO</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">U-Logic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Начало работы с U-Logic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Редактор</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Заголовок редактора</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Палитра узлов редактора</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Рабочее пространство редактора</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id64">Боковая панель редактора</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id84">Работа с сообщениями</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id85">Понимание сообщений U-Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id86">Что такое сообщения U-Logic?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id87">Анатомия сообщений U-Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id88">Типы данных в сообщениях U-Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id89">Как клонировать сообщения или свойства сообщений</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id91">Распространенные ошибки, которых следует избегать при работе с сообщениями U-Logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id92">Программирование</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id93">Преобразование данных</a></li>
<li class="toctree-l4"><a class="reference internal" href="#if-else">If-Else</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id103">Циклы</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id108">Терминология</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id109">Поток</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id110">Подпоток</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id111">Рабочее пространство</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id112">Узел</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id113">Провода</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id114">Порты входа и выхода</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id115">Сообщение</a></li>
<li class="toctree-l3"><a class="reference internal" href="#payload">Payload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id116">Контекст</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id117">Узел function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id118">Палитра узлов</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id119">Редактор</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id120">Экземпляр</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id121">Развертывание потока</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id122">Импорт, экспорт, группировка потоков</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id123">Горячие клавиши U-Logic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id124">Общие горячие клавиши</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id125">Рабочая область</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id126">Вкладка потока</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id127">Группа</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id128">Узел</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id129">Провод</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id130">Выделение</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id131">Пользовательские горячие клавиши</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id132">Как настроить пользовательские горячие клавиши:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id133">Узлы</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id134">общие</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inject">inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debug">debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complete">complete</a></li>
<li class="toctree-l4"><a class="reference internal" href="#catch">catch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#status">status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#link">link</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comment">comment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id170">функция</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id171">function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id181">switch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id188">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#range">range</a></li>
<li class="toctree-l4"><a class="reference internal" href="#template">template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delay">delay</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trigger">trigger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id224">сеть</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#http-request">http request</a></li>
<li class="toctree-l4"><a class="reference internal" href="#websocket">websocket</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tcp">tcp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#udp">udp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id249">последоват-ть</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#split">split</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sort">sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="#batch">batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#join">join</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id278">анализатор</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../UI-Designer.html">UI-Designer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UI-Panel.html">UI-Panel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Часто задаваемые вопросы</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Меню навигации для мобильных устройств" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">База знаний</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Навигация по страницам">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">U-Logic</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="u-logic">
<h1>U-Logic<a class="headerlink" href="#u-logic" title="Ссылка на этот заголовок"></a></h1>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Вся логика, включая логику интерфейса, программируется в <strong>U-Logic</strong>.
Для доступа к U-Logic откройте в браузере страницу <strong>&lt;IP Контроллера&gt;:1880</strong>.</p>
</div>
<section id="id1">
<h2>Начало работы с U-Logic<a class="headerlink" href="#id1" title="Ссылка на этот заголовок"></a></h2>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>За работу графического интерфейса отвечает узел <strong>UI Control Panel</strong>.
Без этого узла графический интерфейс панели управления неактивен и недоступен.</p>
</div>
<ol class="arabic simple">
<li><p>Для инициализации интерфейса добавьте узел <strong>UI Control Panel</strong> в рабочую область.</p></li>
</ol>
<p><img alt="Добавление узла UI Control Panel" src="../_images/ADDUIPanelNode.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Откройте его настройки, дважды кликнув на него. В появившемся окне нажмите на кнопку «+»</p></li>
</ol>
<p><img alt="Настройка узла UI Control Panel" src="../_images/EditNodeUI.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Напротив поля «Path», добавьте конфигурацию <code class="docutils literal notranslate"><span class="pre">\web-client</span></code>, примените настройки узла и запустите поток <strong>U-Logic</strong>.</p></li>
</ol>
<p>Используйте только один экземпляр узла UI Control Panel для работы всех графических интерфейсов; не дублируйте и не
создавайте новые экземпляры. В U-Logic по умолчанию включены все необходимые узлы для работы с популярными
протоколами, а также дополнительные вспомогательные узлы. Для каждого узла есть описание и примеры его использования.
Если возможностей узлов недостаточно для взаимодействия с оборудованием, в U-Logic включены библиотеки, которые можно использовать в узлах <strong>function</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="p">:</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;ws&quot;</span><span class="p">),</span>
<span class="n">ssh2</span><span class="p">:</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;ssh2&quot;</span><span class="p">),</span>
<span class="n">http</span><span class="p">:</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;node:http&quot;</span><span class="p">),</span> 
<span class="n">net</span><span class="p">:</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;node:net&quot;</span><span class="p">),</span> 
<span class="n">tls</span><span class="p">:</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;node:tls&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="id2">
<h3>Редактор<a class="headerlink" href="#id2" title="Ссылка на этот заголовок"></a></h3>
<p><img alt="Компоненты U-Logic" src="../_images/about.png" /></p>
<p><strong>Окно редактора <em>U-Logic</em> состоит из четырех компонентов:</strong></p>
<ol class="arabic simple">
<li><p>Заголовок вверху содержит кнопку развернуть, главное меню, аутентификация пользователя, меню пользователя.</p></li>
<li><p>Палитра узлов слева содержит доступные для использования узлы.</p></li>
<li><p>Основное рабочее пространство посередине, где создаются потоки.</p></li>
<li><p>Боковая панель справа.</p></li>
</ol>
<section id="id3">
<h4>Заголовок редактора<a class="headerlink" href="#id3" title="Ссылка на этот заголовок"></a></h4>
<section id="id4">
<h5>Компонент заголовка редактора U-Logic<a class="headerlink" href="#id4" title="Ссылка на этот заголовок"></a></h5>
<p>Заголовок редактора U-Logic — это центральный компонент, который упрощает навигацию по основным настройкам U-Logic, предоставляет кнопку развертывания для выполнения потоков и доступ к профилю пользователя.</p>
<p><img alt="Заголовок редактора" src="../_images/header.png" /></p>
</section>
<section id="id5">
<h5>Кнопка развертывания<a class="headerlink" href="#id5" title="Ссылка на этот заголовок"></a></h5>
<p>С правой стороны заголовка вы найдете красную кнопку развертывания. Нажатие на нее запускает все потоки в экземпляре. Красный цвет указывает на ожидающие изменения для развертывания, а серый — на отсутствие ожидающих изменений.</p>
<p><img alt="Красная кнопка &quot;Развернуть&quot;" src="../_images/deploy_red.png" /></p>
<p><img alt="Серая кнопка &quot;Развернуть&quot;" src="../_images/deploy_grey.png" /></p>
<p>Чтобы развернуть все в рабочей обалсти, или только потоки, содержащие измененные узлы, или только узлы, которые были изменены, или перезапустить развернутые потоки, нажмите на значок раскрытия кнопки развертывания. Выберите предпочитаемый вариант и затем нажмите кнопку развертывания соответственно</p>
<p><img alt="Вариант развертывания" src="../_images/deploy_type.png" /></p>
</section>
<section id="id6">
<h5>Главное меню<a class="headerlink" href="#id6" title="Ссылка на этот заголовок"></a></h5>
<p>Сразу после профиля пользователя в правом углу вы увидите значок меню. Нажав на него, вы откроете список опций, которые упрощают работу с U-Logic.</p>
<p>Ниже приведены опции, доступные в главном меню.</p>
<section id="edit">
<h6>Edit<a class="headerlink" href="#edit" title="Ссылка на этот заголовок"></a></h6>
<p>Первая опция в меню позволяет выполнять основные действия по редактированию. Наведение на нее открывает дополнительные опции, такие как «Отменить последнее выполненное изменение», «Выбрать все узлы», «Скопировать выбранные узлы» и т. д.</p>
<p><img alt="Опция Edit в главном меню" src="../_images/edit.png" /></p>
<ul class="simple">
<li><p><strong>Отменить последнее выполненное изменение</strong>: Отменяет последнее действие или серию действий, выполненных в редакторе.</p></li>
<li><p><strong>Redo</strong>: Повторно применяет действие, которое было ранее отменено с помощью команды «Отменить последнее выполненное изменение».</p></li>
<li><p><strong>Вырезать выбранные узлы</strong>: Удаляет выбранные узлы из рабочей области и временно сохраняет их в буфере обмена.</p></li>
<li><p><strong>Скопировать выбранные узлы</strong>: Сохраняет дубликат выбранных узлов в буфере обмена, не удаляя их из исходного потока.</p></li>
<li><p><strong>Вставить узлы</strong>: Позволяет вставлять скопированные или вырезанные узлы из буфера обмена обратно в рабочий процесс.</p></li>
<li><p><strong>Copy group style</strong>: Сохраняет стиль выбранной группы в буфере обмена.</p></li>
<li><p><strong>Paste group style</strong>: Применяет сохраненный стиль группы к другой выбранной группе.</p></li>
<li><p><strong>Выбрать все узлы</strong>: Выбирает все группы потоков в текущей рабочей области.</p></li>
<li><p><strong>Выбрать все соединенные узлы</strong>: Выбирает узлы, подключенные к текущим выбранным узлам.</p></li>
<li><p><strong>Select none</strong>: Отменяет выбор всех выбранных узлов или групп.</p></li>
<li><p><strong>split selection with Link nodes</strong>: Соединяет выбранные узлы с помощью узлов связи.</p></li>
</ul>
</section>
<section id="id7">
<h6>Вид<a class="headerlink" href="#id7" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция позволяет управлять отображением и видимостью различных элементов интерфейса в редакторе U-Logic и обеспечивает беспрепятственный доступ к этим элементам.</p>
<p><img alt="Опция View в главном меню" src="../_images/view.png" /></p>
<ul class="simple">
<li><p><strong>Показывать палитру</strong>: переключает видимость палитры U-Logic</p></li>
<li><p><strong>Показывать боковую панель</strong>: включает и выключает видимость боковой панели.</p></li>
<li><p><strong>Журнал событий</strong>: открывает журнал, в котором регистрируются события и действия в U-Logic.</p></li>
<li><p><strong>Список действий</strong>: предоставляет список доступных действий или задач в U-Logic, что позволяет быстро получить доступ к часто используемым операциям и функциям.</p></li>
<li><p><strong>Отладочные сообщения</strong>: отображает сообщения, сгенерированные узлами отладки.</p></li>
</ul>
</section>
<section id="arrange">
<h6>Arrange<a class="headerlink" href="#arrange" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция позволяет вам упорядочивать и управлять выбранными группами потоков в рабочем пространстве U-Logic:</p>
<p><img alt="Опция Arrange в главном меню" src="../_images/arrange.png" /></p>
<ul class="simple">
<li><p><strong>Align to Left</strong>: Выравнивает выбранные группы потоков по левому краю рабочей области.</p></li>
<li><p><strong>Align to Center</strong>: Центрирует выбранные группы потоков по горизонтали в рабочей области.</p></li>
<li><p><strong>Align to Right</strong>: Выравнивает выбранные группы потоков по правому краю рабочей области.</p></li>
<li><p><strong>Align to Top</strong>: Выравнивает выбранные группы потоков по верхнему краю рабочей области.</p></li>
<li><p><strong>Align to Middle</strong>: Центрирует выбранные группы потоков по вертикали в рабочей области.</p></li>
<li><p><strong>Align to Bottom</strong>: Выравнивает выбранные группы потоков по нижнему краю рабочей области.</p></li>
<li><p><strong>Distribute Vertically</strong>: Равномерно распределяет выбранные группы потоков по вертикали в рабочей области.</p></li>
<li><p><strong>Distribute Horizontally</strong>: Равномерно распределяет выбранные группы потоков по горизонтали в рабочей области.</p></li>
<li><p><strong>Move Back</strong>: Перемещает выбранные группы потоков на один слой назад в порядке наложения.</p></li>
<li><p><strong>Move Front</strong>: Перемещает выбранные группы потоков на один слой вперед в порядке наложения.</p></li>
<li><p><strong>Move Backward</strong>: Перемещает выбранные группы потоков на одну позицию назад в порядке наложения.</p></li>
<li><p><strong>Move Forward</strong>: Перемещает выбранные группы потоков на одну позицию вперед в порядке наложения.</p></li>
</ul>
</section>
<section id="id8">
<h6>Импорт<a class="headerlink" href="#id8" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция позволяет импортировать файл приложения <code class="docutils literal notranslate"><span class="pre">flow.json</span></code>. Вам доступны два основных метода импорта: вы можете использовать поле «Буфер обмена» или загрузить файл из локальной системы, нажав «выберите файл для импорта».</p>
<p><img alt="Опция Import в главном меню" src="../_images/import.png" /></p>
<p>Кроме того, снизу можно выбрать область, в которой поток должен импортироваться:</p>
<ul class="simple">
<li><p><strong>текущий поток</strong>: Выбор «текущий поток» импортирует поток в существующую рабочую область.</p></li>
<li><p><strong>новый поток</strong>: Выбор «новый поток» создаст новое рабочее пространство для импортированного потока после нажатия кнопки импорта.</p></li>
</ul>
<p>С левой стороны после буфера обмена вы найдете две опции:</p>
<ul class="simple">
<li><p><strong>Локальные</strong>: Здесь вы можете просмотреть локальную библиотеку потоков, которая содержит потоки, созданные в том же экземпляре U-Logic. Эта библиотека доступна только из того же экземпляра, где были созданы потоки.</p></li>
<li><p><strong>Примеры</strong>: В этом разделе содержатся примеры потоков для всех основных узлов.</p></li>
</ul>
</section>
<section id="id9">
<h6>Экспорт<a class="headerlink" href="#id9" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция позволяет экспортировать созданный вами поток приложений. Обычно она предоставляет две основные опции: «Скопировать в буфер обмена», которая позволяет копировать <code class="docutils literal notranslate"><span class="pre">flow.json</span></code>, и «Скачать», которая загружает <code class="docutils literal notranslate"><span class="pre">flow.json</span></code> файл.</p>
<p><img alt="Export 1" src="../_images/export.png" /></p>
<p>Кроме того, вы можете выбрать область, из которой будет экспортироваться поток приложений, из верхних опций:</p>
<p><img alt="Export 2" src="../_images/export2.png" /></p>
<ul class="simple">
<li><p><strong>выбранные узлы</strong>: Выбор этой опции позволяет экспортировать только выбранные узлы из потока.</p></li>
<li><p><strong>текущий поток</strong>: Выбор этой опции позволяет экспортировать приложение из текущей рабочей области потока.</p></li>
<li><p><strong>все потоки</strong>: Выбор этой опции позволяет экспортировать поток из всех потоков в данном экземпляре.</p></li>
</ul>
<p>В верхней части вы увидите две вкладки:</p>
<ul class="simple">
<li><p><strong>Экспортировать узлы</strong>: Эта вкладка позволяет увидеть узлы и потоки, которые вы собираетесь экспортировать.</p></li>
<li><p><strong>JSON</strong>: Эта вкладка покажет поток в формате JSON, который вы собираетесь экспортировать.</p></li>
</ul>
<p><img alt="Export 3" src="../_images/export3.png" /></p>
<ul class="simple">
<li><p><strong>компактно</strong>: Это уплотнит ваш JSON-файл потока в одну строку.</p></li>
<li><p><strong>форматированно</strong>: Это отформатирует JSON-файл потока, сделав его более удобным для чтения или проверки.</p></li>
</ul>
<p>С левой стороны после буфера обмена вы найдете еще опцию:</p>
<p><img alt="Export 4" src="../_images/export4.png" /></p>
<p><strong>Локальные:</strong> Эта опция позволяет создать коллекцию потоков, которые вы создали в текущем экземпляре U-Logic. Вы можете создать новую папку, нажав на значок с тремя точками в правом верхнем углу и выбрав «Новая папка». Кроме того, внизу вы найдете поле ввода, которое позволяет изменить имя файла потока. Нажатие на «Экспорт в библиотеку» сохранит его в коллекции. Теперь вы можете получить доступ к своей коллекции в том же экземпляре.</p>
</section>
<section id="id10">
<h6>Поиск в потоках<a class="headerlink" href="#id10" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Search Flows 1" src="../_images/search_flows.png" /></p>
<p><img alt="Search Flows 2" src="../_images/search_flows2.png" /></p>
<p>Эта опция позволяет выполнять поиск групп потоков, созданных в этом экземпляре U-Logic.</p>
</section>
<section id="id11">
<h6>Конфигурационные узлы<a class="headerlink" href="#id11" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Configuration Nodes" src="../_images/configuration_nodes.png" /></p>
<p>При нажатии на эту опцию откроется вкладка «конфиг» боковой панели, которая позволит вам управлять всеми узлами конфигурации текущего экземпляра U-Logic.</p>
</section>
<section id="id12">
<h6>Потоки<a class="headerlink" href="#id12" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Flows 1" src="../_images/flows.png" /></p>
<p>Эта опция позволяет управлять вкладками потока.</p>
<ul class="simple">
<li><p><strong>Добавить</strong>: добавляет новую вкладку потока.</p></li>
<li><p><strong>Edit</strong>: Редактирует текущую вкладку потока.</p></li>
<li><p><strong>Удалить</strong>: удаляет текущую вкладку потока.</p></li>
</ul>
</section>
<section id="id13">
<h6>Подпотоки<a class="headerlink" href="#id13" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Flows 2" src="../_images/subflows.png" /></p>
<p>Эта опция позволяет создать подпоток.</p>
<ul class="simple">
<li><p><strong>Создать подпоток</strong>: создает новую вкладку подпотока.</p></li>
<li><p><strong>Выделение в подпоток</strong>: преобразует выбранные узлы в подпоток.</p></li>
</ul>
</section>
<section id="id14">
<h6>Группы<a class="headerlink" href="#id14" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Groups" src="../_images/groups.png" /></p>
<p>Эта опция позволяет управлять группами потоков.</p>
<ul class="simple">
<li><p><strong>Сгруппировать выделение</strong>: группирует выбранные узлы.</p></li>
<li><p><strong>Разгруппировать выделение</strong>: разгруппирует выбранную группу потоков.</p></li>
<li><p><strong>Объединить выделение</strong>: объединяет выбранные группы потоков.</p></li>
<li><p><strong>Удалить из группы</strong>: удаляет выбранные узлы из группы.</p></li>
</ul>
</section>
<section id="id15">
<h6>Параметры<a class="headerlink" href="#id15" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Settings" src="../_images/settings.png" /></p>
<ul class="simple">
<li><p><strong>Вид</strong>: настройка параметров редактора и параметров интерфейса.</p>
<ul>
<li><p><strong>Язык</strong>: выберите язык для редактора U-Logic.</p></li>
<li><p><strong>Restore zoom level on load</strong>: включение этой опции восстановит уровень масштабирования редактора при загрузке U-Logic.</p></li>
<li><p><strong>Restore scroll position on load</strong>: включение этой опции восстановит позицию прокрутки редактора при загрузке U-Logic.</p></li>
<li><p><strong>Показывать сетку</strong>: включите отображение сетки в рабочей области редактора.</p></li>
<li><p><strong>Привязывать к сетке</strong>: включите привязку узлов к сетке.</p></li>
<li><p><strong>Размер сетки</strong>: отрегулируйте размер квадратов сетки.</p></li>
<li><p><strong>Показать статус узла</strong>: переключите, чтобы отобразить статус узлов в редакторе.</p></li>
<li><p><strong>Показывать метки у недавно добавленных узлов</strong>: переключите, чтобы метки недавно добавленных узлов стали видимыми</p></li>
<li><p><strong>Показать советы</strong>: переключите, чтобы отобразить подсказки в редакторе.</p></li>
<li><p><strong>Show guided tours for new versions</strong>: включите пошаговые руководства для новых версий U-Logic.</p></li>
</ul>
</li>
</ul>
<!-- - **Палитра**: эта опция управления палитрой узлов позволяет управлять узлами, доступными в вашей среде U-Logic. -->
<ul class="simple">
<li><p><strong>Клавиши</strong>: настройте сочетания клавиш для эффективной навигации и работы в U-Logic.</p></li>
</ul>
<!-- - **Enviroment**: Управление переменными среды, используемыми в потоках U-Logic. Это включает в себя настройку, редактирование и удаление переменных, к которым узлы могут получить доступ во время выполнения.

  ![Enviroment](../_static/U-Logic/Getting_Started/header/enviroment.png)

  - **+ добавить**: Добавляет новую переменную среды.
  - **x**: Удалить соответствующие переменные среды.
  - **Revert**: отменяет изменения, внесенные в переменные среды. -->
</section>
<section id="id16">
<h6>Сочетание клавиш<a class="headerlink" href="#id16" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция перенаправляет вас в интерфейс, где вы можете настроить сочетания клавиш для эффективной навигации и работы в экземпляре U-Logic.</p>
</section>
<section id="id17">
<h6>Вебсайт U-Logic<a class="headerlink" href="#id17" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция перенаправит вас на официальный сайт U-Logic.</p>
</section>
<section id="v4-0-9">
<h6>v4.0.9<a class="headerlink" href="#v4-0-9" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция отображает журнал изменений для текущей версии U-Logic на вкладке «Change Log» боковой панели, подробно описывая, что было изменено или исправлено по сравнению с предыдущими версиями.</p>
</section>
</section>
</section>
<section id="id18">
<h4>Палитра узлов редактора<a class="headerlink" href="#id18" title="Ссылка на этот заголовок"></a></h4>
<p>Палитра узлов — это левая боковая панель, которая содержит все доступные узлы.</p>
<section id="id19">
<h5>Панель поиска<a class="headerlink" href="#id19" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Search bar" src="../_images/search.png" /></p>
<p>Расположенная в верхней части палитры строка фильтра узлов позволяет быстро находить узлы по их названию.</p>
</section>
<section id="id20">
<h5>Категории узлов<a class="headerlink" href="#id20" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Node categories" src="../_images/categories.png" /></p>
<p>Палитра узлов разделена на несколько категорий, каждая из которых содержит коллекции узлов. Подпотоки категоризируются в разделе «Подпотоки».</p>
<p>Вы можете свернуть или развернуть категории, нажав на нужную категорию.</p>
<section id="id21">
<h6>Свернуть все категории<a class="headerlink" href="#id21" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Collapse All Categories" src="../_images/collapse.png" /></p>
<p>Внизу палитры вы найдете два значка со стрелками. Нажатие на левый значок со стрелкой вверх свернёт все категории.</p>
</section>
</section>
<section id="id22">
<h5>Развернуть все категории<a class="headerlink" href="#id22" title="Ссылка на этот заголовок"></a></h5>
<p>Нажатие на значок со стрелкой вниз развернет все категории обратно в состояние по умолчанию.</p>
</section>
<section id="id23">
<h5>Показать/скрыть палитру<a class="headerlink" href="#id23" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Toggle Palette" src="../_images/toggle.png" /></p>
<p>Нажатие этой кнопки скрывает боковую панель палитры. Чтобы снова ее отобразить, нажмите на кнопку еще раз.</p>
</section>
</section>
<section id="id24">
<h4>Рабочее пространство редактора<a class="headerlink" href="#id24" title="Ссылка на этот заголовок"></a></h4>
<p>Рабочая область — это основная область редактора, в которой вы создаете потоки приложений, перетаскивая узлы из палитры.</p>
<p><img alt="Workspace" src="../_images/workspace.png" /></p>
<section id="id25">
<h5>Просмотреть инструменты<a class="headerlink" href="#id25" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="View Tools" src="../_images/tools.png" /></p>
<p>В рабочем пространстве в правом нижнем углу есть инструменты просмотра. Сюда входят кнопки увеличения (<code class="docutils literal notranslate"><span class="pre">Ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">+</span></code>) и уменьшения (<code class="docutils literal notranslate"><span class="pre">Ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">-</span></code>) для управления видом рабочего пространства и сброса уровня масштабирования до значения по умолчанию.</p>
<p><img alt="View Tools" src="../_images/map.png" /></p>
<p>Кроме того, он предоставляет навигатор представлений, который позволяет вам видеть уменьшенное изображение всего рабочего пространства. В этом представлении вы также можете видеть текущую видимую область рабочего пространства в редакторе. Чтобы перейти к определенной области рабочего пространства, щелкните эту область в навигаторе представлений.</p>
</section>
<section id="search-flows">
<h5>Search flows<a class="headerlink" href="#search-flows" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Search Flow" src="../_images/search1.png" /></p>
<p><img alt="Search Flow" src="../_images/search2.png" /></p>
<p>В левом нижнем углу рабочей области вы увидите значок поиска. Нажатие на него откроет всплывающее окно, позволяющее быстро искать потоки в вашем экземпляре U-Logic по их имени. Вы можете открыть это диалоговое окно, нажав <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> + <code class="docutils literal notranslate"><span class="pre">F</span></code>.</p>
</section>
<section id="id26">
<h5>Поток<a class="headerlink" href="#id26" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Flow" src="../_images/flows1.png" /></p>
<p>Поток представлен в виде вкладки в рабочей области редактора, предоставляя новое рабочее пространство для создания приложений путем соединения узлов. «Поток» также неформально используется для описания одного набора соединенных узлов. Таким образом, поток (вкладка) может содержать несколько потоков (наборов соединенных узлов), но формально поток является родительской группой нескольких соединенных узлов. Поток может иметь имя и описание, которые будут отображаться на информационной боковой панели.</p>
<section id="id27">
<h6>Добавление потока<a class="headerlink" href="#id27" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Adding a Flow" src="../_images/flow_add.png" /></p>
<p>Чтобы создать родительский поток, нажмите на значок «+» в правом верхнем углу, или воспользуйтесь опцией добавления потока в главном меню при помощи раздела «Потоки»</p>
</section>
<section id="id28">
<h6>Редактирование свойств поиска<a class="headerlink" href="#id28" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing a flow properties" src="../_images/flow_edit.png" /></p>
<p>Чтобы изменить свойства потока, дважды щелкните вкладку потока, чтобы ввести его имя и описание в появившейся всплывающей форме.</p>
</section>
<section id="id29">
<h6>Удаление потока<a class="headerlink" href="#id29" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Deleting a flow" src="../_images/flow_delete2.png" /></p>
<p>Чтобы удалить поток, дважды щелкните по нему. В появившемся всплывающем окне нажмите кнопку «Удалить» в верхнем левом углу.</p>
<p><img alt="Deleting a flow" src="../_images/flow_delete.png" /></p>
<p>Либо щелкните правой кнопкой мыши вкладку потока и выберите в меню пункт «Удалить».</p>
</section>
<section id="id30">
<h6>Включение и выключение потоков<a class="headerlink" href="#id30" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Enabling and Disabling Flows" src="../_images/flow_enable.png" /></p>
<p>Чтобы включить или отключить поток, дважды щелкните на вкладке потока. Нажмите кнопку «Отключено» в нижнем левом углу или кнопку «Включено», если он уже отключен.</p>
<p><img alt="Enabling and Disabling Flows" src="../_images/flow_enable2.png" /></p>
<p>Либо щелкните правой кнопкой мыши по вкладке потока и выберите в меню «Disable flow/Enable flow». Отключенные потоки не выполняются при развертывании.</p>
</section>
<section id="id31">
<h6>Переупорядочение потоков<a class="headerlink" href="#id31" title="Ссылка на этот заголовок"></a></h6>
<p>Потоки можно переупорядочить, щелкнув и перетащив вкладку потока в нужную позицию. Дополнительные параметры меню вкладки потока можно получить, щелкнув значок раскрывающейся стрелки в правом верхнем углу.</p>
</section>
</section>
<section id="id32">
<h5>Подпоток<a class="headerlink" href="#id32" title="Ссылка на этот заголовок"></a></h5>
<!-- создание gif -->
<p><img alt="Subflow" src="../_images/subflow.png" /></p>
<p>Подпоток в U-Logic — это набор узлов, которые свернуты в один узел в рабочей области. Он позволяет группировать набор узлов в повторно используемую единицу. Это помогает в организации потоков, содействии повторному использованию и упрощении сложных конструкций потоков путем инкапсуляции нескольких узлов в единое представление узла более высокого уровня.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Подпоток не может содержать экземпляр самого себя — ни напрямую, ни косвенно.</p>
</div>
<section id="id33">
<h6>Создание подпотока<a class="headerlink" href="#id33" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Creating a Subflow" src="../_images/subflow_add.png" /></p>
<p>Чтобы создать подпоток, в разделе «Подпотоки» выберите «Создать подпоток» в главном меню.</p>
<p><img alt="Creating a Subflow" src="../_images/subflow_add2.png" /></p>
<p>Он создаст для вас окно подпотока, похожее на вкладку потока.</p>
</section>
<section id="id34">
<h6>Редактирование подпотока<a class="headerlink" href="#id34" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing a Subflow" src="../_images/subflow_edit.png" /></p>
<p>Чтобы открыть диалоговое окно редактирования подпотока, дважды щелкните по узлу подпотока, затем щелкните «Изменить шаблон подпотока». Вы можете дать имя для этого подпотока, добавить описание, щелкнув в правом верхнем углу</p>
<p><img alt="Editing a Subflow" src="../_images/subflow_edit2.png" /></p>
<p>опцию «Описание», а также настроить внешний вид, нажав на опцию «Внешний вид» в правом верхнем углу.</p>
<p><img alt="Editing a Subflow" src="../_images/subflow_lookup.png" /></p>
</section>
<section id="id35">
<h6>Удаление подпотока<a class="headerlink" href="#id35" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Deleting a Subflow" src="../_images/subflow_delete.png" /></p>
<p>Чтобы удалить подпоток, нажмите кнопку «удалить подпоток» в верхней части вкладки подпотока.</p>
</section>
<section id="id36">
<h6>Преобразование узлов в подпоток<a class="headerlink" href="#id36" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Converting Nodes into a Subflow" src="../_images/subflow_from_nodes.png" /></p>
<p>Если у вас есть узлы на рабочем пространстве и вы хотите создать из них подпоток, вы можете выбрать их, нажав левую клавишу мыши и нарисовав вокруг них прямоугольник. Затем нажмите на <code class="docutils literal notranslate"><span class="pre">Подпотоки</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Выделение</span> <span class="pre">в</span> <span class="pre">подпоток</span></code> в главном меню.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Провода, входящие в выборку, должны быть подключены к одному узлу, поскольку результирующий узел подпотока может иметь не более одного входа.</p>
</div>
</section>
<section id="id37">
<h6>Входы и выходы<a class="headerlink" href="#id37" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Inputs and Outputs" src="../_images/subflow_io.png" /></p>
<p>Входы и выходы подпотока изображены серыми квадратными узлами, которые могут быть соединены в рабочем пространстве подпотока как обычные узлы. Верхняя панель инструментов предлагает функции для добавления и удаления этих узлов. Подобно узлам обычного потока, каждый подпоток может иметь максимум один вход, но может вмещать несколько выходов.</p>
</section>
<section id="id38">
<h6>Статус узла<a class="headerlink" href="#id38" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Status Node" src="../_images/subflow_status.png" /></p>
<p>Узел Status используется для обновления статуса подпотока. Этот узел статуса можно редактировать как обычные узлы потока. Этот узел использует входные данные, <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> которые могут быть либо простой строкой, либо объектом Status.</p>
</section>
</section>
<section id="id39">
<h5>Узлы<a class="headerlink" href="#id39" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Nodes" src="../_images/node.png" /></p>
<p>Узел — это фундаментальный строительный блок, используемый для создания потоков. Каждый узел представляет собой отдельную часть функциональности или определенное действие, которое может быть выполнено в потоке.</p>
<p><img alt="Node Explanation" src="../_images/node_io.png" /></p>
<p>Узлы могут иметь один входной и несколько выходных портов, соединенных проводами, которые определяют поток данных внутри потоков. Как входные, так и выходные узлы могут подключаться к нескольким проводам.</p>
<p><img alt="Node Buttons" src="../_images/node_buttons.png" /></p>
<p>Некоторые узлы имеют кнопки либо слева, либо справа. Например, узел inject имеет кнопку слева, а узел debug — справа. Функция этих кнопок различается между узлами.</p>
<!-- 
![]() -->
<p>Кроме того, некоторые узлы отображают статус внизу со значками, указывающими на их статус выполнения.</p>
<p><img alt="Node Error" src="../_images/node_error.png" /></p>
<p><img alt="Node Deploy" src="../_images/node_deploy.png" /></p>
<p>Все узлы в U-Logic обозначают ошибки красным треугольником, неразвернутые изменения — синим кружком.</p>
<section id="id40">
<h6>Добавление узлов в рабочее пространство<a class="headerlink" href="#id40" title="Ссылка на этот заголовок"></a></h6>
<p>Добавить узлы в рабочую область можно тремя способами:</p>
<p><strong>Перетаскивание из палитры</strong></p>
<p>Узлы можно добавлять из палитры узлов U-Logic, перетаскивая их на рабочую область.</p>
<p><strong>Использование диалогового окна быстрого добавления</strong></p>
<p>Редактор U-Logic предоставляет быстрый и простой способ добавления узлов с помощью палитры:</p>
<p><img alt="Using Quick-Add Dialog" src="../_images/node_palette.png" /></p>
<ul class="simple">
<li><p>Нажмите <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code>/<code class="docutils literal notranslate"><span class="pre">⌘</span></code> и щелкните по рабочей области.</p></li>
<li><p>Выберите нужный узел в диалоговом окне, которое содержит все доступные узлы из основной палитры узлов.</p></li>
<li><p>Используйте строку поиска для быстрого поиска узлов.</p></li>
</ul>
<p>При рисовании провода от одного узла оставьте провод на рабочем пространстве, чтобы подключить его к узлу, который будет добавлен с помощью того же диалогового окна быстрого добавления.</p>
<p><strong>Импорт из библиотеки или буфера обмена</strong></p>
<p>Узлы также можно добавлять, импортируя их из командной или локальной библиотеки или используя буфер обмена (<code class="docutils literal notranslate"><span class="pre">главное</span> <span class="pre">меню</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">импорт</span></code>).</p>
</section>
<section id="id41">
<h6>Редактирование свойств узла<a class="headerlink" href="#id41" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing Node Properties" src="../_images/node_edit.png" /></p>
<p>Чтобы настроить свойства узла, дважды щелкните по нему или выберите узел и нажмите <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. Появится всплывающая форма для настройки узла. Параметры конфигурации различаются в зависимости от типа узла.</p>
<p><img alt="Editing Node Properties" src="../_images/node_edit2.png" /></p>
<ul class="simple">
<li><p>При нажатии на вторую из трех опций в правом верхнем углу открывается вкладка «Описание», позволяющая написать описание в формате Markdown, которое будет отображаться на боковой панели информации.</p></li>
</ul>
<p><img alt="Editing Node Properties" src="../_images/node_edit3.png" /></p>
<ul class="simple">
<li><p>При нажатии на третий параметр открывается вкладка для изменения внешнего вида узла, например, для изменения значков, присвоения имен входным и выходным портам и переключения видимости меток.</p></li>
</ul>
</section>
<section id="id42">
<h6>Включение и отключение узлов<a class="headerlink" href="#id42" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing Node Properties" src="../_images/node_enable.png" /></p>
<p>Чтобы включить или отключить узлы, дважды щелкните по узлу и нажмите нижнюю кнопку «Включено» или кнопку «Отключено», если они уже включены.</p>
</section>
<section id="node">
<h6>Доступ к справочной информации Node<a class="headerlink" href="#node" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing Node Properties" src="../_images/node_info.png" /></p>
<p>Чтобы получить доступ к справочной информации об узле, дважды щелкните по узлу и щелкните нижний левый значок «Показать справку», который отображает информацию, связанную с этим узлом, на информационной боковой панели.</p>
</section>
<section id="id43">
<h6>Конфигурационные узлы<a class="headerlink" href="#id43" title="Ссылка на этот заголовок"></a></h6>
<p>Узлы конфигурации в U-Logic хранят конфигурации, общие для нескольких узлов в потоке.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Узлы конфигурации не шифруют данные после конфигурации, что потенциально может раскрыть конфиденциальную информацию при неправильном распространении.</p>
</div>
<p>Узлы конфигурации можно добавлять с помощью диалогового окна редактирования узлов, требующих настройки:</p>
<p><img alt="Configuration Nodes" src="../_images/node_conf.png" /></p>
<ul class="simple">
<li><p>Нажмите на значок «+» рядом со значком карандаша и полем с текстом.</p></li>
<li><p>Введите необходимую информацию в диалоговом окне редактирования и нажмите «Добавить».</p></li>
</ul>
<p>Узлы конфигурации не видны в рабочей области, как другие узлы, но ими можно управлять на вкладке узлов конфигурации на боковой панели.</p>
<p><img alt="Configuration Nodes" src="../_images/node_count.png" /></p>
<p>Чтобы узнать, сколько узлов используют определенную конфигурацию, проверьте информацию в нижнем колонтитуле диалогового окна редактирования узла конфигурации.</p>
<p>Кроме того, как и общие узлы, узлы конфигурации можно отключать и включать таким же образом.</p>
</section>
</section>
<section id="id44">
<h5>Провода<a class="headerlink" href="#id44" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Wires" src="../_images/wire.png" /></p>
<p>«Провода» относятся к соединениям, которые связывают узлы вместе, чтобы определить поток данных. Эти провода визуально представляют направление и поток информации от одного узла к другому в потоке U-Logic.</p>
<section id="id45">
<h6>Соединение узлов вместе<a class="headerlink" href="#id45" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы соединить узлы с помощью проводов, щелкните левой кнопкой мыши на выходном порту узла и перетащите провод к входному порту назначения. Кроме того, если вы нажмете <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code> и левую клавишу мыши на входном или выходном порту, вам не нужно будет удерживать левую клавишу мыши или любую другую кнопку для перетаскивания провода. Чтобы подключить его к порту назначения, нажмите левую клавишу мыши на порту назначения. Если клавиша <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code> останется нажатой после подключения к порту назначения, и если узел этого порта имеет выходной порт, будет перетащен новый провод.</p>
<p>Провода можно подключать от входного порта к выходному порту, а не от входного порта к входному порту или от выходного порта к выходному порту.</p>
</section>
<section id="id46">
<h6>Удаление проводов<a class="headerlink" href="#id46" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы удалить провода, щелкните левой кнопкой мыши, чтобы выбрать первый провод. Чтобы выбрать несколько проводов, нажмите и удерживайте клавишу, <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code> щелкая каждый провод левой кнопкой мыши. Если вы используете только левую кнопку мыши, вы можете выбрать только один провод за раз. После выбора проводов нажмите клавишу <code class="docutils literal notranslate"><span class="pre">delete</span></code> или <code class="docutils literal notranslate"><span class="pre">backspace</span></code>, чтобы удалить их.</p>
</section>
<section id="id47">
<h6>Движущиеся провода<a class="headerlink" href="#id47" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы отключить провод от порта, выберите провод, щелкнув по нему. Затем нажмите и удерживайте клавишу <code class="docutils literal notranslate"><span class="pre">Shift</span></code> , пока левая клавиша мыши нажата на порту. При перетаскивании мыши вы увидите, что провод отключается от порта и может быть подключен к другому порту.</p>
<p>Если к порту подключено несколько проводов, и при нажатии кнопки с удерживаемой клавишей <code class="docutils literal notranslate"><span class="pre">Shift</span></code> ни один из них не выбран, то будут перемещаться все провода.</p>
</section>
<section id="id48">
<h6>Резка проводов<a class="headerlink" href="#id48" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Провода также можно удалить, разрезав их. Это можно сделать, удерживая клавишу <code class="docutils literal notranslate"><span class="pre">Alt/Option</span></code>, а затем нарисовав линию разрезания, удерживая левую кнопку мыши.</p>
</section>
<section id="id49">
<h6>Отсоединение узлов<a class="headerlink" href="#id49" title="Ссылка на этот заголовок"></a></h6>
<p><strong>Сохранение провода при удалении узла</strong></p>
<!-- 
![]() -->
<p>Для этого нажмите и удерживайте клавишу <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code>, выберите узел, щелкнув левой клавишей мыши, а затем нажмите клавишу <code class="docutils literal notranslate"><span class="pre">delete</span></code> или <code class="docutils literal notranslate"><span class="pre">backspace</span></code>.</p>
<p><strong>Отсоединение узла от проводов</strong></p>
<!-- 
![]() -->
<p>Чтобы использовать эту опцию, необходимо задать сочетание клавиш для действия «Detach Selected Nodes»</p>
</section>
</section>
<section id="id50">
<h5>Группы<a class="headerlink" href="#id50" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Groups" src="../_images/group.png" /></p>
<p>В U-Logic можно создавать группы для лучшей организации, содержащие один объект с включенными конфигурациями узлов в редакторе.</p>
<section id="id51">
<h6>Создание группы потоков<a class="headerlink" href="#id51" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Creating a Flow Group" src="../_images/group_add.png" /></p>
<p>Чтобы создать группу потоков, выберите узлы (удерживая клавишу Ctrl или рисуя вокруг них прямоугольник). Перейдите <code class="docutils literal notranslate"><span class="pre">Группы</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Сгруппировать</span> <span class="pre">выделение</span></code> в главном меню или нажмите <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> + <code class="docutils literal notranslate"><span class="pre">Shift</span></code> + <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p>
</section>
<section id="id52">
<h6>Редактирование свойств группы<a class="headerlink" href="#id52" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Editing Group Properties" src="../_images/group_edit.png" /></p>
<p>Группа потока может иметь имя, цвет фона и метку границы, видимую в рабочей области. По умолчанию она имеет серую границу без фона или имени.</p>
<p>Чтобы задать стиль и имя группы, дважды щелкните по ней. Введите имя, выберите цвета контура и фона в свойстве заливки, настройте положение и цвет метки, затем щелкните «Готово» в правом верхнем углу.</p>
<!-- ###### Добавление переменных среды на уровне группы

![Adding Group-Level Enviroment Variables](../_static/U-Logic/Getting_Started/workspace/group_env.png)

Чтобы добавить переменные среды на уровне группы, дважды щелкните по ним. Выберите вторую опцию в правом верхнем углу всплывающего окна, расположенного под кнопкой "Готово". Нажмите самую нижнюю кнопку "добавить", чтобы добавить переменные. -->
</section>
<section id="id53">
<h6>Добавление описания<a class="headerlink" href="#id53" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Adding Description" src="../_images/group_description.png" /></p>
<p>Чтобы добавить описание в группу, дважды щелкните по ней. Выберите третий вариант в правом верхнем углу всплывающего окна под кнопкой «Готово». Введите описание в формате Markdown.</p>
</section>
<section id="id54">
<h6>Добавление узлов в группу<a class="headerlink" href="#id54" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы добавить узлы в существующую группу, перетащите их в группу. Это можно делать по одному узлу за раз. Группы также могут быть вложены друг в друга таким же образом.</p>
</section>
<section id="id55">
<h6>Удаление узлов из группы<a class="headerlink" href="#id55" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы удалить узлы из группы, выберите узлы и перейдите <code class="docutils literal notranslate"><span class="pre">Группы</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Удалить</span> <span class="pre">из</span> <span class="pre">группы</span></code> в главном меню. Аналогично удалите группу из другой группы. Или щелкните по узлу, удерживайте клавишу <code class="docutils literal notranslate"><span class="pre">Alt</span></code> и перетащите его за пределы группы.</p>
</section>
<section id="id56">
<h6>Объединение групп<a class="headerlink" href="#id56" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Merging Groups" src="../_images/group_merge.png" /></p>
<p>Чтобы объединить несколько групп в одну, выберите группы. Перейти к главному меню и выбрать раздел <code class="docutils literal notranslate"><span class="pre">Группы</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Объединить</span> <span class="pre">выделение</span></code>.</p>
</section>
<section id="id57">
<h6>Разгруппировка выбранных узлов<a class="headerlink" href="#id57" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Ungrouping Selected Nodes" src="../_images/group_ungroup_selection.png" /></p>
<p>Чтобы разгруппировать узлы из группы, выберите узлы. Перейти к главному меню в раздел <code class="docutils literal notranslate"><span class="pre">Группы</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Разгруппировать</span> <span class="pre">выделение</span></code>.</p>
</section>
</section>
<section id="id58">
<h5>Выбор<a class="headerlink" href="#id58" title="Ссылка на этот заголовок"></a></h5>
<p>Редактор U-Logic предоставляет простой интерфейс для выбора узлов и проводов на рабочем пространстве.</p>
<p>Узел можно выбрать или отменить выбор, щелкнув по нему. Чтобы выбрать несколько узлов, нажмите <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code> клавишу и выберите нужные узлы. Чтобы выбрать все узлы в рабочей области, щелкните <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<section id="id59">
<h6>Инструмент «Лассо»<a class="headerlink" href="#id59" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Lasso Tool" src="../_images/selection_lasso.png" /></p>
<p>U-Logic предоставляет инструмент лассо для более быстрого выбора. Чтобы использовать инструмент лассо, нажмите левую клавишу мыши и перетащите курсор, затем вы можете выбрать несколько узлов, нарисовав вокруг них прямоугольник.</p>
</section>
<section id="id60">
<h6>Выбор подключенных узлов<a class="headerlink" href="#id60" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы выбрать все подключенные к определенному узлу узлы, нажмите <code class="docutils literal notranslate"><span class="pre">Shift</span></code> и щелкните по середине этого узла.</p>
</section>
<section id="id61">
<h6>Выбор всех вышестоящих узлов<a class="headerlink" href="#id61" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы выбрать все подключенные узлы, которые находятся перед этим конкретным узлом, нажмите <code class="docutils literal notranslate"><span class="pre">Shift</span></code> и, удерживая ее, щелкните левую часть этого узла.</p>
</section>
<section id="id62">
<h6>Выбор всех нижестоящих узлов<a class="headerlink" href="#id62" title="Ссылка на этот заголовок"></a></h6>
<!-- 
![]() -->
<p>Чтобы выбрать все подключенные узлы, которые находятся после данного конкретного узла, нажмите <code class="docutils literal notranslate"><span class="pre">Shift</span></code> и, удерживая ее, щелкните правую часть этого узла.</p>
</section>
<section id="id63">
<h6>Выбор потоков<a class="headerlink" href="#id63" title="Ссылка на этот заголовок"></a></h6>
<p><img alt="Selecting Flows" src="../_images/selection_flows.png" /></p>
<p>Чтобы выбрать вкладки потока, нажмите клавишу <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code> и, удерживая ее, щелкните на вкладке потока, которую вы хотите выбрать. Теперь вы можете удалить, экспортировать или скопировать их все вместе.</p>
</section>
</section>
</section>
<section id="id64">
<h4>Боковая панель редактора<a class="headerlink" href="#id64" title="Ссылка на этот заголовок"></a></h4>
<p>Боковая панель расположена на правой стороне редактора U-Logic. Она содержит набор различных инструментов, которые упрощают использование U-Logic, например, управление узлами, конфигурация, хранилище контекста и многое другое.</p>
<p><img alt="Sidebar" src="../_images/sidebar.png" /></p>
<p>Инструменты, доступные на боковой панели, называются панелями.</p>
<section id="id65">
<h5>Панели по умолчанию<a class="headerlink" href="#id65" title="Ссылка на этот заголовок"></a></h5>
<p>Боковая панель U-Logic поставляется со следующими панелями по умолчанию:</p>
</section>
<section id="id66">
<h5>Панель «Информация»<a class="headerlink" href="#id66" title="Ссылка на этот заголовок"></a></h5>
<p>На информационной панели отображается информация обо всех потоках, узлах, присутствующих в них, подпотоках и узлах, присутствующих в них, а также узлах глобальной конфигурации в древовидной структуре.</p>
<p>Если навести курсор на любой элемент в этой древовидной структуре, вы увидите несколько опций, которые упрощают и ускоряют работу, например, <strong>Вызвать действие</strong> (для активации узлов, если у наведенного узла есть кнопка), <strong>Включить/Отключить</strong> (для отключения и включения наведенного узла), <strong>Show/Hide</strong> (для скрытия и отображения наведенного элемента в рабочей области), <strong>Lock/Unlock</strong> (для блокировки и разблокировки наведенного элемента), <strong>Найти в рабочей области</strong> (для быстрого поиска наведенного элемента в рабочей области). Эти опции представлены различными значками.</p>
<section id="id67">
<h6>Поиск в потоках<a class="headerlink" href="#id67" title="Ссылка на этот заголовок"></a></h6>
<p>Панель «инфо» имеет строку поиска в верхней части, которая позволяет легко искать потоки, подпотоки и узлы на информационной панели.</p>
<p>Кроме того, он предоставляет фильтр, позволяющий фильтровать эти элементы по различным параметрам, таким как</p>
<ul class="simple">
<li><p>Узлы конфигурации</p></li>
<li><p>Неиспользуемые узлы конфигурации</p></li>
<li><p>Modified nodes and flows</p></li>
<li><p>Недействительные узлы</p></li>
<li><p>Неизвестные узлы</p></li>
<li><p>Неиспользуемые подпотоки</p></li>
<li><p>Hidden flows</p></li>
<li><p>Current flow</p></li>
</ul>
</section>
<section id="id68">
<h6>Свойства элемента<a class="headerlink" href="#id68" title="Ссылка на этот заголовок"></a></h6>
<p>Если щелкнуть элемент в древовидной структуре информационной панели, на второй вкладке панели «инфо» вы увидите идентификатор потока, если выбранный элемент является потоком, а также идентификатор узла и тип, если это узел.</p>
<p>Значение узла можно копировать с помощью опции копирования справа от значения</p>
<p>Чтобы увидеть дополнительную информацию, нажмите кнопку «Показать больше», которая отобразит дополнительную информацию обо всех свойствах узла.</p>
<p>В верхней части вы увидите три опции: первая — «Показать справку», при нажатии на которую вы перейдете на панель справки и увидите файл readme, предоставленный автором для выбранного элемента; вторая опция скопирует URL-адрес выбранного элемента, вы можете использовать эту функцию, когда хотите указать или обсудить определенный элемент в рабочей области с членом вашей команды; и третья опция позволяет вам найти этот элемент в рабочей области.</p>
</section>
</section>
<section id="id69">
<h5>Панель «Справка»<a class="headerlink" href="#id69" title="Ссылка на этот заголовок"></a></h5>
<p>Эта панель позволяет просматривать readme файл. Макет этой панели немного похож на информационную панель и разделен на две вкладки.</p>
<p>Первая вкладка представляет собой древовидную структуру с двумя основными темами: «U-Logic» и «Справка по узлам». U-Logic включает в себя Change Log и Welcome Toursl.</p>
<p>На второй вкладке отображаются файлы readme выбранного узла.</p>
<section id="id70">
<h6>Скрытие тем<a class="headerlink" href="#id70" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы скрыть/показать первую вкладку панели справки, нажмите на верхнюю левую кнопку «Hide topics».</p>
</section>
<section id="id71">
<h6>Просмотр документации Node на вкладке «Справка»<a class="headerlink" href="#id71" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы просмотреть файлы readme на панели справки для узлов, щелкните один раз по узлам в рабочей области или щелкните элемент узла в древовидной структуре раздела «Справка по узлам».</p>
</section>
</section>
<section id="id72">
<h5>Панель «Отладочные сообщения»<a class="headerlink" href="#id72" title="Ссылка на этот заголовок"></a></h5>
<p>Панель отладки отображает сообщения, выводимые узлом debug. Эта панель помогает легко отлаживать ваше приложение.</p>
<p>Когда сообщения печатаются на панели отладки, каждое сообщение включает дату и время, имя узла, который напечатал это сообщение, имя свойства, его тип данных и значение.</p>
<section id="id73">
<h6>Фильтрация отладочных сообщений<a class="headerlink" href="#id73" title="Ссылка на этот заголовок"></a></h6>
<p>В верхней части панели отладки вы увидите опцию фильтра с тремя параметрами, которая позволяет отображать только те сообщения, которые вам нужны:</p>
<ul class="simple">
<li><p>все узлы: при выборе этого параметра будут отображаться сообщения, распечатанные всеми узлами.</p></li>
<li><p>выбранные узлы: эта опция позволяет выбрать конкретные узлы отладки, сообщения которых вы хотите видеть на панели отладки.</p></li>
<li><p>текущий поток: при выборе этого параметра будут печататься только сообщения, напечатанные узлами, присутствующими в текущем потоке.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Боковая панель «отладка» может отображать только 100 последних сообщений. Если боковая панель в данный момент отображает отфильтрованный список сообщений, скрытые сообщения все равно учитываются в пределе 100.</p>
</div>
</section>
<section id="id74">
<h6>Очистка сообщений<a class="headerlink" href="#id74" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы очистить сообщения, нажмите на кнопку «Очистить журнал» в правом верхнем углу. Или нажмите на <code class="docutils literal notranslate"><span class="pre">ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">alt</span></code>+<code class="docutils literal notranslate"><span class="pre">l</span></code>.</p>
</section>
<section id="id75">
<h6>Открытие отдельного окна<a class="headerlink" href="#id75" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы открыть панель отладки в отдельном окне, щелкните по правой нижней кнопке «Открыть в новом окне» со значком компьютера. Щелчок по нему откроет панель отладки в новом окне браузера, что позволит легко просматривать и управлять сообщениями отладки.</p>
</section>
</section>
<section id="id76">
<h5>Панель «узлы конфигураций»<a class="headerlink" href="#id76" title="Ссылка на этот заголовок"></a></h5>
<p>Панель узлов конфигурации показывает список всех узлов конфигурации, добавленных к текущему экземпляру U-Logic. Все узлы конфигурации организованы по их области действия, например, по всем потокам, по определенному потоку и подпотоку.</p>
<p>Каждый узел конфигурации на панели узлов конфигурации отображает тип и метку этого узла, а также количество текущих узлов, использующих эту конфигурацию.</p>
<p>Эта панель конфигурации также обеспечивает легкий доступ к диалоговому окну редактирования узлов конфигурации. Чтобы открыть его, дважды щелкните по узлам конфигурации на панели.</p>
<p>Для доступа к этой панели узлов конфигурации нажмите <code class="docutils literal notranslate"><span class="pre">Ctrl/⌘</span></code>+<code class="docutils literal notranslate"><span class="pre">g</span></code> +<code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<section id="id77">
<h6>Фильтрация узлов конфигурации<a class="headerlink" href="#id77" title="Ссылка на этот заголовок"></a></h6>
<p>Панель конфигурации узлов предоставляет возможность фильтровать узлы по всем и неиспользуемым.</p>
</section>
</section>
<section id="id78">
<h5>Панель «Контекстные данные»<a class="headerlink" href="#id78" title="Ссылка на этот заголовок"></a></h5>
<p>Эта панель отображает переменные контекста по их области действия. Каждая переменная включает такие данные, как дата и время, ее хранилище, а также имя и значение. Чтобы получить доступ к этой панели, нажмите <code class="docutils literal notranslate"><span class="pre">ctrl/⌘</span></code>+<code class="docutils literal notranslate"><span class="pre">g</span></code>+<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<section id="id79">
<h6>Обновление переменных контекста<a class="headerlink" href="#id79" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы обновить контекстные переменные, нажмите кнопку обновления, расположенную в правом верхнем углу каждой вкладки области действия, или, чтобы обновить определенную переменную, наведите на нее курсор и нажмите кнопку обновления, которая появляется справа от нее.</p>
</section>
<section id="id80">
<h6>Удаление контекстных переменных<a class="headerlink" href="#id80" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы удалить контекстную переменную, наведите указатель мыши на переменную, которую вы хотите удалить, и нажмите кнопку удаления, которая появляется справа от нее.</p>
</section>
<section id="id81">
<h6>Копирование свойств и значений<a class="headerlink" href="#id81" title="Ссылка на этот заголовок"></a></h6>
<p>Чтобы скопировать имя этой переменной, наведите на нее курсор и нажмите первую кнопку, которая появится справа.</p>
<p>Чтобы скопировать значение этой переменной, наведите на нее курсор и нажмите вторую кнопку, которая появится справа.</p>
</section>
</section>
<section id="id82">
<h5>Сокрытие боковой панели<a class="headerlink" href="#id82" title="Ссылка на этот заголовок"></a></h5>
<p>Чтобы скрыть боковую панель, нажмите на кнопку «Показать/скрыть боковую панель». Чтобы снова отобразить ее, нажмите на кнопку переключения еще раз. В качестве альтернативы вы можете использовать сочетание клавиш <code class="docutils literal notranslate"><span class="pre">ctrl/⌘</span></code>+<code class="docutils literal notranslate"><span class="pre">space</span></code>.</p>
</section>
<section id="id83">
<h5>Изменение размера боковой панели<a class="headerlink" href="#id83" title="Ссылка на этот заголовок"></a></h5>
<p>Чтобы изменить размер боковой панели, наведите указатель мыши на границу боковой панели, пока курсор не изменится. Затем нажмите левую кнопку мыши и удерживайте ее во время изменения размера.</p>
</section>
</section>
</section>
<section id="id84">
<h3>Работа с сообщениями<a class="headerlink" href="#id84" title="Ссылка на этот заголовок"></a></h3>
<section id="id85">
<h4>Понимание сообщений U-Logic<a class="headerlink" href="#id85" title="Ссылка на этот заголовок"></a></h4>
<p>U-Logic полагается на передачу сообщений между узлами для создания динамичных рабочих процессов IoT, автоматизации и обработки данных. Каждое сообщение содержит данные, которые узлы изменяют, обрабатывают или анализируют, поэтому понимание структуры и обработки этих сообщений является ключевым. Неправильное управление сообщениями может привести к скрытым ошибкам, таким как перезапись данных, бесконечные циклы или сбои. Чтобы избежать ошибок и создавать надежные потоки, важно знать, как эффективно работать с сообщениями.</p>
<p>В этом руководстве будет рассмотрена внутренняя работа сообщений U-Logic, распространенные ошибки и лучшие практики для обеспечения плавного потока данных без ошибок.</p>
</section>
<section id="id86">
<h4>Что такое сообщения U-Logic?<a class="headerlink" href="#id86" title="Ссылка на этот заголовок"></a></h4>
<p>В U-Logic сообщения — это пакеты данных, которые перемещаются между узлами в вашем потоке. U-Logic работает на основе событий, что означает, что эмиттер событий инициирует события, а слушатель реагирует на них. В этом контексте узлы в U-Logic выступают как источники событий, так и слушатели, а сообщения служат средством, посредством которого эти события передаются. Эти сообщения представляют собой информацию, которую узлы читают, изменяют и на которую реагируют. Каждый узел обрабатывает эти сообщения и передает их следующему узлу в последовательности.</p>
<!-- additionalyy add animation of messages move -->
<p>Сообщения важны, потому что они передают данные, которые управляют вашими рабочими процессами, будь то показания датчиков, ввод пользователя или ответы от API. В сущности, сообщения U-Logic представляют собой объекты JavaScript, которые являются простыми, но мощными структурами для управления и передачи данных в ваших потоках.</p>
<section id="javascript">
<h5>Понимание объектов JavaScript<a class="headerlink" href="#javascript" title="Ссылка на этот заголовок"></a></h5>
<p>JavaScript объект — это структура данных, используемая для хранения нескольких значений в одной переменной. Она состоит из пар ключ-значение, где каждый ключ (или свойство) связан с определенным значением. Такая организация позволяет вам легко группировать и получать доступ к связанным данным.</p>
<p>Например:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">24</span><span class="p">,</span>
<span class="w">  </span><span class="nx">married</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>В этом примере , <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">age</span></code> и <code class="docutils literal notranslate"><span class="pre">married</span></code> являются свойствами объекта. Аналогично сообщения U-Logic используют эту структуру для организации и транспортировки данных в ваших потоках.</p>
</section>
</section>
<section id="id87">
<h4>Анатомия сообщений U-Logic<a class="headerlink" href="#id87" title="Ссылка на этот заголовок"></a></h4>
<p>В U-Logic сообщения по умолчанию именуются как <code class="docutils literal notranslate"><span class="pre">msg</span></code>, и узлы разработаны для работы с этим соглашением об именовании.</p>
<p>Сообщения U-Logic состоят из нескольких ключевых свойств, необходимых для обработки данных и связи между узлами:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">msg._msgid</span></code>: Уникальный идентификатор сообщения, автоматически назначаемый U-Logic. Он помогает отслеживать и отлаживать сообщения в потоке.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>: Это основные данные сообщения. Они содержат основную информацию, которую обрабатывают и на основе которой действуют узлы, например показания датчиков или пользовательский ввод.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg.topic</span></code>: Необязательное свойство, используемое для категоризации или идентификации сообщения. Может быть полезно для маршрутизации или фильтрации сообщений на основе их контекста.
Это наиболее распространенные свойства, с которыми вы столкнетесь в U-Logic. При необходимости можно добавлять дополнительные свойства.</p></li>
</ul>
<p>Свойство <code class="docutils literal notranslate"><span class="pre">_msgid</span></code> всегда присутствует, даже если вы отправляете пустой объект с одного узла на другой. Это свойство автоматически добавляется U-Logic для отслеживания сообщений в потоке. Однако важно отметить, что свойства <code class="docutils literal notranslate"><span class="pre">payload</span></code> и <code class="docutils literal notranslate"><span class="pre">topic</span></code> не всегда присутствуют в каждом сообщении. Их включение зависит от того, добавляет ли их узел. Большинство узлов в U-Logic, включая добавленные узлы, используют это <code class="docutils literal notranslate"><span class="pre">payload</span></code> свойство в качестве стандарта для коммуникации.</p>
</section>
<section id="id88">
<h4>Типы данных в сообщениях U-Logic<a class="headerlink" href="#id88" title="Ссылка на этот заголовок"></a></h4>
<p>При работе с сообщениями U-Logic важно понимать типы данных, с которыми вы столкнетесь. Поскольку сообщения всегда являются объектами JavaScript, само сообщение должно быть объектом, иначе U-Logic выдаст ошибку.</p>
<p>Однако возможно отправить <code class="docutils literal notranslate"><span class="pre">null</span></code> как сообщение. Это часто используется, когда вы не хотите отправлять какие-либо данные дальше по потоку, так как это <code class="docutils literal notranslate"><span class="pre">null</span></code> фактически останавливает распространение сообщения на последующие узлы.</p>
<p>Говоря о свойствах сообщений, их значениями могут быть любые типы данных, поддерживаемые JavaScript, такие как строка, число, массив, логическое значение, объект, буфер и другие сложные типы данных.</p>
<p><img alt="Image with different data types" src="../_images/data_types.png" /></p>
</section>
<section id="id89">
<h4>Как клонировать сообщения или свойства сообщений<a class="headerlink" href="#id89" title="Ссылка на этот заголовок"></a></h4>
<p>Клонирование в U-Logic подразумевает создание копии сообщения или его свойств, чтобы вы могли работать с копией независимо от оригинала. Это полезно, когда вам нужно изменить данные, не затрагивая исходное сообщение, или когда вам нужно отправить измененную версию сообщения в разные части вашего потока.</p>
<section id="change">
<h5>Использование узла change<a class="headerlink" href="#change" title="Ссылка на этот заголовок"></a></h5>
<p>Узел <strong>change</strong> в U-Logic предоставляет удобный способ изменения и клонирования свойств сообщений. Однако важно отметить, что вы не можете клонировать весь <code class="docutils literal notranslate"><span class="pre">msg</span></code> объект сразу; вам нужно копировать его свойства по одному. Кроме того, узел change может клонировать свойства только в другое свойство <code class="docutils literal notranslate"><span class="pre">msg</span></code>, или в свойство контекста потока/глобального контекста.</p>
<p>Вот как можно использовать узел change для обработки свойств сообщения:</p>
<ul class="simple">
<li><p>Дважды щелкните узел <strong>change</strong> , чтобы открыть диалоговое окно его конфигурации.</p></li>
<li><p>Вы увидите интерфейс с существующим элементом, добавленным по умолчанию.</p></li>
<li><p>С левой стороны поля вы увидите такие опции, как <strong>«Установить»</strong> , <strong>«Изменить»</strong> , <strong>«Удалить»</strong> и <strong>«Переместить»</strong> . Вы можете использовать эти опции для выполнения соответствующих операций над сообщением.</p></li>
<li><p>Чтобы клонировать свойство <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> в <code class="docutils literal notranslate"><span class="pre">flow.data</span></code>, выберите действие «<strong>Установить</strong>» . В первом поле «to the value» введите <code class="docutils literal notranslate"><span class="pre">payload</span></code>, выберите flow и введите данные. Для клонирования <code class="docutils literal notranslate"><span class="pre">msg</span></code> свойств в новые <code class="docutils literal notranslate"><span class="pre">msg</span></code> свойства выберите <code class="docutils literal notranslate"><span class="pre">msg</span></code> во втором поле и укажите новое имя свойства.</p></li>
</ul>
<p>Для получения дополнительной информации об узле change и для изучения других действий, таких как <strong>Удалить</strong> , <strong>Переместить</strong> и <strong>Изменить</strong> , обратитесь к разделу по узлу <a class="reference internal" href="#"><span class="xref myst">change</span></a>.</p>
</section>
<section id="function">
<h5>Использование узла function<a class="headerlink" href="#function" title="Ссылка на этот заголовок"></a></h5>
<p>В узле функции вы можете клонировать сообщения или определенные свойства с помощью JavaScript. Вот как это можно сделать:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Клонировать все сообщение</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">newMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">RED</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">cloneMessage</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
<span class="c1">// Изменить клон при необходимости, изменение клона не повлияет на оригинал</span>
<span class="nx">newMsg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Измененные данные&quot;</span><span class="p">;</span>
<span class="c1">// Вернуть оригинал</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Прямое назначение, например, <code class="docutils literal notranslate"><span class="pre">let</span> <span class="pre">newMsg</span> <span class="pre">=</span> <span class="pre">msg;</span></code> не создает настоящего клона. Вместо этого оно создает новую ссылку на тот же объект. Это означает, что изменения в <code class="docutils literal notranslate"><span class="pre">newMsg</span></code> также повлияют на msg, поскольку оба ссылаются на одни и те же данные.</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Присвоить ссылку на оригинальное сообщение</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">newMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
<span class="c1">// Изменение newMsg повлияет на оригинальное сообщение</span>
<span class="nx">newMsg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Измененные данные&quot;</span><span class="p">;</span>
<span class="c1">// Вернуть оригинал</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Если вам нужно клонировать только определенные свойства сообщения, вы можете сделать это, вручную скопировав нужные вам свойства:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Клонировать определенные свойства сообщения</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">newMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="nx">newMsg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">;</span><span class="w"> </span><span class="c1">// Копировать payload</span>
<span class="nx">newMsg</span><span class="p">.</span><span class="nx">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">topic</span><span class="p">;</span><span class="w">     </span><span class="c1">// Копировать topic</span>
<span class="c1">// Вернуть новое сообщение с клонированными свойствами</span>
<span class="k">return</span><span class="w"> </span><span class="nx">newMsg</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="id90">
<h5>Добавление новых свойств к сообщениям<a class="headerlink" href="#id90" title="Ссылка на этот заголовок"></a></h5>
<p>Сообщения U-Logic, как упоминалось ранее, являются объектами JavaScript, что делает их очень гибкими для настройки. Вы можете добавлять столько свойств, сколько необходимо, к сообщению, что позволяет вам переносить дополнительные данные через ваш поток. Это может быть особенно полезно для улучшения информации, доступной для нижестоящих узлов, например, для включения метаданных, тегов или дополнительных деталей конфигурации.</p>
<p>Чтобы добавить новые свойства к сообщению, можно использовать узел <strong>change</strong> или узел <strong>function</strong>.</p>
<p>Узел <strong>change</strong> позволяет вам легко добавлять новые свойства к <code class="docutils literal notranslate"><span class="pre">msg</span></code> объекту без написания кода. Вот как это сделать:</p>
<ul class="simple">
<li><p>Перетащите узел <strong>change</strong> в свой поток и дважды щелкните по нему, чтобы открыть конфигурацию.</p></li>
<li><p>Выберите действие <strong>«Установить»</strong> в раскрывающемся меню слева.</p></li>
<li><p>В поле справа введите новое название свойства (например, <code class="docutils literal notranslate"><span class="pre">msg.customData</span></code>).</p></li>
<li><p>В поле «to the value» введите значение, которое вы хотите присвоить этому свойству. Это может быть строка, число, логическое значение или даже выражение.</p></li>
</ul>
<p>Если вы предпочитаете больший контроль, вы можете добавлять новые свойства непосредственно через узел <strong>function</strong> с помощью JavaScript.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Добавить новое пользовательское свойство к сообщению</span>
<span class="nx">msg</span><span class="p">.</span><span class="nx">customData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Это описание&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()</span>
<span class="p">};</span>
<span class="c1">// Вернуть обновленное сообщение</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="json">
<h5>Обработка JSON сообщений<a class="headerlink" href="#json" title="Ссылка на этот заголовок"></a></h5>
<p>В U-Logic работа с JSON является обычным явлением, особенно при работе с API и данными IoT. JSON (JavaScript Object Notation) — это облегченный формат обмена данными, а U-Logic упрощает процесс отправки и получения объектов JSON.</p>
<p>При работе с U-Logic вы можете столкнуться с двумя формами JSON:</p>
<ul class="simple">
<li><p><strong>JSON Объект</strong>: это простой, структурированный объект JavaScript, которым можно легко манипулировать в U-Logic. Вы можете получить доступ к его свойствам, изменить его значения и передать его через различные узлы в вашем потоке.</p></li>
<li><p><strong>JSON Строка</strong>: строка JSON — это сериализованная версия объекта JSON, обычно используемая при передаче данных между системами. В отличие от обычного объекта, вы не можете манипулировать строкой JSON напрямую так же, как вы бы это делали с объектом JavaScript.</p></li>
</ul>
<p><strong>Преобразование JSON строки в JSON объект</strong></p>
<p>Чтобы обработать строку JSON как обычный объект JavaScript, сначала нужно преобразовать ее в объект JSON. U-Logic предоставляет узел json, который упрощает этот процесс. Узел json анализирует строку и преобразует ее в объект, позволяя вам обрабатывать ее как любые другие структурированные данные в вашем потоке.</p>
<p>Вот шаги для достижения этого:</p>
<ul class="simple">
<li><p>Перетащите узел json на холст U-Logic.</p></li>
<li><p>Дважды щелкните узел json, чтобы настроить его.</p></li>
<li><p>Установите действие «Всегда преобразовывать в объект JavaScript» и нажмите «Готово».</p></li>
<li><p>Подключите вход узла json к выходу узла, отправляющего строку JSON.</p></li>
<li><p>Подключите выход узла json ко входу следующего узла в вашем потоке, которому требуется обработанный объект JSON.</p></li>
<li><p>Выполнив эти шаги, узел json преобразует входящую строку JSON в пригодный для использования объект JavaScript в потоке U-Logic.</p></li>
</ul>
</section>
</section>
<section id="id91">
<h4>Распространенные ошибки, которых следует избегать при работе с сообщениями U-Logic<a class="headerlink" href="#id91" title="Ссылка на этот заголовок"></a></h4>
<p>При работе с сообщениями в U-Logic избегайте следующих распространенных ошибок, чтобы гарантировать бесперебойную и ожидаемую работу ваших потоков:</p>
<ul class="simple">
<li><p><strong>Добавление свойств к необъектному свойству</strong>: Попытка добавить свойства к свойству, не являющемуся объектом (например, строке или числу), может привести к ошибкам или неожиданному поведению. Всегда проверяйте, работаете ли вы с объектами при добавлении свойств.</p></li>
</ul>
<p>Неправильный пример:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;stringValue&#39;</span><span class="p">;</span>
<span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">newProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// Ошибка: &#39;stringValue&#39; не является объектом</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Правильный пример:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span><span class="w">  </span><span class="c1">// Инициализация как объект</span>
<span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">newProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// Теперь безопасно добавлять свойства</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Эта ошибка часто возникает в узле change, где узел inject отправляет данные <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">string</span></code> или <code class="docutils literal notranslate"><span class="pre">number</span></code> (например, «hello world»), а узел change пытается добавить свойство, <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как если бы это был объект.</p>
<p><img alt="nonobject" src="../_images/nononject.png" /></p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Неправильно: добавление свойства к типу, не являющемуся объектом (например, строке)</p>
</div>
<p>Правильный подход:</p>
<p><img alt="correct_nonobject" src="../_images/correct_nonobject.png" /></p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Правильно: Инициализируйте свойство как объект перед добавлением свойств.</p>
</div>
<ul class="simple">
<li><p><strong>Перезапись объекта сообщения (<code class="docutils literal notranslate"><span class="pre">msg</span></code>)</strong>: Некоторые пользователи ошибочно перезаписывают весь <code class="docutils literal notranslate"><span class="pre">msg</span></code> объект, а не изменяют определенные свойства. Это может привести к потере важного контекста или свойств.</p></li>
</ul>
<p>Пример неправильной перезаписи:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">newProperty</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="w"> </span><span class="p">};</span><span class="w">  </span><span class="c1">// Перезаписывается весь объект msg</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Вместо этого измените определенные свойства:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">msg</span><span class="p">.</span><span class="nx">newProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;value&#39;</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Возврат неправильного типа данных</strong>: потоки U-Logic ожидают, что сообщения будут переданы как объекты. Возврат неправильного типа данных, например строки или числа, прерывает поток и выдает ошибку.</p></li>
<li><p><strong>Забывание вернуть сообщение</strong>: в узлах function, если вы измените сообщение, но забудете вернуть его, поток остановится на этом узле.</p></li>
</ul>
<p>Освоив тонкости объектов сообщений U-Logic и избежав распространенных ошибок, вы сможете создавать более надежные и эффективные рабочие процессы. Понимание того, как работать с данными JSON, клонировать сообщения и правильно обрабатывать свойства, гарантирует, что ваши данные будут бесперебойно передаваться между узлами.</p>
<p>Продолжая изучать и разрабатывать приложения с помощью U-Logic, помните об этих передовых методах, чтобы поддерживать безошибочные и высокопроизводительные процессы.</p>
</section>
</section>
<section id="id92">
<h3>Программирование<a class="headerlink" href="#id92" title="Ссылка на этот заголовок"></a></h3>
<p>Концепции программирования U-Logic</p>
<ul class="simple">
<li><p><strong>If-Else</strong>: документация If-Else объясняет, как реализовать условную логику в U-Logic. Это руководство проведет вас через использование узлов function и switch для создания динамических потоков, основанных на решениях.</p></li>
<li><p><strong>Преобразование данных</strong>: документация по преобразованию данных охватывает методы фильтрации, отображения, сортировки и сокращения данных в U-Logic. Она объясняет, как преобразовывать данные в ваших потоках, предоставляя практические примеры по отображению массивов и обработке данных.</p></li>
<li><p><strong>Циклы</strong>: документация по циклам объясняет, как реализовать повторяющиеся операции в U-Logic. Это руководство проведет вас через использование узлов for и while для создания циклов, которые позволяют обрабатывать массивы данных или выполнять задачи многократно.</p></li>
</ul>
<section id="id93">
<h4>Преобразование данных<a class="headerlink" href="#id93" title="Ссылка на этот заголовок"></a></h4>
<p>U-Logic — это визуальная платформа программирования, известная своим удобным интерфейсом и подходом low-code, широко используемым для разработки приложений IoT. В приложениях IoT эффективная обработка данных имеет решающее значение, а такие операции, как фильтрация, отображение, сортировка и сокращение, необходимы для упрощения преобразований данных. Однако многие пользователи испытывают трудности с реализацией этих операций, придерживаясь подхода low-code, часто полагаясь на функциональные узлы, которые могут вносить ненужную сложность. В этом руководстве будет показано, как фильтровать, отображать, сортировать и сокращать данные с помощью U-Logic для эффективного преобразования данных, придерживаясь подхода low-code.</p>
<section id="low-code">
<h5>Что такое Low-Code<a class="headerlink" href="#low-code" title="Ссылка на этот заголовок"></a></h5>
<p>Low-code — это подход к разработке программного обеспечения, который требует минимального или нулевого кодирования для создания приложений и процессов. Вместо использования сложных языков программирования вы используете визуальные интерфейсы с базовой логикой и возможностями перетаскивания.</p>
<p>Более подробную информацию можно найти <a class="reference internal" href="Low-Code.html"><span class="std std-doc">здесь</span></a>:</p>
</section>
<section id="id94">
<h5>Зачем вам нужно научиться фильтровать, сопоставлять, сортировать и сокращать данные?<a class="headerlink" href="#id94" title="Ссылка на этот заголовок"></a></h5>
<p>Фильтрация, отображение, сортировка и сокращение являются важнейшими функциями в обработке данных, поскольку они эффективно преобразуют, извлекают, организуют и агрегируют данные, что упрощает анализ и извлечение информации из наборов данных. Например, рассмотрим сценарий, в котором у вас есть массив данных датчиков, извлеченных из базы данных. Данные выглядят примерно так:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-17T10:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">298.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-17T11:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">299.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-17T10:30:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">300.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-17T10:15:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">301.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-17T10:45:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">303.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-18T09:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">297.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-18T10:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">300.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-18T11:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">301.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-18T12:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">302.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-19T10:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">298.15</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2024-06-19T11:00:00Z&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;temperature&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">299.15</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Однако вы заметили, что данные о температуре указаны в градусах Кельвина, а вам нужны они в градусах Цельсия. Кроме того, данные не упорядочены по временной метке, и вам нужны только данные за 17 июня. Наконец, вы хотите рассчитать среднюю температуру за этот день. Пользователи, не знакомые с основами U-Logic, могут использовать узел function, чтобы добиться этого, как показано ниже:</p>
<p><img alt="traditional_data_transformation" src="../_images/traditiona_data_transformation.png" /></p>
<p>Использование узлов function не является неправильным, но оно усложняет ваши приложения. Поскольку не все в команде могут быть знакомы с JavaScript, это может ограничить круг лиц, которые могут решать бизнес-задачи. Чтобы сохранить простоту потока приложений, использование подхода с малым количеством кода для выполнения этих операций имеет решающее значение.</p>
<p>В следующих разделах будет рассмотрено, как выполнять эти операции, используя подход с минимальным кодированием.</p>
</section>
<section id="id95">
<h5>Сопоставление<a class="headerlink" href="#id95" title="Ссылка на этот заголовок"></a></h5>
<p>Сопоставление часто относится к процессу применения функции к каждому элементу в списке, массиве или другой коллекции для создания новой коллекции преобразованных элементов. Здесь, в данном контексте, необходимо преобразовать данные о температуре каждого объекта из градусов Кельвина в градусы Цельсия. Для выполнения отображения будут использованы узлы split, change и join.</p>
<ol class="arabic simple">
<li><p>Перетащите узел split на холст. Узел split разделит сообщение на последовательность сообщений, что позволит нам работать с каждым сообщением. Кроме того, узел «Разделить» привяжет метаданные к каждому разделенному объекту. Эти метаданные помогут узлу join объединить всю последовательность сообщений обратно в массив.</p></li>
<li><p>Перетащите узел change на холст и задайте его <code class="docutils literal notranslate"><span class="pre">msg.payload.temperature</span></code> как <code class="docutils literal notranslate"><span class="pre">payload.temperature</span> <span class="pre">-</span> <span class="pre">273.15</span></code> выражение JSONata.</p></li>
</ol>
<p><img alt="Convert temperature" src="../_images/jonta_convert.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Теперь перетащите узел join на холст и установите «Режим» на «автоматический». Это автоматически объединит все сообщения, исходящие из узла split, в массив.</p></li>
</ol>
<p><img alt="Mapping" src="../_images/mapping.png" /></p>
</section>
<section id="id96">
<h5>Фильтрация<a class="headerlink" href="#id96" title="Ссылка на этот заголовок"></a></h5>
<p>Фильтрация — это процесс выбора определенных элементов из массива для создания нового массива. В U-Logic фильтрация достигается с помощью сопоставления и узла switch для маршрутизации на основе условий.</p>
<ol class="arabic simple">
<li><p>Перетащите узел switch и поместите его после узла change и перед узлом join.</p></li>
<li><p>Установите условие для проверки того, <code class="docutils literal notranslate"><span class="pre">msg.payload.timestamp</span></code> включает ли сообщение «2024-06-17». Это условие гарантирует, что далее будут отправляться только сообщения, содержащие указанную дату в своей временной метке.</p></li>
<li><p>Далее в узле коммутации отметьте опцию «воссоздать последовательность сообщений», которая восстановит <code class="docutils literal notranslate"><span class="pre">msg.parts</span></code> метаданные, добавленные узлом split, если какие-либо сообщения будут потеряны узлом коммутации.</p></li>
</ol>
<p><img alt="Switch Node properties" src="../_images/filter_switch.png" /></p>
<p><img alt="Filter" src="../_images/filter.png" /></p>
</section>
<section id="id97">
<h5>Сортировка<a class="headerlink" href="#id97" title="Ссылка на этот заголовок"></a></h5>
<p>Сортировка, как следует из названия, означает упорядочивание элементов в определенном порядке. Этот порядок может быть возрастающим (от наименьшего к наибольшему), убывающим (от наибольшего к наименьшему) или основанным на любом определенном критерии. В U-Logic вы можете сортировать числа, алфавиты, массивы, строки и многое другое. Для выполнения сортировки нам нужно использовать узел sort U-Logic.</p>
<ol class="arabic simple">
<li><p>Перетащите узел sort на холст.</p></li>
<li><p>Установите ключ в <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> качестве выражения JSONata, а затем установите порядок «восходящий. Ключ устанавливается в качестве метки времени, поскольку необходимо сортировать данные на основе метки времени. Вы можете установить его в качестве температуры, если хотите сортировать на основе этого.</p></li>
</ol>
<p><img alt="Sort Node properties" src="../_images/sort_node.png" /></p>
<p><img alt="Sort" src="../_images/sort.png" /></p>
</section>
<section id="id98">
<h5>Сокращение<a class="headerlink" href="#id98" title="Ссылка на этот заголовок"></a></h5>
<p>Сокращение относится к процессу объединения элементов структуры данных (например, массива) в одно значение. Оно включает в себя итерацию по элементам структуры данных и многократное применение функции объединения до тех пор, пока все элементы не будут обработаны.</p>
<ol class="arabic simple">
<li><p>Перетащите еще один узел split на холст.</p></li>
<li><p>Перетащите еще один узел join на холст.</p></li>
<li><p>Выберите режим «агрегация последовательности», установите «Агрегирующее выражение» на <code class="docutils literal notranslate"><span class="pre">$A+</span> <span class="pre">payload.temperature</span></code>, «начальное значение» на <code class="docutils literal notranslate"><span class="pre">0</span></code> и «Исправляющее выражение» на <code class="docutils literal notranslate"><span class="pre">$A/$N</span></code></p></li>
</ol>
<p><img alt="Join Node properties" src="../_images/reduce_join.png" /></p>
<p>В этой конфигурации узел join настроен на режим сокращения последовательности. Начальное значение аккумулятора (<code class="docutils literal notranslate"><span class="pre">$A</span></code>) инициализируется до <code class="docutils literal notranslate"><span class="pre">0</span></code>. По мере обработки каждого сообщения текущая температура (<code class="docutils literal notranslate"><span class="pre">payload.temperature</span></code>) добавляется к <code class="docutils literal notranslate"><span class="pre">$A</span></code>. После обработки всех сообщений накопленная сумма <code class="docutils literal notranslate"><span class="pre">$A</span></code> делится на общее количество сообщений (<code class="docutils literal notranslate"><span class="pre">$N</span></code>) для вычисления средней температуры.</p>
<p><img alt="Reducing" src="../_images/reducing.png" /></p>
</section>
</section>
<section id="if-else">
<h4>If-Else<a class="headerlink" href="#if-else" title="Ссылка на этот заголовок"></a></h4>
<p>Принятие решений человеком часто направляется серией выборов «если это, то то» — будь то решение, что надеть в зависимости от погоды, или определение кратчайшего маршрута на работу в зависимости от трафика. Такая логика одинаково важна в системах, особенно тех, которые построены на U-Logic. Так же, как люди принимают решения на основе различных факторов, системы должны оценивать условия и выбирать соответствующий курс действий.</p>
<p>При разработке автоматизированных решений в U-Logic, возможность воспроизводить этот процесс принятия решений, подобный человеческому, имеет решающее значение. Внедряя логику If-Else, ваша система может разумно ориентироваться в различных сценариях, адаптируя свое поведение на основе получаемых входных данных. Это руководство покажет вам, как эффективно интегрировать логику If-Else в ваши потоки U-Logic, гарантируя, что ваша система сможет принимать разумные решения с учетом контекста — так же, как это делаете вы.</p>
<section id="id99">
<h5>Понимание логики If-Else<a class="headerlink" href="#id99" title="Ссылка на этот заголовок"></a></h5>
<p>Концепция логики If-Else возникла из потребности компьютеров принимать решения. По мере развития языков программирования, управление компьютером посредством различных действий на основе различных условий стало необходимым. Это привело к созданию условных операторов, которые позволяют программам выбирать различные пути в зависимости от определенных критериев.</p>
<section id="id100">
<h6>Что за логика If-Else?<a class="headerlink" href="#id100" title="Ссылка на этот заголовок"></a></h6>
<p>Логика If-Else — это способ принятия решений программами. Работает так:</p>
<ul class="simple">
<li><p><strong>Если</strong> определенное условие выполняется (например, «Температура выше 30°C?»), то выполнить набор действий (например, «Включить кондиционер»).</p></li>
<li><p><strong>Иначе</strong> (если условие не выполняется) выполнить другой набор действий (например, «Выключить кондиционер»).</p></li>
</ul>
<p>Такой подход позволяет системам адекватно реагировать на различные ситуации.</p>
</section>
</section>
<section id="id101">
<h5>Реализация условных потоков в U-Logic: Практическое руководство<a class="headerlink" href="#id101" title="Ссылка на этот заголовок"></a></h5>
<p>В U-Logic реализация логики If-Else позволяет создавать динамичные и отзывчивые потоки, которые реагируют на различные входные данные и условия. Независимо от того, автоматизируете ли вы умный дом, управляете устройствами IoT или разрабатываете сложные рабочие процессы, освоение условной логики имеет важное значение для создания интеллектуальных систем.</p>
<p>Для реализации логики If-Else в U-Logic можно использовать узел switch, который идеально соответствует подходу Low-Code. Однако другой способ добиться этого — использовать узел function, который обеспечивает большую гибкость и контроль при написании пользовательской логики JavaScript.</p>
<section id="switch">
<h6>Использование узла switch<a class="headerlink" href="#switch" title="Ссылка на этот заголовок"></a></h6>
<p>Узел <a class="reference internal" href="#"><span class="xref myst">switch</span></a> в U-Logic используется для маршрутизации сообщений на основе определенных условий, предлагая простой, малокодовый подход к реализации условной логики в ваших потоках. Узел switch позволяет вам устанавливать правила с помощью визуального интерфейса, что делает его идеальным для пользователей, которые предпочитают более интуитивный метод обработки условий. Однако важно отметить, что узел switch представляет собой другую, независимую концепцию, известную как «оператор switch». Хотя он служит той же цели, что и логика If-Else, создавая условные потоки, он работает в рамках своей собственной парадигмы программирования.</p>
<p>Для демонстрации узла switch настроим поток для принятия решений на основе значения температуры. Будем направлять сообщения через различные выходы на основе пороговых значений температуры.</p>
<ol class="arabic simple">
<li><p>Перетащите узел inject на холст и задайте его <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">$random()</span> <span class="pre">*</span> <span class="pre">100</span></code> выражение JSONata; этот узел внедрения будет имитировать датчик температуры, генерируя случайное число.</p></li>
<li><p>Перетащите узел switch на холст. Дважды щелкните по нему и установите «Свойство» на msg.payload.</p></li>
<li><p>Чтобы добавить правила, нажмите кнопку + Добавить в левом нижнем углу панели конфигурации. Вам будет предложено выбрать условие и ввести значение для сравнения. Добавьте следующие четыре правила и установите их для «проверка всех правил»:</p></li>
</ol>
<ul class="simple">
<li><p>Правило 1: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&gt;</span> <span class="pre">30</span></code></p></li>
<li><p>Правило 2: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&lt;=</span> <span class="pre">30</span></code></p></li>
<li><p>Правило 3: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&lt;=</span> <span class="pre">20</span></code></p></li>
<li><p>Правило 4: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&lt;=</span> <span class="pre">10</span></code></p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Теперь перетащите другой узел switch и соедините его вход с выходом узлов switch 2 и 3. Второй узел switch добавляется из-за необходимости маршрутизации сообщений на основе диапазонов. Один узел switch не допускает множественных проверок в одном правиле, поэтому необходимо использовать другой узел switch для маршрутизации температуры на основе диапазонов. Добавьте следующие правила и установите для них значение «остановка после первого совпадения»:</p></li>
</ol>
<ul class="simple">
<li><p>Правило 1: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&gt;</span> <span class="pre">20</span></code></p></li>
<li><p>Правило 2: <code class="docutils literal notranslate"><span class="pre">msg.payload</span> <span class="pre">&gt;</span> <span class="pre">10</span></code></p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Теперь перетащите узлы debug и подключите их к выходам узлов switch в соответствии с нашим примером. Для сообщений больше 30 подключите узел debug к первому выходу первого узла switch. Для диапазона от 30 до 20 подключите узел debug к первому выходу второго узла Switch. Для диапазона от 20 до 10 подключите узел Debug ко второму выходу второго узла switch. Наконец, для сообщений меньше 10 подключите узел debug к четвертому выходу первого узла switch.</p></li>
<li><p>Разверните поток, нажав кнопку «Развернуть» в правом верхнем углу редактора U-Logic.</p></li>
<li><p>После развертывания нажмите кнопку на узле inject, чтобы запустить его. Узлы debug покажут маршрутизированные сообщения на основе значения температуры.</p></li>
</ol>
<p>Обратите внимание, как сообщения направляются через различные выходы в зависимости от значения температуры. Теперь вы можете спросить, как обновить полезную нагрузку сообщения в зависимости от условия. Для этого вам нужно будет использовать узел change или узел function.</p>
<p><img alt="Scheme 1" src="../_images/ifelse1_1.png" /></p>
<p><em>Поток U-Logic с использованием узла switch для маршрутизации сообщений на основе пороговых значений температуры.</em></p>
<p><img alt="Flow 1" src="../_images/ifelse1.png" /></p>
</section>
<section id="id102">
<h6>Использование узла function<a class="headerlink" href="#id102" title="Ссылка на этот заголовок"></a></h6>
<p>Узел function позволяет реализовать более сложную логику, написав JavaScript код. Он подходит, когда вам нужно больше контроля или когда необходимо проверить несколько значений вместе.</p>
<p>Для наглядности рассмотрим пример с температурой, где необходимо определить, следует ли включать или выключать кондиционер в зависимости от температуры:</p>
<ol class="arabic simple">
<li><p>Перетащите узел inject на холст и задайте его <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как выражение JSONata <code class="docutils literal notranslate"><span class="pre">$random()</span> <span class="pre">*</span> <span class="pre">100</span></code>; этот узел внедрения будет имитировать датчик температуры, генерируя случайное число.</p></li>
<li><p>Перетащите узел function на холст, дважды щелкните по нему и вставьте в него следующий код:</p></li>
</ol>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">Temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Temperature</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">30</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Turn on the air conditioner&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Включить кондиционер</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;No action required&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Никаких действий не требуется</span>
<span class="p">}</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Прежде чем двигаться дальше, давайте остановимся и разберемся, что происходит в коде и как <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> он используется.</p>
<p>В U-Logic <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> используется для передачи данных по потоку. Первоначально он содержит значение температуры, введенное узлом inject. Затем узел function обрабатывает это значение с помощью логики If-Else. Если температура превышает 30°C, <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> устанавливается в «Turn on the air conditioner», указывая на то, что кондиционер следует включить. Если температура составляет 30°C или ниже, <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> устанавливается в «No action required», указывая на то, что кондиционер следует оставить выключенным. Обновленный <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> передается следующему узлу, гарантируя, что система будет реагировать соответствующим образом на входные данные температуры.</p>
<ol class="arabic simple" start="3">
<li><p>Далее перетащите узел debug на холст и подключите его к выходу узла function. Это позволит вам увидеть результаты вашей условной логики в окне отладки U-Logic.</p></li>
<li><p>Разверните поток, нажав кнопку «Развернуть» в правом верхнем углу редактора U-Logic.</p></li>
<li><p>После развертывания нажмите кнопку на узле inject, чтобы запустить его. Вы должны увидеть вывод узла function в окне отладки, который будет показывать true или false в зависимости от значения температуры.</p></li>
</ol>
<p><img alt="If-Else Scheme 2" src="../_images/ifelse2.png" /></p>
<p><img alt="If-Else 2" src="../_images/ifelse2_2.png" />
<em>Поток U-Logic с использованием узла function для реализации простой логики If-Else для контроля температуры.</em></p>
<p><strong>Обработка нескольких потоков с помощью узла function</strong></p>
<p>Обработка простого одностороннего потока с использованием логики If-Else с узлом function была рассмотрена ранее, но что, если необходимо направлять сообщения по разным путям на основе различных условий и оценивать несколько значений при использовании узла function?
В таких случаях узел function в U-Logic обеспечивает гибкость для написания полного кода JavaScript, что позволяет принимать более сложные решения. Кроме того, узел функции поддерживает настройку для нескольких выходных портов, что позволяет вам направлять сообщения в разные пункты назначения на основе различных условий.</p>
<p>Давайте обновим пример для обработки нескольких значений. В этом сценарии в наш процесс принятия решений будет включена как температура, так и влажность. Будет использовано несколько выходных портов в узле function для маршрутизации сообщений на основе различных условий.</p>
<ol class="arabic simple">
<li><p>Перетащите на холст еще один узел inject, установите значение <code class="docutils literal notranslate"><span class="pre">msg.payload.temperature</span></code> как <code class="docutils literal notranslate"><span class="pre">$random()</span> <span class="pre">*</span> <span class="pre">100</span></code> в качестве выражения JSONata и <code class="docutils literal notranslate"><span class="pre">msg.payload.humidity</span></code> в <code class="docutils literal notranslate"><span class="pre">$random()</span> <span class="pre">*</span> <span class="pre">100</span></code>.</p></li>
<li><p>Перетащите другой узел function на холст, дважды щелкните по нему, перейдите на вкладку «Setup» и увеличьте количество выходных портов в соответствии с количеством условий, которые вы будете обрабатывать. Для нашего примера увеличьте количество выходов до 4 и нажмите Готово.</p></li>
</ol>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">Temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">temperature</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">Humidity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">humidity</span><span class="p">;</span>

<span class="c1">// Инициализация выходного массива</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">];</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Temperature</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Humidity</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Высокая температура и низкая влажность</span>
<span class="w">    </span><span class="nx">outputs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Высокая температура и низкая влажность: Включите кондиционер и используйте увлажнитель&quot;</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Temperature</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Humidity</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Высокая температура и высокая влажность</span>
<span class="w">    </span><span class="nx">outputs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Высокая температура и высокая влажность: Включите кондиционер&quot;</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Temperature</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Humidity</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Низкая температура и низкая влажность</span>
<span class="w">    </span><span class="nx">outputs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Низкая температура и низкая влажность: Включите обогреватель и используйте увлажнитель&quot;</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Temperature</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Humidity</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">40</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Низкая температура и высокая влажность</span>
<span class="w">    </span><span class="nx">outputs</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Низкая температура и высокая влажность: Включите обогреватель&quot;</span><span class="w"> </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">return</span><span class="w"> </span><span class="nx">outputs</span><span class="p">;</span>
</pre></div>
</div>
<p>Теперь вы увидите, что узел function имеет четыре выхода, каждый из которых соответствует последовательности условий, которые вы написали. Например, сообщение для первого условия появится на первом выходе узла function, сообщение для второго условия появится на втором выходе и т. д.</p>
<p>Что касается отправляемых выходов, узел Function инициализирует массив с <code class="docutils literal notranslate"><span class="pre">null</span></code> значениями, чтобы гарантировать, что все выходы учтены. Когда выполняется определенное условие, соответствующий индекс в этом массиве обновляется желаемым сообщением. Например, если температура высокая, а влажность низкая, сообщение будет установлено в <code class="docutils literal notranslate"><span class="pre">outputs[0]</span></code>, что является первым выходом. Если ни одно условие не выполняется, выход остается <code class="docutils literal notranslate"><span class="pre">null</span></code>, то есть для этого выхода ничего не отправляется, гарантируя, что только соответствующие выходы заполняются сообщениями.</p>
<ol class="arabic simple" start="3">
<li><p>Далее перетащите четыре узла debug на холст. Подключите каждый узел debug к одному из выходов узла function. Такая настройка позволит вам увидеть сообщения, проходящие через каждый выход на панели Debug.</p></li>
<li><p>Разверните поток, нажав кнопку «Развернуть» в правом верхнем углу редактора U-Logic.</p></li>
<li><p>После развертывания нажмите кнопку на узле inject, чтобы активировать его.</p></li>
</ol>
<p><img alt="Scheme If-Else 3" src="../_images/ifelse3.png" /></p>
<p>Поток U-Logic использует узел function с несколькими выходами для обработки различных условий, таких как температура и влажность.</p>
<p><img alt="If-Else 3" src="../_images/ifelse3_3.png" /></p>
</section>
</section>
<section id="function-switch">
<h5>Выбор между узлом function и узлом switch<a class="headerlink" href="#function-switch" title="Ссылка на этот заголовок"></a></h5>
<p>При выборе между узлом function и узлом switch в U-Logic важно учитывать сложность вашей логики и характер требуемой вам маршрутизации сообщений.</p>
<p>Узел function отлично подходит для сценариев, где необходима сложная логика и подробная обработка сообщений. Он позволяет писать пользовательский код JavaScript, который может обрабатывать сложные условия и выполнять вычисления. Этот узел особенно полезен, когда вам нужно принимать сложные решения на основе нескольких значений или когда вам нужно выполнять подробные обновления объекта <code class="docutils literal notranslate"><span class="pre">msg</span></code>. Например, если ваш поток требует объединения данных из разных источников, применения сложных правил или изменения нескольких свойств <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>, узел function обеспечивает гибкость и мощность для выполнения этих задач.</p>
<p>Напротив, узел switch предназначен для более простой маршрутизации на основе значений. Он идеально подходит для простых сценариев, где вам нужно маршрутизировать сообщения на основе одного значения с несколькими возможными выходами. Этот узел позволяет вам создавать правила на основе определенных значений или условий без необходимости в сложной логике или обширных модификациях сообщений. Если ваша логика маршрутизации включает в себя базовые сравнения и не требует расширенной обработки или вычислений, узел switch обеспечивает более рационализированный и интуитивно понятный подход.</p>
<p>Подводя итог, выбирайте узел function для сложного принятия решений и подробной обработки сообщений, в то время как узел switch лучше подходит для сценариев, где достаточно простой маршрутизации на основе значений.</p>
</section>
</section>
<section id="id103">
<h4>Циклы<a class="headerlink" href="#id103" title="Ссылка на этот заголовок"></a></h4>
<p>Обработка повторяющихся задач — это распространенная проблема в автоматизации и обработке данных. Будь то необходимость итерировать по большим наборам данных, выполнять вычисления или многократно выполнять операции на основе условий, использование циклов может значительно повысить эффективность и масштабируемость.</p>
<p>В этом разделе будет рассмотрено, как реализовать различные типы циклов, которые необходимы в различных контекстах. Также будет рассмотрено их применение и приведены примеры, чтобы помочь вам эффективно внедрять их в U-Logic.</p>
<section id="id104">
<h5>Что такое цикл?<a class="headerlink" href="#id104" title="Ссылка на этот заголовок"></a></h5>
<p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Loops_and_iteration">Цикл</a> — это программная конструкция, которая позволяет вам выполнять блок кода повторно, пока не будет выполнено определенное условие. Различные типы циклов подходят для различных сценариев, в зависимости от того, как и когда вы хотите, чтобы код повторялся:</p>
<ul class="simple">
<li><p><strong>For Loop</strong>: выполняет блок кода определенное количество раз. Это полезно, когда вы заранее знаете, сколько раз вам нужно выполнить итерацию, например, для итерации по диапазону чисел или элементов в списке. Это также известно как цикл с фиксированным числом.</p></li>
<li><p><strong>While Loop</strong>: Повторяет блок кода, пока заданное условие истинно. Этот тип цикла полезен, когда вы заранее не знаете, сколько раз цикл должен будет выполняться. Цикл продолжает выполняться, пока условие не станет ложным.</p></li>
<li><p><strong>For…of / ForEach Loop</strong>: эти циклы используются для итерации итерируемых объектов, таких как массивы или коллекции. Они позволяют получить доступ к каждому элементу в коллекции. Цикл for…of используется специально для итерируемых объектов, в то время как forEach — это метод, доступный для массивов, который применяет функцию к каждому элементу.</p></li>
</ul>
<p>Каждый тип цикла служит определенной цели и может быть выбран в зависимости от требований поставленной задачи.</p>
</section>
<section id="id105">
<h5>Реализация циклов в U-Logic<a class="headerlink" href="#id105" title="Ссылка на этот заголовок"></a></h5>
<p>В этом разделе будет рассмотрено, как реализовать циклы в U-Logic. Сначала будет показано, как добиться цикличности с помощью основных узлов. Также будут рассмотрены некоторые основные операции, обычно выполняемые с помощью циклов, и предоставлены практические примеры для улучшения потоков U-Logic.</p>
<section id="id106">
<h6>Реализация циклов в U-Logic с использованием основных узлов<a class="headerlink" href="#id106" title="Ссылка на этот заголовок"></a></h6>
<p><strong>Цикл While</strong></p>
<p>Чтобы продемонстрировать цикл while в U-Logic, создадим поток, который добавляет случайные символы в строку, пока она не будет содержать символ «Z». Этот пример поможет вам понять, как имитировать цикл while с использованием основных узлов U-Logic.</p>
<ol class="arabic simple">
<li><p>Перетащите узел <strong>inject</strong> на холст. Этот узел запустит начало цикла.</p></li>
<li><p>Добавьте узел <strong>change</strong> для инициализации строковой переменной. Настройте его <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> на пустую строку (<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>). Подключите узел <strong>inject</strong> к этому узлу change .</p></li>
<li><p>Поместите узел <strong>switch</strong> на холст. Настройте его на проверку, <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> содержит ли он символ «Z» (<code class="docutils literal notranslate"><span class="pre">msg.i.includes('Z')</span></code>). Добавьте дополнительное правило для случаев, когда это условие не выполняется (<code class="docutils literal notranslate"><span class="pre">иначе</span></code>). Подключите выход узла <strong>change</strong> к входу узла <strong>switch</strong>.</p></li>
<li><p>Добавьте узел <strong>function</strong> для добавления случайной заглавной буквы к строке. Используйте следующий код JavaScript:</p></li>
</ol>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">msg</span><span class="p">.</span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mf">65</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">26</span><span class="p">));</span><span class="w"> </span><span class="c1">// Добавляем случайную заглавную букву</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Подключите этот узел <strong>function</strong> ко второму выходу узла <strong>switch</strong> (где условие <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> не содержит «Z»). Затем подключите выход этого узла <strong>function</strong> обратно ко входу узла <strong>switch</strong> , чтобы повторить процесс.
5. Перетащите узел <strong>debug</strong> на холст и подключите его ко второму выходу узла <strong>switch</strong> . Этот узел будет отображать текущее значение <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> на панели отладки.
6. Добавьте еще один узел <strong>change</strong> для сигнализации о завершении. Настройте его <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> на <code class="docutils literal notranslate"><span class="pre">completed</span></code>. Подключите этот узел <strong>change</strong> к первому выходу узла <strong>switch</strong> (где <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> содержится «Z»), а затем свяжите его с другим узлом <strong>debug</strong> для отображения сообщения о завершении.</p>
<p><img alt="Scheme Loop While" src="../_images/scheme_while.png" /></p>
<p><img alt="Loop While" src="../_images/while.png" /></p>
</section>
<section id="for">
<h6>Цикл For<a class="headerlink" href="#for" title="Ссылка на этот заголовок"></a></h6>
<p>В традиционном программировании циклы <code class="docutils literal notranslate"><span class="pre">for</span></code> повторяются заданное количество раз на основе индекса или диапазона, при этом <code class="docutils literal notranslate"><span class="pre">while</span></code> циклы выполняются до тех пор, пока выполняется условие <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>В U-Logic вы можете имитировать циклы <code class="docutils literal notranslate"><span class="pre">for</span></code>, управляя счетчиком с узлами для итерации по элементам массива. Увеличивая индексную переменную, вы можете получить доступ к каждому элементу и выполнять операции, эффективно имитируя поведение традиционного цикла <code class="docutils literal notranslate"><span class="pre">for</span></code>.</p>
<p>Вот как можно настроить цикл <code class="docutils literal notranslate"><span class="pre">for</span></code>в U-Logic:</p>
<ol class="arabic simple">
<li><p>Перетащите узел inject на холст и установите <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">[&quot;foo&quot;,&quot;bar&quot;,&quot;foobar&quot;]</span></code>. Этот узел запускает начало цикла и предоставляет массив для обработки.</p></li>
<li><p>Добавьте узел change для инициализации счетчика цикла. Настройте его, установив <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> равной <code class="docutils literal notranslate"><span class="pre">0</span></code>, подключите узел inject к этому узлу change.</p></li>
<li><p>Далее перетащите узел switch на холст. Настройте его для проверки того, равен ли <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> длине массива (<code class="docutils literal notranslate"><span class="pre">msg.i</span> <span class="pre">==</span> <span class="pre">msg.payload.length</span></code>). Добавьте дополнительное правило для случаев, когда это условие не выполняется (<code class="docutils literal notranslate"><span class="pre">иначе</span></code>). Соедините узел change с узлом switch .</p></li>
<li><p>Добавьте еще один узел change для увеличения счетчика. Настройте его на JSONata выражение, присваивающее <code class="docutils literal notranslate"><span class="pre">msg.i</span></code> значение <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">+</span> <span class="pre">1</span></code>. Подключите этот узел change к выходу узла switch , где условие (<code class="docutils literal notranslate"><span class="pre">msg.i</span> <span class="pre">&lt;</span> <span class="pre">msg.payload.length</span></code>) истинно (второй выход).</p></li>
<li><p>Для доступа к элементам массива и их отображения перетащите узел change на холст. Настройте его так, чтобы <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> был установлен на msg.payload[msg.i], получая доступ к элементу массива по текущему индексу. Подключите этот узел change ко второму выходу узла switch (<code class="docutils literal notranslate"><span class="pre">otherwise</span></code>).</p></li>
<li><p>Присоедините узел debug к выходу этого узла change, чтобы вывести текущий элемент массива.</p></li>
<li><p>Для последнего шага добавьте еще один узел change , чтобы сигнализировать о завершении цикла. Настройте его на установку <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">completed</span></code> и подключите к первому выходу узла switch, где условие цикла — <code class="docutils literal notranslate"><span class="pre">msg.i</span> <span class="pre">==</span> <span class="pre">msg.payload.length</span></code>. Наконец, присоедините узел debug , чтобы отобразить сообщение о завершении.</p></li>
</ol>
<p>Этот поток будет проходить по массиву, печатая каждый элемент, пока все элементы не будут обработаны. Как только цикл достигает конца массива, он печатает сообщение «completed» и завершается.</p>
<p><img alt="Scheme Loop 2" src="../_images/scheme_for.png" /></p>
<p><img alt="Loop 2" src="../_images/for.png" /></p>
</section>
<section id="for-of-foreach">
<h6>Цикл For…of / ForEach<a class="headerlink" href="#for-of-foreach" title="Ссылка на этот заголовок"></a></h6>
<p>В традиционном программировании циклы <code class="docutils literal notranslate"><span class="pre">for...of</span></code> и <code class="docutils literal notranslate"><span class="pre">forEach</span></code> обычно используются для итерации по массивам или свойствам объектов, что позволяет обрабатывать отдельные элементы. Поскольку U-Logic не включает эти конкретные конструкции, вы можете повторить их функциональность, используя комбинацию узлов, в частности, узлы split и join.</p>
<p>Вот как можно воспроизвести эту функциональность в U-Logic:</p>
<ol class="arabic simple">
<li><p>Перетащите узел <strong>inject</strong> на холст и установите значение <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">[&quot;foo&quot;,</span> <span class="pre">&quot;bar&quot;,</span> <span class="pre">&quot;foobar&quot;]</span></code>.</p></li>
<li><p>Перетащите узел <strong>split</strong> на холст. Сохраните настройки по умолчанию. Если вы работаете со строкой, убедитесь, что вы выбрали подходящий разделитель для разделения.</p></li>
<li><p>При необходимости используйте узел <strong>change</strong> или <strong>function</strong> для выполнения операций над каждым элементом.</p></li>
<li><p>Перетащите узел <strong>debug</strong> на холст и подключите его к выходу узла <strong>split</strong> .</p></li>
</ol>
<p>При нажатии кнопки узла <strong>inject</strong>, узел <strong>split</strong> будет обрабатывать каждый элемент массива по отдельности, а узел <strong>debug</strong> отобразит каждый из них в окне отладки.</p>
<p>Чтобы узнать, как можно сопоставлять, сортировать, фильтровать и сокращать объем данных с помощью этого подхода, ознакомьтесь с разделом: «Как фильтровать, сопоставлять, сортировать и сокращать объем данных» в U-Logic в разделе «Начало работы с U-Logic/Программирование/Преобразование данных»</p>
<p><img alt="Scheme Loops 3" src="../_images/scheme_foreach.png" /></p>
<p><img alt="Loops 3" src="../_images/foreach.png" /></p>
</section>
<section id="id107">
<h6>Реализация циклов с помощью function узла<a class="headerlink" href="#id107" title="Ссылка на этот заголовок"></a></h6>
<p>Реализация циклов с узлом <a class="reference internal" href="#"><span class="xref myst">function</span></a> проста, если вы знакомы с JavaScript, так как он позволяет вам писать пользовательский код. Однако распространенной проблемой является выяснение того, как отправлять сообщение на каждой итерации, не завершая цикл после первой итерации. В этом разделе будет показано, как при помощи узла function правильно реализовать циклы, гарантируя, что каждая итерация будет обработана и отправлена ​​должным образом, без преждевременного прерывания цикла.</p>
<p>В демонстрационных целях реализуем цикл for.</p>
<ol class="arabic simple">
<li><p>Перетащите узел <strong>inject</strong> на холст и установите значение для <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> как <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">&quot;hello&quot;,</span> <span class="pre">&quot;%&quot;,</span> <span class="pre">true]</span></code>.</p></li>
<li><p>Перетащите узел <strong>function</strong> на холст и добавьте следующий код JavaScript:</p></li>
</ol>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Создать новое сообщение для каждого элемента</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">newMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="nx">msg</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// Копировать оригинальный объект msg</span>
<span class="w">    </span><span class="nx">newMsg</span><span class="p">.</span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"> </span><span class="c1">// Установить payload на текущий элемент</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">newMsg</span><span class="p">);</span><span class="w"> </span><span class="c1">// Отправить сообщение</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Перетащите узел <strong>debug</strong> на холст и подключите его к выходу узла <strong>function</strong>.</p>
<p>Когда вы развертываете поток и нажимаете кнопку <strong>inject</strong>, каждый элемент массива будет отправлен как отдельное сообщение и выведен на панель отладки. Это работает, поскольку <code class="docutils literal notranslate"><span class="pre">node.send()</span></code> метод позволяет отправлять сообщения асинхронно. В отличие от <code class="docutils literal notranslate"><span class="pre">return</span></code>, который немедленно завершает выполнение узла <strong>function</strong>, <code class="docutils literal notranslate"><span class="pre">node.send()</span></code> продолжает обрабатывать и отправлять каждое сообщение, не останавливая цикл.</p>
<p>Используя <code class="docutils literal notranslate"><span class="pre">node.send()</span></code> внутри цикла, вы гарантируете, что каждая итерация создает отдельное сообщение, а узел <strong>function</strong> может эффективно обрабатывать несколько сообщений. Для получения дополнительной информации об этом обратитесь к <a class="reference internal" href="Async-Messages.html"><span class="std std-doc">Документации по отправке сообщений асинхронно</span></a>.</p>
<p><img alt="Scheme Function Loop" src="../_images/scheme_functionfor.png" /></p>
</section>
</section>
</section>
</section>
</section>
<section id="id108">
<h2>Терминология<a class="headerlink" href="#id108" title="Ссылка на этот заголовок"></a></h2>
<p>Ниже приведены основные термины и концепции, используемые в U-Logic для обеспечения ясности и последовательности при общении между проектами.</p>
<section id="id109">
<h3>Поток<a class="headerlink" href="#id109" title="Ссылка на этот заголовок"></a></h3>
<p>Поток представлен в виде вкладки в рабочей области редактора, которая предоставляет новую рабочую область для создания приложений путем соединения узлов. Термин «поток» также используется для неформального описания одного набора соединенных узлов. Таким образом, поток (вкладка) может содержать несколько потоков (наборов соединенных узлов), но формально можно сказать, что поток — это родительская группа нескольких соединенных узлов.</p>
<p><img alt="Flows" src="../_images/flow.png" /></p>
</section>
<section id="id110">
<h3>Подпоток<a class="headerlink" href="#id110" title="Ссылка на этот заголовок"></a></h3>
<p>Подпоток в U-Logic — это набор узлов, которые свернуты в один узел в рабочей области. Он позволяет группировать набор узлов в повторно используемую единицу. Это помогает в организации потоков, содействии повторному использованию и упрощении сложных конструкций потоков путем инкапсуляции нескольких узлов в единое представление узла более высокого уровня.</p>
<p><img alt="Subflow 1" src="../_images/subflow1.png" /></p>
<p><img alt="Subflow 2" src="../_images/subflow2.png" /></p>
</section>
<section id="id111">
<h3>Рабочее пространство<a class="headerlink" href="#id111" title="Ссылка на этот заголовок"></a></h3>
<p>В рабочей области создаются потоки (группы узлов) путем перетаскивания узлов из палитры и их соединения. Добавление новой вкладки потока дает вам новое рабочее пространство.</p>
<p><img alt="Workspace" src="../_images/workspace.png" /></p>
</section>
<section id="id112">
<h3>Узел<a class="headerlink" href="#id112" title="Ссылка на этот заголовок"></a></h3>
<p>Узел — это фундаментальный строительный блок, используемый для создания потоков. Каждый узел представляет собой отдельную часть функциональности или определенное действие, которое может быть выполнено в потоке.</p>
<p><img alt="Node" src="../_images/node.png" /></p>
</section>
<section id="id113">
<h3>Провода<a class="headerlink" href="#id113" title="Ссылка на этот заголовок"></a></h3>
<p>«Провода» относятся к соединениям, которые связывают узлы вместе, чтобы определить поток данных. Эти провода визуально представляют направление и поток информации от одного узла к другому в потоке U-Logic.</p>
<p><img alt="Wires" src="../_images/wire.png" /></p>
</section>
<section id="id114">
<h3>Порты входа и выхода<a class="headerlink" href="#id114" title="Ссылка на этот заголовок"></a></h3>
<p>Узлы в U-Logic имеют порты входа и выхода, представленные маленькими кружками на левой (вход) и правой (выход) сторонах узла. Эти порты указывают, где данные входят или выходят из узла. Это позволяет вам соединять различные узлы с помощью проводов.</p>
<p><img alt="Input and Output Ports" src="../_images/node_io.png" /></p>
</section>
<section id="id115">
<h3>Сообщение<a class="headerlink" href="#id115" title="Ссылка на этот заголовок"></a></h3>
<p>Сообщение по сути является объектом JavaScript, который переносит данные между узлами в потоке. Это сообщение содержит как основную полезную нагрузку данных, так и дополнительные метаданные, что позволяет узлам эффективно общаться и обрабатывать информацию.</p>
<p><img alt="Message" src="../_images/message.png" /></p>
</section>
<section id="payload">
<h3>Payload<a class="headerlink" href="#payload" title="Ссылка на этот заголовок"></a></h3>
<p>Основное свойство в сообщении. Это свойство по умолчанию, с которым будет работать большинство узлов. Это свойство содержит основные данные, которые узлы в потоке обрабатывают и которыми манипулируют.</p>
</section>
<section id="id116">
<h3>Контекст<a class="headerlink" href="#id116" title="Ссылка на этот заголовок"></a></h3>
<p>Контекст относится к механизму хранения, который позволяет узлам хранить данные между вызовами. Он предоставляет узлам способ совместного использования данных в пределах одного экземпляра или потока, в разных потоках в U-Logic. О дополнительной информации можно узнать здесь <a class="reference internal" href="Understand-Variables.html"><span class="std std-doc">Понимание переменных Node, Flow, Global в U-Logic</span></a>.</p>
</section>
<section id="id117">
<h3>Узел function<a class="headerlink" href="#id117" title="Ссылка на этот заголовок"></a></h3>
<p>Узел function в U-Logic позволяет вам писать пользовательские функции JavaScript для обработки и управления сообщениями в ваших потоках.</p>
</section>
<section id="id118">
<h3>Палитра узлов<a class="headerlink" href="#id118" title="Ссылка на этот заголовок"></a></h3>
<p>Палитра представляет собой боковую панель, содержащую все узлы.</p>
<p><img alt="Palette Node" src="../_images/palette_node.png" /></p>
</section>
<section id="id119">
<h3>Редактор<a class="headerlink" href="#id119" title="Ссылка на этот заголовок"></a></h3>
<p>Редактор в U-Logic — это графический интерфейс, в котором вы создаете и управляете потоками. Он включает в себя все компоненты: рабочее пространство, палитру для узлов, вкладки для организации потоков и боковую панель для настройки и развертывания.</p>
<!-- сделать скрин с обновленным лого+название -->
</section>
<section id="id120">
<h3>Экземпляр<a class="headerlink" href="#id120" title="Ссылка на этот заголовок"></a></h3>
<p>В U-Logic экземпляр относится к работающей среде выполнения U-Logic, которая управляет потоками и взаимодействиями узлов.</p>
<!-- Dashboard -->
<!-- ### Панель инструментов U-Logic
Панель инструментов U-Logic — это набор узлов и компонентов пользовательского интерфейса, которые позволяют создавать веб-панели мониторинга в U-Logic. Он предоставляет виджеты, такие как кнопки, диаграммы, датчики и текстовые поля для отображения и взаимодействия с данными из ваших потоков в режиме реального времени, для получения дополнительной информации обратитесь к официальной документации U-Logic Dashboard 2.0 . -->
</section>
<section id="id121">
<h3>Развертывание потока<a class="headerlink" href="#id121" title="Ссылка на этот заголовок"></a></h3>
<p>Развертывание потока в U-Logic означает активацию изменений потока в среде выполнения. Это делается нажатием кнопки «Развернуть» в редакторе, активируя узлы для обработки данных или выполнения задач, определенных в потоке.</p>
<p><img alt="Deploy Button" src="../_images/deploy.png" /></p>
</section>
<section id="id122">
<h3>Импорт, экспорт, группировка потоков<a class="headerlink" href="#id122" title="Ссылка на этот заголовок"></a></h3>
<p>Потоки можно импортировать, экспортировать и группировать в U-Logic, что позволяет вам делиться своими потоками с другими или импортировать потоки, созданные другими. Потоки экспортируются в формате JSON и обычно называются <code class="docutils literal notranslate"><span class="pre">flow.json</span></code>. Группировка потоков позволяет вам организовывать связанные потоки вместе для лучшего управления и обмена. Эта функция облегчает совместную работу и обмен проектами U-Logic в сообществе.</p>
</section>
</section>
<section id="id123">
<h2>Горячие клавиши U-Logic<a class="headerlink" href="#id123" title="Ссылка на этот заголовок"></a></h2>
<p>Использование горячих клавиш в U-Logic помогает работать быстрее, облегчая навигацию, редактирование и управление потоками. Ниже приведен список горячих клавиш U-Logic:</p>
<section id="id124">
<h3>Общие горячие клавиши<a class="headerlink" href="#id124" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ctrl + E</p></td>
<td><p>⌘ + E</p></td>
<td><p>Открыть диалог экспорта</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + I</p></td>
<td><p>⌘ + I</p></td>
<td><p>Открыть диалог импорта</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Z</p></td>
<td><p>⌘ + Z</p></td>
<td><p>Отменить последнее действие</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Y</p></td>
<td><p>⌘ + Y</p></td>
<td><p>Повторить последнее отмененное действие</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + D</p></td>
<td><p>⌘ + D</p></td>
<td><p>Развернуть поток</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Space</p></td>
<td><p>⌘ + Space</p></td>
<td><p>Открыть/Закрыть боковую панель</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + P</p></td>
<td><p>⌘ + P</p></td>
<td><p>Открыть/Закрыть палитру узлов</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Shift + P</p></td>
<td><p>⌘ + Shift + P</p></td>
<td><p>Показать список действий</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Shift + L</p></td>
<td><p>⌘ + Shift + L</p></td>
<td><p>Показать журнал событий</p></td>
</tr>
<tr class="row-odd"><td><p>Alt + Shift + P</p></td>
<td><p>⌥ + Shift + P</p></td>
<td><p>Открыть управление палитрой</p></td>
</tr>
<tr class="row-even"><td><p>Shift + ,</p></td>
<td><p>⇧ + ,</p></td>
<td><p>Открыть настройки горячих клавиш</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Alt + R</p></td>
<td><p>⌘ + ⌥ + R</p></td>
<td><p>Показать обзор изменений</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + G, затем C</p></td>
<td><p>⌘ + G, затем C</p></td>
<td><p>Открыть панель «конфиг» в боковой панели</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + G, затем I</p></td>
<td><p>⌘ + G, затем I</p></td>
<td><p>Открыть панель «инфо» в боковой панели</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + G, затем H</p></td>
<td><p>⌘ + G, затем H</p></td>
<td><p>Открыть панель «справка» в боковой панели</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + G, затем D</p></td>
<td><p>⌘ + G, затем D</p></td>
<td><p>Открыть панель «отладка» в боковой панели</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Alt + L</p></td>
<td><p>⌘ + ⌥ + L</p></td>
<td><p>Очистить панель отладки</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Enter</p></td>
<td><p>⌘ + Enter</p></td>
<td><p>Подтвердить редактирование</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Escape</p></td>
<td><p>⌘ + Escape</p></td>
<td><p>Отменить редактирование</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id125">
<h3>Рабочая область<a class="headerlink" href="#id125" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ctrl + «+»</p></td>
<td><p>⌘ + +</p></td>
<td><p>Увеличить масштаб</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + «-»</p></td>
<td><p>⌘ + -</p></td>
<td><p>Уменьшить масштаб</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + 0</p></td>
<td><p>⌘ + 0</p></td>
<td><p>Сбросить масштаб до 100%</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + ,</p></td>
<td><p>⌘ + ,</p></td>
<td><p>Настроить вид в параметрах пользователя</p></td>
</tr>
<tr class="row-even"><td><p>Shift + ↑</p></td>
<td><p>⇧ + ↑</p></td>
<td><p>Переместить вид вверх на 10 ячеек сетки</p></td>
</tr>
<tr class="row-odd"><td><p>Shift + ↓</p></td>
<td><p>⇧ + ↓</p></td>
<td><p>Переместить вид вниз на 10 ячеек сетки</p></td>
</tr>
<tr class="row-even"><td><p>Shift + ←</p></td>
<td><p>⇧ + ←</p></td>
<td><p>Переместить вид влево на 10 ячеек сетки</p></td>
</tr>
<tr class="row-odd"><td><p>Shift + →</p></td>
<td><p>⇧ + →</p></td>
<td><p>Переместить вид вправо на 10 ячеек сетки</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + ↑</p></td>
<td><p>⌘ + ↑</p></td>
<td><p>Прокрутить рабочую область вверх</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + ↓</p></td>
<td><p>⌘ + ↓</p></td>
<td><p>Прокрутить рабочую область вниз</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + ←</p></td>
<td><p>⌘ + ←</p></td>
<td><p>Прокрутить рабочую область влево</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + →</p></td>
<td><p>⌘ + →</p></td>
<td><p>Прокрутить рабочую область вправо</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id126">
<h3>Вкладка потока<a class="headerlink" href="#id126" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alt + W</p></td>
<td><p>⌥ + W</p></td>
<td><p>Скрыть текущий поток</p></td>
</tr>
<tr class="row-odd"><td><p>Alt + Shift + W</p></td>
<td><p>⌥ + ⇧ + W</p></td>
<td><p>Показать/повторно открыть последний скрытый поток</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Shift + F</p></td>
<td><p>⌘ + ⇧ + F</p></td>
<td><p>Показать список потоков для переключения</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + [</p></td>
<td><p>⌘ + [</p></td>
<td><p>Открыть предыдущую вкладку потока</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + ]</p></td>
<td><p>⌘ + ]</p></td>
<td><p>Открыть следующую вкладку потока</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Shift + →</p></td>
<td><p>⌘ + Shift + →</p></td>
<td><p>Перейти к следующему положению</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Shift + ←</p></td>
<td><p>⌘ + Shift + ←</p></td>
<td><p>Перейти к предыдущему положению</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id127">
<h3>Группа<a class="headerlink" href="#id127" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ctrl + Shift + C</p></td>
<td><p>⌘ + Shift + C</p></td>
<td><p>Копировать стиль выбранной группы</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Shift + V</p></td>
<td><p>⌘ + Shift + V</p></td>
<td><p>Вставить/применить скопированный стиль группы</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + Shift + G</p></td>
<td><p>⌘ + Shift + G</p></td>
<td><p>Добавить выбранные группы или узлы в новую группу</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + Shift + U</p></td>
<td><p>⌘ + Shift + U</p></td>
<td><p>Разгруппировать группы или узлы</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id128">
<h3>Узел<a class="headerlink" href="#id128" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ctrl + Delete</p></td>
<td><p>⌘ + Delete</p></td>
<td><p>Удалить выбранный узел и переподключить провода</p></td>
</tr>
<tr class="row-odd"><td><p>Enter</p></td>
<td><p>⏎</p></td>
<td><p>Открыть диалог свойств узла</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + F</p></td>
<td><p>⌘ + F</p></td>
<td><p>Поиск узлов в потоке</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id129">
<h3>Провод<a class="headerlink" href="#id129" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alt + L, затем L</p></td>
<td><p>⌥ + L, затем L</p></td>
<td><p>Разделить провод узлом связи</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id130">
<h3>Выделение<a class="headerlink" href="#id130" title="Ссылка на этот заголовок"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Основное сочетание</p></th>
<th class="head"><p>Альтернативное сочетание</p></th>
<th class="head"><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ctrl + C</p></td>
<td><p>⌘ + C</p></td>
<td><p>Копировать выделенное</p></td>
</tr>
<tr class="row-odd"><td><p>Ctrl + X</p></td>
<td><p>⌘ + X</p></td>
<td><p>Вырезать выделенное</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + V</p></td>
<td><p>⌘ + V</p></td>
<td><p>Вставить скопированное/вырезанное</p></td>
</tr>
<tr class="row-odd"><td><p>Delete</p></td>
<td><p>⌫</p></td>
<td><p>Удалить выделенное</p></td>
</tr>
<tr class="row-even"><td><p>Ctrl + A</p></td>
<td><p>⌘ + A</p></td>
<td><p>Выбрать все узлы</p></td>
</tr>
<tr class="row-odd"><td><p>Escape</p></td>
<td><p>⎋</p></td>
<td><p>Снять выделение</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id131">
<h3>Пользовательские горячие клавиши<a class="headerlink" href="#id131" title="Ссылка на этот заголовок"></a></h3>
<p>U-Logic позволяет настраивать горячие клавиши под ваш рабочий процесс, облегчая использование редактора и ускоряя выполнение общих задач.</p>
<section id="id132">
<h4>Как настроить пользовательские горячие клавиши:<a class="headerlink" href="#id132" title="Ссылка на этот заголовок"></a></h4>
<ol class="arabic simple">
<li><p>Чтобы настроить пользовательские горячие клавиши, перейдите в раздел «Клавиши» в параметрах пользователя, или нажмите <code class="docutils literal notranslate"><span class="pre">Shift</span> <span class="pre">+</span> <span class="pre">?</span></code></p></li>
<li><p>В Настройках клавиатуры вы увидите действия с назначенными горячими клавишами, а также те, которые не назначены. Чтобы изменить или назначить горячие клавиши, нажмите на «Не назначено» или существующую горячую клавишу рядом с действием, которое вы хотите изменить.</p></li>
<li><p>Введите предпочитаемую комбинацию клавиш для действия. Затем выберите соответствующую область действия и нажмите значок галочки, чтобы сохранить изменения. Ваши новые горячие клавиши теперь активны.</p></li>
</ol>
</section>
</section>
</section>
<section id="id133">
<h2>Узлы<a class="headerlink" href="#id133" title="Ссылка на этот заголовок"></a></h2>
<p>В U-Logic узлы предназначены для предоставления базовых строительных блоков для создания потоков.</p>
<p>Основные узлы включают узлы для базовой функциональности, такой как ввод/вывод, обработка и поток управления. Они являются основой, на которой могут быть построены более сложные рабочие процессы, и они необходимы для работы U-Logic.</p>
<p>Узлы сгруппированы в несколько разделов на боковой панели узлов:</p>
<ol class="arabic simple">
<li><p><strong>общие</strong> - Разнообразные узлы</p></li>
<li><p><strong>функция</strong> - Управление потоком, блокировка или отправка дополнительных сообщений.</p></li>
<li><p><strong>сеть</strong> — Прием и отправка сообщений по сети по разным протоколам.</p></li>
<li><p><strong>последоват-ть</strong> - Работа с коллекциями сообщений или их создание.</p></li>
<li><p><strong>анализатор</strong> - Преобразование данных из одного формата в другой.</p></li>
<li><p><strong>хранилище</strong> — Для чтения или записи файлов.</p></li>
</ol>
<section id="id134">
<h3>общие<a class="headerlink" href="#id134" title="Ссылка на этот заголовок"></a></h3>
<section id="inject">
<h4>inject<a class="headerlink" href="#inject" title="Ссылка на этот заголовок"></a></h4>
<p>Узел inject является началом многих потоков, которые запускаются вручную. Кнопка слева от узла отправляет сообщение подключенным узлам. По этой причине его часто используют также для отладки, чтобы вводить значения в точке выбора. Элемент сообщения также может быть пустым. Сообщение для отправки по умолчанию использует временную метку в качестве payload и пустой topic.</p>
<p>Свойства сообщений можно установить для потоковой переменной, глобальных переменных и многих других типов, включая выражения JSONata</p>
<p>Потоки также могут быть запущены один раз сразу после того, как U-Logic запускает потоки или с задержкой. Это полезно для установки начального состояния из потока при загрузке.</p>
<p>Узел inject также может запускать поток на основе расписания. Расписания имеют возможности, имитирующие cron. В нижней части панели свойств в разделе повтора можно выбрать «в определенное время».</p>
<p>Повторение измерения на интервале выполняется выбором «с интервалом» в разделе «Повторять». В расписании требуется ввод числа больше 0 и меньше 2^31. Если значение меньше нуля U-Logic отобразит ошибку. Если значение 0, то значение раздела «Повторять» поменяется при сохранении с «с интервалом» на «нет».</p>
<section id="id135">
<h5>Примеры<a class="headerlink" href="#id135" title="Ссылка на этот заголовок"></a></h5>
<section id="inject-u-logic">
<h6>inject при запуске U-Logic<a class="headerlink" href="#inject-u-logic" title="Ссылка на этот заголовок"></a></h6>
<p>Для настройки состояния при запуске U-Logic узел inject может быть установлен на нулевую задержку для запуска потока. Когда узел inject настроен на запуск только один раз, после метки внутри узла отображается маленькая «1».</p>
<p><img alt="Inject on start" src="../_images/once.png" /></p>
</section>
<section id="id136">
<h6>Запускайте поток ежедневно в полночь<a class="headerlink" href="#id136" title="Ссылка на этот заголовок"></a></h6>
<p>Выбрав «в определенное время» в разделе «Повторять», узел ввода может генерировать сообщение в установленное время. Полезно для обработки данных в установленное время.</p>
<p><img alt="Inject everyday" src="../_images/everyday.png" /></p>
</section>
<section id="id137">
<h6>Вставьте статическую строку<a class="headerlink" href="#id137" title="Ссылка на этот заголовок"></a></h6>
<p>Узел inject также может устанавливать payload для других входных данных, например, статической строки. Обратите внимание, что эта строка не может иметь несколько строк.</p>
<p><img alt="Inject string type variable" src="../_images/inject_string.png" /></p>
<p><img alt="Inject string" src="../_images/string.png" /></p>
</section>
</section>
<section id="id138">
<h5>Документация по узлу<a class="headerlink" href="#id138" title="Ссылка на этот заголовок"></a></h5>
<p>Вводит сообщение в поток вручную или с регулярными интервалами. Полезная нагрузка сообщения может быть различных типов, включая строки, объекты JavaScript или текущее время.</p>
<section id="id139">
<h6>Выходные данные<a class="headerlink" href="#id139" title="Ссылка на этот заголовок"></a></h6>
<p><strong>payload</strong> - Настроенный payload сообщения.</p>
<p><strong>topic</strong> - Необязательное свойство, которое можно настроить в узле.</p>
</section>
<section id="id140">
<h6>Потробности<a class="headerlink" href="#id140" title="Ссылка на этот заголовок"></a></h6>
<p>Узел inject может инициировать поток с определенным значением payload. payload по умолчанию — это временная метка текущего времени в миллисекундах с 1 января 1970 года.</p>
<p>Узел также поддерживает внедрение строк, чисел, логических значений, объектов JavaScript или значений потока/глобального контекста.</p>
<p>По умолчанию узел запускается вручную нажатием на его кнопку в редакторе. Его также можно настроить через регулярные интервалы или по расписанию.</p>
<p>Его также можно настроить на однократный запуск при каждом запуске потоков.</p>
<p>Максимальный интервал , который можно указать, составляет около 596 часов / 24 дня.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Параметры «с интервалом» и «в определенное время» используют стандартную систему cron.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Чтобы включить новую строку в строку, необходимо использовать узел function или template для создания payload.</p>
</div>
</section>
</section>
</section>
<section id="debug">
<h4>debug<a class="headerlink" href="#debug" title="Ссылка на этот заголовок"></a></h4>
<section id="id141">
<h5>Где и почему используется узел debug?<a class="headerlink" href="#id141" title="Ссылка на этот заголовок"></a></h5>
<p>Узел debug используется для понимания сообщений и данных, проходящих через ваши потоки. Во время разработки настоятельно рекомендуется добавлять узлы debug в ключевые точки вашего потока, чтобы у вас была видимость и понимание того, что передается.</p>
<p>В редакторе U-Logic отладочные сообщения можно просмотреть на правой боковой панели под значком отладки.</p>
<p><img alt="Debug" src="../_images/debug.png" /></p>
</section>
<section id="id142">
<h5>Параметры конфигурации<a class="headerlink" href="#id142" title="Ссылка на этот заголовок"></a></h5>
<p>Узел debug имеет ряд параметров конфигурации:</p>
<ul class="simple">
<li><p>«Выводить», т.е. то, что вы хотите, чтобы вывел узел debug:</p>
<ul>
<li><p><strong>msg.</strong></p>
<ul>
<li><p>Узел debug можно настроить на вывод любого свойства объекта msg. Возможно, вы захотите вывести значение <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code> или <code class="docutils literal notranslate"><span class="pre">msg.my_property</span></code> вместо этого.</p></li>
</ul>
</li>
<li><p><strong>весь msg объект сообщения</strong></p>
<ul>
<li><p>Для просмотра всего объекта <code class="docutils literal notranslate"><span class="pre">msg</span></code> и всех его свойств.</p></li>
<li><p>Объект msg часто содержит ценную информацию, которую можно использовать в ваших потоках.</p></li>
</ul>
</li>
<li><p><strong>выражение</strong></p>
<ul>
<li><p>Язык запросов <a class="reference external" href="https://jsonata.org/">JSONata</a> можно использовать для преобразования свойств объекта msg для вывода более понятной человеку информации.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>«В», т.е. то, куда вы хотите, чтобы узел debug вывел:</p>
<ul>
<li><p><strong>окно отладки</strong></p>
<ul>
<li><p>Если эта функция включена, вывод будет отправлен на боковую панель отладки.</p></li>
</ul>
</li>
<li><p><strong>статус узла (32 символа)</strong></p>
<ul>
<li><p>Если включено, вывод будет отображаться под узлом.</p></li>
<li><p>Для персонализации вывода статуса доступны дополнительные опции:</p>
<ul>
<li><p><strong>то, что выводит этот узел</strong> - Это покажет тот же вывод, что и вывод отладки.</p></li>
<li><p><strong>msg.</strong> - В выходных данных о статусе можно отобразить что-то отличное от того, что отображается в выходных данных отладки.</p></li>
<li><p><strong>выражение</strong> - Язык запросов <a class="reference external" href="https://jsonata.org/">JSONata</a> можно использовать для преобразования свойств объекта <code class="docutils literal notranslate"><span class="pre">msg</span></code> для вывода более понятной человеку информации.</p></li>
<li><p><strong>message count</strong> - Здесь будет показано количество сообщений, прошедших через узел отладки.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id143">
<h5>Лучшие советы<a class="headerlink" href="#id143" title="Ссылка на этот заголовок"></a></h5>
<section id="id144">
<h6>Копировать путь<a class="headerlink" href="#id144" title="Ссылка на этот заголовок"></a></h6>
<p>Функция «Копировать путь» — это реальная экономия времени и избавление от многих проблем при построении потоков. Она помогает избегать опечатки и другие ошибки.</p>
<p><img alt="Copy path in debug" src="../_images/debug_path.png" /></p>
</section>
<section id="id145">
<h6>Копировать значение<a class="headerlink" href="#id145" title="Ссылка на этот заголовок"></a></h6>
<p>При разработке потоков вам может понадобиться точная копия значения свойства в объекте <code class="docutils literal notranslate"><span class="pre">msg</span></code> для использования в узле inject, change или function для моделирования данных. Это чрезвычайно полезно, поскольку создание демонстрационного потока, содержащего реальные данные, может помочь с решением возникающих проблем.</p>
</section>
<section id="id146">
<h6>Закрепить видимость<a class="headerlink" href="#id146" title="Ссылка на этот заголовок"></a></h6>
<p>Когда в элементе отладки много элементов, может быть сложно увидеть интересующие элементы. Кнопка «Закрепить видимость» поможет вам быстро находить эти элементы.</p>
<p><img alt="Pin debug" src="../_images/debug_pin.png" /></p>
</section>
</section>
<section id="id147">
<h5>Документация по узлу<a class="headerlink" href="#id147" title="Ссылка на этот заголовок"></a></h5>
<p>Отображает выбранные свойства сообщения на вкладке боковой панели отладки и, при необходимости, журнал времени выполнения. По умолчанию он отображает <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>, но может быть настроен для отображения любого свойства, полного сообщения или результата выражения JSONata.</p>
<section id="id148">
<h6>Подробности<a class="headerlink" href="#id148" title="Ссылка на этот заголовок"></a></h6>
<p>Боковая панель отладки обеспечивает структурированное представление отправляемых сообщений, что упрощает понимание их структуры.</p>
<p>Объекты и массивы JavaScript могут быть свернуты и развернуты по мере необходимости. Буферные объекты могут отображаться как необработанные данные или как строка, если это возможно.</p>
<p>Рядом с каждым сообщением боковая панель отладки содержит информацию о времени получения сообщения, узле, который его отправил, и типе сообщения. Нажатие на идентификатор исходного узла покажет этот узел в рабочей области.</p>
<p>Кнопка на узле может использоваться для включения или отключения его вывода. Рекомендуется отключить или удалить любые узлы debug, которые не используются.</p>
<p>Узел также можно настроить на отправку всех сообщений в окно отладки или на отправку короткого (32 символа) текста статуса узла.</p>
</section>
</section>
</section>
<section id="complete">
<h4>complete<a class="headerlink" href="#complete" title="Ссылка на этот заголовок"></a></h4>
<section id="id149">
<h5>Что такое узел complete?<a class="headerlink" href="#id149" title="Ссылка на этот заголовок"></a></h5>
<p>Узел complete в U-Logic используется для запуска потока после того, как указанный узел завершает свое выполнение или определенную задачу. Это достигается путем информирования среды выполнения U-Logic о завершении задачи, выполняемой самим узлом.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Хотя этот узел поддерживается всеми узлами, использовать его могут только те узлы, которые реализовали поддержку, информируя среду выполнения о завершении определенной задачи.</p>
</div>
<p>Этот узел должен быть настроен для обработки событий для выбранных узлов. Он не предоставляет возможность автоматически включить обработку событий со всех узлов.</p>
<p>Для уведомления о завершении задачи в середине функции можно использовать <code class="docutils literal notranslate"><span class="pre">node.call</span></code> в узле функции.</p>
</section>
<section id="id150">
<h5>Варианты использования<a class="headerlink" href="#id150" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p>Асинхронное завершение задачи:</p></li>
</ul>
<p>Предположим, у вас есть поток, где один узел выполняет асинхронную задачу, например, извлечение данных из API. Вы можете использовать узел complete для запуска следующего набора действий в потоке только после того, как данные были успешно извлечены.</p>
<ul class="simple">
<li><p>Завершение длительного процесса:</p></li>
</ul>
<p>Для процессов, выполнение которых занимает значительное время, таких как пакетные задания, преобразования данных или задачи машинного обучения, узел сomplete можно использовать для обозначения окончания этих процессов и запуска последующих действий или уведомлений.</p>
<ul class="simple">
<li><p>Пакетная обработка:</p></li>
</ul>
<p>Для задач пакетной обработки узел complete может использоваться для сигнализации о завершении пакетного процесса. Это может быть полезно в рабочих процессах обработки данных, где данные обрабатываются пакетами, и вам нужно знать, когда каждый пакет завершен, прежде чем начинать следующий.</p>
</section>
<section id="id151">
<h5>Пример<a class="headerlink" href="#id151" title="Ссылка на этот заголовок"></a></h5>
<p>В примере потока ниже у нас есть узел inject, отправляющий get запрос http request на фиктивный API. После успешного завершения запроса полный узел обработает событие.</p>
<p><img alt="Complete node Example" src="../_images/complete_example.png" /></p>
</section>
<section id="id152">
<h5>Выходное значение<a class="headerlink" href="#id152" title="Ссылка на этот заголовок"></a></h5>
<p>Когда задача завершается указанным узлом в узле complete, он отправляет тот же объект сообщения, что и этот указанный узел.</p>
</section>
<section id="id153">
<h5>Документация по узлу<a class="headerlink" href="#id153" title="Ссылка на этот заголовок"></a></h5>
<p>Запускает поток, когда другой узел завершает работу</p>
<section id="id154">
<h6>Подробности<a class="headerlink" href="#id154" title="Ссылка на этот заголовок"></a></h6>
<p>Если узел сообщает среде выполнения о завершении обработки сообщения, этот узел можно использовать для запуска второго потока.</p>
<p>Этот узел должен быть настроен для обработки события для выбранных узлов в потоке. В отличие от узла catch, он не обеспечивает режим «всех узлов», который автоматически применяется ко всем узлам в потоке.</p>
</section>
</section>
</section>
<section id="catch">
<h4>catch<a class="headerlink" href="#catch" title="Ссылка на этот заголовок"></a></h4>
<p>Узел catch в U-Logic имеет решающее значение для обработки ошибок в ваших потоках. Всякий раз, когда в потоке возникает ошибка, этот узел ее перехватывает. Как только узел catch перехватывает исключение, он может передать соответствующую информацию в объекте <code class="docutils literal notranslate"><span class="pre">msg</span></code> другому узлу.</p>
<p>Это помогает вам управлять ошибками, которые могут возникнуть во время выполнения потока, и реагировать на них, а также предотвращать сбои, что обеспечивает бесперебойную работу и эффективное управление ошибками.</p>
<section id="id155">
<h5>Настройка узла catch<a class="headerlink" href="#id155" title="Ссылка на этот заголовок"></a></h5>
<p>Узел catch можно настроить с помощью свойства «Ловить оишбки» со следующими параметрами:</p>
<ul class="simple">
<li><p><strong>всех узлов</strong>: фиксирует ошибки со всех узлов в одной вкладке или потоке.</p></li>
<li><p><strong>in same group</strong>: ограничивает захват ошибок узлами в той же группе, частью которой он является.</p></li>
<li><p><strong>выбранных узлов</strong>: фиксирует ошибки из определенных узлов, выбранных вами.</p></li>
</ul>
</section>
<section id="id156">
<h5>Варианты использования и примеры<a class="headerlink" href="#id156" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p><strong>Обработка ошибок для внешних интеграций</strong>: узел catch обрабатывает ошибки при взаимодействии с API, включая сетевые проблемы, ошибки ответа, недоступность сервера, потери соединения с базой данных, ошибки тайм-аута</p></li>
</ol>
<p>В примере потока ниже узел inject устанавливает тайм-аут запроса в 2000 миллисекунд. В узле http request был передан фиктивный URL с параметром задержки, установленным на 3 секунды, имитируя отложенный ответ. Эта имитированная задержка вызовет ошибку тайм-аута запроса, которая затем будет перехвачена узлом catch. После перехвата ошибки поток повторит запрос с задержкой в ​​5 секунд.</p>
<p><img alt="Catch node example with http request" src="../_images/catch_example_http.png" /></p>
<ol class="arabic simple" start="2">
<li><p><strong>Проверка пользовательского ввода</strong>: в приложениях с пользовательским вводом ошибки проверки могут нарушить поток. Узел сatch обрабатывает эти ошибки, предоставляя обратную связь или корректирующие действия.</p></li>
</ol>
<p>В примере потока ниже узел function сортирует входные данные, полученные от узла inject, используя метод sort, который доступен только для массивов. Отправка других типов данных вызовет ошибку, которая будет перехвачена узлом catch, который затем отправит сообщение проверки.</p>
<p><img alt="Catch node example with valid data" src="../_images/catch_example.png" /></p>
</section>
<section id="id157">
<h5>Объект сообщения, отправленный узлом Catch<a class="headerlink" href="#id157" title="Ссылка на этот заголовок"></a></h5>
<p>Узел catch при возникновении ошибки выдает объект сообщения, содержащий следующие свойства:</p>
<ul class="simple">
<li><p>payload: payload, которая передается узлу, выдавшему ошибку.</p></li>
<li><p>сообщение: сообщение об ошибке</p></li>
<li><p>источник - объект, содержащий информацию об узле, регистрирующем ошибку:</p>
<ul>
<li><p>id - идентификатор исходного узла</p></li>
<li><p>тип - тип исходного узла</p></li>
<li><p>имя - имя, если установлено, исходного узла</p></li>
<li><p>количество: сколько раз это сообщение было отправлено этим узлом.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id158">
<h5>Документация по узлу<a class="headerlink" href="#id158" title="Ссылка на этот заголовок"></a></h5>
<p>Перехват ошибок, возникающих в узлах на одной вкладке.</p>
</section>
<section id="id159">
<h5>Выходные данные<a class="headerlink" href="#id159" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error.message</span></code> - сообщение об ошибке.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error.source.id</span></code> - идентификатор узла, выдавшего ошибку.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error.source.type</span></code> - тип узла, вызвавшего ошибку.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error.source.name</span></code> - имя узла, выдавшего ошибку, если оно установлено.</p></li>
</ul>
<section id="id160">
<h6>Подробности<a class="headerlink" href="#id160" title="Ссылка на этот заголовок"></a></h6>
<p>Если узел выдает ошибку при обработке сообщения, поток обычно останавливается. Этот узел может использоваться для перехвата этих ошибок и их обработки с помощью выделенного потока.</p>
<p>По умолчанию узел будет перехватывать ошибки, выданные любым узлом на той же вкладке. В качестве альтернативы он может быть нацелен на определенные узлы или настроен на перехват только тех ошибок, которые еще не были перехвачены нацеленным узлом catch.</p>
<p>При возникновении ошибки все соответствующие узлы catch получат сообщение.</p>
<p>Если ошибка выдается внутри подпотока, ошибка будет обработана любыми узлами catch внутри подпотока. Если ни один из них не существует, ошибка будет распространена на вкладку, на которой находится экземпляр подпотока.</p>
<p>Если сообщение уже имеет <code class="docutils literal notranslate"><span class="pre">error</span></code> свойство, оно копируется в <code class="docutils literal notranslate"><span class="pre">_error</span></code>.</p>
</section>
</section>
</section>
<section id="status">
<h4>status<a class="headerlink" href="#status" title="Ссылка на этот заголовок"></a></h4>
<section id="status-u-logic">
<h5>Для чего используется узел status в U-Logic?<a class="headerlink" href="#status-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел status позволяет вам отслеживать состояние отдельных узлов или всех узлов, работающих в вашем потоке. Узел status не создает <code class="docutils literal notranslate"><span class="pre">payload</span></code>, но он сообщает о работе узла. Это позволит вам программно реагировать на состояния ошибок или ограничения вариантов использования в потоке.</p>
<p>Например, узел delay, который ставит в очередь внешние сообщения, может захотеть сообщить об ошибке после того, как очередь превысит определенное число. Узел status может использоваться для отслеживания количества сообщений в очереди.</p>
<p>Вывод узла status осуществляется в двух форматах:</p>
<ol class="arabic simple">
<li><p>Текстовый вывод добавляется в реальном времени под узлом. Цвет вывода также будет меняться в зависимости от статуса.</p></li>
<li><p>Объект с именем status доступен из отладчика и других узлов, таких как узел change. Свойства объекта статуса перечислены ниже</p></li>
</ol>
</section>
<section id="id161">
<h5>Пример узлов status<a class="headerlink" href="#id161" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Status node scheme" src="../_images/status_scheme.png" /></p>
<p><img alt="Status node" src="../_images/status.png" /></p>
</section>
<section id="id162">
<h5>Документация по узлу<a class="headerlink" href="#id162" title="Ссылка на этот заголовок"></a></h5>
<p>Сообщения о состоянии других узлов можно просматривать на той же вкладке.</p>
</section>
<section id="id163">
<h5>Выходные данные<a class="headerlink" href="#id163" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">status.text</span></code> - текст статуса.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status.source.type</span></code> - тип узла, сообщившего о состоянии.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status.source.id</span></code> - идентификатор узла, сообщившего о статусе.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status.source.name</span></code> - имя узла, сообщившего о состоянии, если оно установлено.</p></li>
</ul>
<section id="id164">
<h6>Подробности<a class="headerlink" href="#id164" title="Ссылка на этот заголовок"></a></h6>
<p>Этот узел не имеет payload.</p>
<p>По умолчанию узел сообщает о состоянии всех узлов на той же вкладке рабочей области. Его можно настроить на выборочное сообщение о состоянии отдельных узлов.</p>
</section>
</section>
</section>
<section id="link">
<h4>link<a class="headerlink" href="#link" title="Ссылка на этот заголовок"></a></h4>
<section id="link-u-logic">
<h5>Для чего используется узел link в U-Logic?<a class="headerlink" href="#link-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узлы link out и link in используются для того, чтобы помочь разработчикам U-Logic организовать свои потоки, чтобы сделать их более понятными. Узлы link можно использовать для соединения двух наборов узлов, но соединение отображается только при выборе одного из узлов. Это позволяет разработчикам группировать узлы, которые выполняют определенную функцию. Узлы link out и link in могут соединять две группы, но визуально это не будет заметно, пока не будет выбран один из узлов.</p>
<p><img alt="Link node example" src="../_images/link_scheme.png" /></p>
</section>
<section id="id165">
<h5>Документация по узлу<a class="headerlink" href="#id165" title="Ссылка на этот заголовок"></a></h5>
<p>Создавайте виртуальные провода между потоками.</p>
</section>
<section id="id166">
<h5>Подробности<a class="headerlink" href="#id166" title="Ссылка на этот заголовок"></a></h5>
<p>Узел link out может быть подключен к любому link in узлу на любой вкладке. После подключения они ведут себя так, как если бы они были соединены вместе обычным проводом.</p>
<p>Узел link in может быть подключен к любому link out узлу на любой вкладке. После подключения они ведут себя так, как если бы они были соединены вместе обычным проводом.</p>
<p>Провода между узлами link out и link in отображаются только при нажатии на них. Если есть какие-либо провода к другим вкладкам, отображается виртуальный узел, на который можно нажать, чтобы перейти на соответствующую вкладку.</p>
<p>Когда узел link out получает сообщение, оно передается подключенному link in узлу.</p>
<p>Если есть два или более link in узлов с одинаковым именем, возникнет ошибка.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Узлы link out и link in не могут вести внутрь подпотока или изнутри подпотока наружу.</p>
</div>
</section>
<section id="id167">
<h5>Входное значение<a class="headerlink" href="#id167" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code> - В узле link call, если для параметра «Link Type» установлено значение «Dynamic target (msg.target)», укажите <code class="docutils literal notranslate"><span class="pre">msg.target</span></code> имя узла, который link in вы хотите вызвать.</p></li>
</ul>
</section>
</section>
<section id="comment">
<h4>comment<a class="headerlink" href="#comment" title="Ссылка на этот заголовок"></a></h4>
<section id="comment-u-logic">
<h5>Для чего используется узел comment в U-Logic?<a class="headerlink" href="#comment-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>При обслуживании потоков в течение более длительных периодов времени добавление узла comment к потокам может сэкономить время и избежать ошибок интерпретации.</p>
<p>Добавление узла comment в потоки U-Logic дает четыре основных преимущества:</p>
<ol class="arabic simple">
<li><p><strong>Улучшенная читаемость</strong>: Комментарии могут помочь сделать потоки более понятными, особенно при добавлении легко упускаемого контекста и объяснения, например, неявных требований потока. Это может быть особенно полезно для сложных потоков с узлами link или при редактировании во многих вкладках.</p></li>
<li><p><strong>Улучшенное обслуживание</strong>: Комментарии могут помочь упростить обслуживание потоков, предоставляя запись о цели и функциональности потоков. Это может быть полезно при внесении изменений в поток или при устранении неполадок, особенно если вы сотрудничаете с несколькими членами команды.</p></li>
<li><p><strong>Улучшенная отладка</strong>: Комментарии могут помочь облегчить отладку, предоставляя информацию об ожидаемом поведении. Это может быть полезно при отслеживании ошибок и определении источника проблем или обосновании ошибок при предыдущей разработке потока.</p></li>
<li><p><strong>Расширенная документация</strong>: Комментарии могут использоваться для документирования кода, предоставляя дополнительную информацию о цели, функциональности и использовании кода.</p></li>
</ol>
<p>Узел comment можно добавить в любое открытое пространство редактора, и рекомендуется добавлять комментарий ко всем группам потоков.</p>
<!-- перевести еще раз -->
<!-- Поскольку узел комментария не займет больше места, если вы напишете более длинный комментарий, U-Logic позволяет вам быть более явным и подробным в своих комментариях. Диаграммы ASCII или что-то в этом роде не отвлекают от вашего потока, и поэтому вам рекомендуется их добавлять. -->
<p><img alt="Comment node" src="../_images/comment.png" /></p>
<p><img alt="Comment node description" src="../_images/comment_description.png" /></p>
</section>
<section id="id168">
<h5>Документация по узлу<a class="headerlink" href="#id168" title="Ссылка на этот заголовок"></a></h5>
<p>Узел, который можно использовать для добавления комментариев к потокам.</p>
<section id="id169">
<h6>Подробности<a class="headerlink" href="#id169" title="Ссылка на этот заголовок"></a></h6>
<p>Панель «Изменить узел comment» принимает синтаксис Markdown. Написанный текст будет отображаться в боковой панели информации.</p>
</section>
</section>
</section>
</section>
<section id="id170">
<h3>функция<a class="headerlink" href="#id170" title="Ссылка на этот заголовок"></a></h3>
<section id="id171">
<h4>function<a class="headerlink" href="#id171" title="Ссылка на этот заголовок"></a></h4>
<section id="function-u-logic">
<h5>Что такое узел function в U-Logic?<a class="headerlink" href="#function-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>В U-Logic узел function позволяет писать пользовательский код на JavaScript для обработки объектов сообщений в потоке. Он используется для выполнения специфических задач, которые нельзя реализовать с помощью стандартных встроенных узлов. Когда вы пишете код на JavaScript в узле function, он выполняется каждый раз при прохождении сообщения через узел.</p>
<p>В U-Logic функция должна либо возвращать объект (объект сообщения), либо ничего не возвращать. Если вернуть данные другого типа вместо объекта, это приведёт к ошибке. По умолчанию узел function передаёт объект сообщения без изменений, передавая данные дальше в поток.</p>
<p>Идеально, если объект сообщения возвращается внутри узла function в конце кода. Если разместить <code class="docutils literal notranslate"><span class="pre">return</span></code> в середине кода, это может привести к неполному выполнению оставшейся части кода.</p>
<p>Если узел function должен выполнить асинхронное действие перед отправкой сообщения, он не может использовать <code class="docutils literal notranslate"><span class="pre">return</span></code> для возврата сообщения в конце функции. Вместо этого в таких случаях необходимо использовать <code class="docutils literal notranslate"><span class="pre">node.send()</span></code>, как показано ниже:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Симуляция асинхронной операции с использованием setTimeout</span>
<span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Через 2 секунды создаётся объект сообщения с некоторыми данными</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Async operation complete&quot;</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="c1">// Отправка сообщения в последующие узлы</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="mf">2000</span><span class="p">);</span>
</pre></div>
</div>
<p>Кроме того, если вам нужно передать объект сообщения внутри узла function в середине скрипта в последующие узлы, вы можете использовать <code class="docutils literal notranslate"><span class="pre">node.send()</span></code> для этой цели, продолжая выполнение оставшейся части кода, как показано ниже:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// Извлечение данных из входящего сообщения</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">inputData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">msg</span><span class="p">.</span><span class="nx">payload</span><span class="p">;</span>

<span class="c1">// Выполнение некоторой обработки</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">processedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">inputData</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>

<span class="c1">// Отправка объекта сообщения с обработанными данными</span>
<span class="nx">node</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="w"> </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="sb">`Processed data: </span><span class="si">${</span><span class="nx">processedData</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="p">});</span>

<span class="c1">// Продолжение выполнения оставшегося кода...</span>

<span class="c1">// Пример дальнейшей обработки...</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">processedData</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Обнаружено высокое значение обработанных данных!&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Значение обработанных данных в пределах нормы.&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Возвращение изменённого объекта сообщения</span>
<span class="k">return</span><span class="w"> </span><span class="nx">msg</span><span class="p">;</span>
</pre></div>
</div>
<p>Если вы не хотите, чтобы функция передавала что-либо в следующий узел, вы можете в узле function вернуть <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<p>По умолчанию узел function имеет один выход, но его можно настроить на несколько выходов во «Setup», изменив свойство «Выходы». Затем можно отправлять сообщения в каждый из выходов, используя массив, располагая их в порядке, соответствующем нужным выходам.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Создание</span> <span class="n">нескольких</span> <span class="n">сообщений</span> <span class="n">с</span> <span class="n">разными</span> <span class="n">типами</span> <span class="n">данных</span>
<span class="n">var</span> <span class="n">msg1</span> <span class="o">=</span> <span class="p">{</span> <span class="n">payload</span><span class="p">:</span> <span class="mi">1</span> <span class="p">};</span>
<span class="n">var</span> <span class="n">msg2</span> <span class="o">=</span> <span class="p">{</span> <span class="n">payload</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">};</span>
<span class="n">var</span> <span class="n">msg3</span> <span class="o">=</span> <span class="p">{</span> <span class="n">payload</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;bob&quot;</span><span class="p">}</span> <span class="p">};</span>
<span class="n">var</span> <span class="n">msg4</span> <span class="o">=</span> <span class="p">{</span> <span class="n">payload</span><span class="p">:</span> <span class="s2">&quot;Это строка&quot;</span> <span class="p">};</span>

<span class="o">//</span> <span class="n">Возвращение</span> <span class="n">массива</span> <span class="n">сообщений</span>
<span class="k">return</span> <span class="p">[</span><span class="n">msg1</span><span class="p">,</span> <span class="n">msg2</span><span class="p">,</span> <span class="n">msg3</span><span class="p">,</span> <span class="n">msg4</span><span class="p">];</span>
</pre></div>
</div>
</section>
<section id="id172">
<h5>Различные вкладки в узле Function<a class="headerlink" href="#id172" title="Ссылка на этот заголовок"></a></h5>
<p>В узле function есть четыре разных типа вкладок, каждая из которых имеет своё предназначение:</p>
<section id="setup">
<h6>Setup<a class="headerlink" href="#setup" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><strong>Выходы</strong>: Позволяет настроить количество выходов, которые будет иметь узел function.</p></li>
<li><p><strong>Время ожидания</strong>: Позволяет определить, сколько времени узел function может выполняться до возникновения ошибки. По умолчанию, если установлено 0, тайм-аут не применяется.</p></li>
</ul>
<!-- доп модули? вопрос -->
<ul class="simple">
<li><p>modules: Позволяет добавлять или импортировать дополнительные модули в узел function. Эти модули будут автоматически устанавливаться при развёртывании потока. Однако в настройках (<code class="docutils literal notranslate"><span class="pre">-settings</span></code>) необходимо включить параметр <code class="docutils literal notranslate"><span class="pre">'functionExternalModules'</span></code>, установив его в <code class="docutils literal notranslate"><span class="pre">'true'</span></code>.</p></li>
</ul>
</section>
<section id="id173">
<h6>Настройка<a class="headerlink" href="#id173" title="Ссылка на этот заголовок"></a></h6>
<p>В этой вкладке можно написать код, который будет выполняться при старте узла. Это полезно для инициализации состояния, необходимого для работы узла function.</p>
</section>
<section id="id174">
<h6>Функция<a class="headerlink" href="#id174" title="Ссылка на этот заголовок"></a></h6>
<p>Это основная вкладка, в которой пишется JavaScript-код, выполняющийся при получении сообщения от других узлов.</p>
</section>
<section id="id175">
<h6>Закрытие<a class="headerlink" href="#id175" title="Ссылка на этот заголовок"></a></h6>
<p>Эта вкладка позволяет добавить код для очистки ресурсов перед остановкой узла, например, закрытия соединений или завершения фоновых задач перед повторным развёртыванием потока.</p>
</section>
</section>
<section id="id176">
<h5>Логирование событий<a class="headerlink" href="#id176" title="Ссылка на этот заголовок"></a></h5>
<p>Когда узлу function в U-Logic нужно записать что-либо в лог, он может использовать следующие методы:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node.log()</span></code>: используется для общего логирования.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.warn()</span></code>: используется для записи предупреждений.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.error()</span></code>: используется для записи ошибок.</p></li>
</ul>
<p>Сообщения, записанные через <code class="docutils literal notranslate"><span class="pre">node.warn()</span></code> и <code class="docutils literal notranslate"><span class="pre">node.error()</span></code>, будут отображаться во вкладке «отладка».</p>
<p>Также можно использовать узел catch для обработки ошибок. Чтобы передать <code class="docutils literal notranslate"><span class="pre">msg</span></code> в узел catch, укажите его вторым аргументом в <code class="docutils literal notranslate"><span class="pre">node.error</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="u-logic-function">
<h5>Объекты U-Logic, доступные в узле function<a class="headerlink" href="#u-logic-function" title="Ссылка на этот заголовок"></a></h5>
<p>В узле function в U-Logic можно обращаться к следующим объектам:</p>
<ul class="simple">
<li><p>node: объект, содержащий свойства и методы для настройки и взаимодействия с узлом в потоке.</p></li>
<li><p>context: локальный контекст узла.</p></li>
<li><p>flow: контекст уровня потока.</p></li>
<li><p>global: контекст уровня глобального окружения.</p></li>
<li><p>RED: объект, предоставляющий доступ к API среды выполнения U-Logic.</p></li>
</ul>
</section>
<section id="id177">
<h5>Применение и примеры<a class="headerlink" href="#id177" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p><strong>Пользовательская логика</strong>: Иногда в вашем потоке может понадобиться специфическая логика, которую невозможно реализовать с помощью стандартных узлов. В таких случаях используется узел function.</p></li>
</ol>
<p>В примере ниже функция конвертирует температуру (сгенерированную узлом inject в виде случайного числа) из Цельсия в Фаренгейт, а также выполняет дополнительное форматирование.</p>
<p><img alt="Пример использования узла function" src="../_images/function_scheme.png" /></p>
<ol class="arabic simple" start="2">
<li><p><strong>Условная маршрутизация</strong>: Когда приходится обрабатывать широкий спектр условий с сложной логикой для каждого случая, switch-узел может оказаться недостаточно гибким. В таких ситуациях полезно использовать function-узел с несколькими выходами.</p></li>
</ol>
<p>В примере ниже inject-узел генерирует случайное число и отправляет его в function-узел. Внутри function-узла выполняется оценка полученного числа, после чего оно направляется на разные выходы в зависимости от заданных диапазонов значений.</p>
<p><img alt="Пример использования узла function" src="../_images/function_advanced_scheme.png" /></p>
</section>
<section id="id178">
<h5>Документация по узлу<a class="headerlink" href="#id178" title="Ссылка на этот заголовок"></a></h5>
<p>Функция JavaScript, запускаемая для сообщений, получаемых узлом.</p>
<p>Сообщения передаются в виде JavaScript-объекта <code class="docutils literal notranslate"><span class="pre">msg</span></code>.</p>
<p>По соглашению, объект <code class="docutils literal notranslate"><span class="pre">msg</span></code> содержит свойство <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>, содержащее тело сообщения.</p>
<p>Функция должна возвращать объект сообщения (или несколько объектов сообщений), но также может ничего не возвращать, чтобы остановить поток.</p>
<p>Вкладка «Настройка» содержит код, который выполняется при запуске узла. Вкладка «Закрытие» содержит код, который выполняется при остановке узла.</p>
<p>Если код в «Настройке» возвращает объект Promise, узел не начнёт обработку сообщений до тех пор, пока этот Promise не будет выполнен.</p>
<section id="id179">
<h6>Отправка сообщений<a class="headerlink" href="#id179" title="Ссылка на этот заголовок"></a></h6>
<p>Функция может либо вернуть сообщения, которые она хочет передать следующим узлам в потоке, либо вызвать <code class="docutils literal notranslate"><span class="pre">node.send(messages)</span></code>.</p>
<p>Она может вернуть/отправить:</p>
<ul class="simple">
<li><p>Одиночный объект сообщения – передаётся узлам, подключённым к первому выходу.</p></li>
<li><p>Массив объектов сообщений – передаётся узлам, подключённым к соответствующим выходам.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Код настройки выполняется во время инициализации узла. Поэтому, если в вкладке Setup вызывается <code class="docutils literal notranslate"><span class="pre">node.send</span></code>, последующие узлы могут не получить сообщение.</p>
</div>
<p>Если какой-либо элемент массива сам является массивом сообщений, тогда несколько сообщений отправляются на соответствующий выход.</p>
<p>Если возвращается null (либо как одиночное значение, либо как элемент массива), сообщение не передаётся дальше.</p>
</section>
<section id="id180">
<h6>Доступ к информации о узле<a class="headerlink" href="#id180" title="Ссылка на этот заголовок"></a></h6>
<p>Следующие свойства позволяют получить информацию о текущем узле:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node.id</span></code> - идентификатор узла</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.name</span></code> - имя узла</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.outputCount</span></code> - количество выходов узла</p></li>
</ul>
</section>
</section>
</section>
<section id="id181">
<h4>switch<a class="headerlink" href="#id181" title="Ссылка на этот заголовок"></a></h4>
<section id="switch-u-logic">
<h5>Для чего используется узел switch в U-Logic?<a class="headerlink" href="#switch-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел switch позволяет вам маршрутизировать сообщения на основе определенных условий. Он действует как инструмент принятия решений в вашем потоке, позволяя вам определять правила для направления сообщений в различные выходные ветви.</p>
<p>Вот несколько распространенных вариантов использования узла switch в U-Logic:</p>
<p><strong>Фильтрация сообщений</strong>: Вы можете использовать узел switch для фильтрации сообщений на основе определенных критериев. Например, вы можете захотеть отфильтровать сообщения, которые не соответствуют определенному порогу или не содержат определенных ключевых слов.</p>
<p><strong>Условная маршрутизация</strong>: Узел switch позволяет вам направлять сообщения по разным путям в вашем потоке на основе условий. Вы можете настроить правила, которые определяют, в какую выходную ветвь должно быть отправлено сообщение, в зависимости от его содержимого или свойств.</p>
<p><strong>Обработка событий</strong>: Если вы работаете с событиями или потоками данных, узел switch может помочь вам обрабатывать различные типы событий по-разному. Например, у вас могут быть события, связанные с показаниями температуры и влажности, и вы хотите обрабатывать их отдельно.</p>
<p><strong>Преобразование значений</strong>: В случаях, когда необходимо преобразовать значения из одного формата в другой, узел switch может направлять сообщения разным преобразователям на основе свойств входящего значения.</p>
<p><strong>Обработка ошибок</strong>: При работе с данными или API вы можете получать сообщения об ошибках, которые необходимо обрабатывать иначе, чем обычные данные. Узел switch может направлять сообщения об ошибках в отдельную ветвь для соответствующей обработки.</p>
<p><strong>Обработка на основе языка или региона</strong>: в приложениях, включающих локализацию или многоязыковую поддержку, узел коммутации может маршрутизировать сообщения на основе информации о языке или регионе в сообщении.</p>
</section>
<section id="id182">
<h5>Примеры<a class="headerlink" href="#id182" title="Ссылка на этот заголовок"></a></h5>
<p><img alt="Настройки узла switch" src="../_images/switch.png" /></p>
<p><img alt="Пример использования узла switch" src="../_images/switch_scheme.png" /></p>
</section>
<section id="id183">
<h5>Документация по узлу<a class="headerlink" href="#id183" title="Ссылка на этот заголовок"></a></h5>
<p>Маршрутизируйте сообщения на основе значений их свойств или положения в последовательности.</p>
</section>
<section id="id184">
<h5>Подробности<a class="headerlink" href="#id184" title="Ссылка на этот заголовок"></a></h5>
<p>При поступлении сообщения узел оценивает каждое из определенных правил и пересылает сообщение на соответствующие выходы любых соответствующих правил.</p>
<p>При желании узел можно настроить так, чтобы он прекращал оценку правил, как только найдет подходящее.</p>
<p>Правила можно оценивать по отдельному свойству сообщения, свойству потока, глобального контекста или результату выражения JSONata.</p>
<section id="id185">
<h6>Правила<a class="headerlink" href="#id185" title="Ссылка на этот заголовок"></a></h6>
<p>Существует четыре типа правил:</p>
<ol class="arabic simple">
<li><p>Правила значений (value rules) оцениваются по настроенному свойству.</p></li>
<li><p>Правила последовательности (sequence rules) могут использоваться в последовательностях сообщений, например, генерируемых узлом split.</p></li>
<li><p>Можно указать выражение JSONata, которое будет оцениваться по всему сообщению и будет соответствовать ему, если выражение возвращает истинное значение.</p></li>
<li><p>Правило «иначе» можно использовать для сопоставления, если ни одно из предыдущих правил не совпало.</p></li>
</ol>
</section>
<section id="id186">
<h6>Примечания<a class="headerlink" href="#id186" title="Ссылка на этот заголовок"></a></h6>
<p>Правила «равно true», «равно false», «равно null» выполняют строгие сравнения с этими типами. Они не преобразуют типы между собой.</p>
<p>Правила «пустое» и «не пустое» можно использовать для проверки длины строк, массивов и буферов или количества свойств объекта. Ни одно из правил не будет выполнено, если проверяемое свойство имеет значение <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">null</span></code> или <code class="docutils literal notranslate"><span class="pre">undefined</span></code>.</p>
</section>
<section id="id187">
<h6>Обработка последовательностей сообщений<a class="headerlink" href="#id187" title="Ссылка на этот заголовок"></a></h6>
<p>По умолчанию узел не изменяет свойства сообщений <code class="docutils literal notranslate"><span class="pre">msg.parts</span></code>, являющихся частью последовательности.</p>
<p>Параметр «воссоздать последовательность сообщений» может быть включен для генерации новых последовательностей сообщений для каждого совпадающего правила. В этом режиме узел будет буферизировать всю входящую последовательность перед отправкой новых последовательностей.</p>
</section>
</section>
</section>
<section id="id188">
<h4>change<a class="headerlink" href="#id188" title="Ссылка на этот заголовок"></a></h4>
<section id="change-u-logic">
<h5>Для чего используется узел change в U-Logic?<a class="headerlink" href="#change-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел change в U-Logic используется для изменения содержимого сообщений в потоке. Он позволяет добавлять, удалять, изменять или задавать свойства сообщений и значения payload, что делает его фундаментальным узлом для преобразования и манипулирования данными. Узел change необходим для подготовки данных к дальнейшей обработке, форматирования сообщений для определенных выходов и адаптации данных в соответствии с требованиями дальнейших узлов в потоке.</p>
</section>
<section id="id189">
<h5>Примеры<a class="headerlink" href="#id189" title="Ссылка на этот заголовок"></a></h5>
<p>Варианты использования узла change включают в себя:</p>
<ol class="arabic simple">
<li><p><strong>Преобразование данных</strong>: Узел change можно использовать для преобразования данных из одного формата в другой. Например, можно преобразовать значения температуры из градусов Цельсия в градусы Фаренгейта, перевести текстовую информацию или преобразовать временные метки в другой формат.</p></li>
</ol>
<p><img alt="Настройки узла change" src="../_images/change_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_scheme.png" /></p>
<ol class="arabic simple" start="2">
<li><p><strong>Фильтрация сообщений</strong>: Узел change может фильтровать сообщения на основе определенных условий. Вы можете использовать узел change для маршрутизации сообщений на различные выходы, отбрасывания нерелевантных сообщений или выполнения определенных действий на основе свойств сообщения.</p></li>
</ol>
<p><img alt="Настройка узла change" src="../_images/change_filter_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_filter_scheme.png" /></p>
<ol class="arabic simple" start="3">
<li><p><strong>Дополнение сообщений</strong>: Узел change позволяет добавлять или изменять свойства в сообщении для расширения его содержимого. Например, можно добавлять временные метки, добавлять контекстную информацию или устанавливать специфические идентификаторы для целей отслеживания.</p></li>
</ol>
<p><img alt="Настройка узла change" src="../_images/change_add_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_add_scheme.png" /></p>
<ol class="arabic simple" start="4">
<li><p><strong>Переименование свойств</strong>: узел change позволяет переименовывать свойства сообщения, что упрощает понимание и работу с данными на различных этапах потока.</p></li>
</ol>
<p><img alt="Настройка узла change" src="../_images/change_rename_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_rename_scheme.png" /></p>
<ol class="arabic simple" start="5">
<li><p><strong>Значения по умолчанию</strong>: если в сообщении отсутствуют определенные свойства, узел change может установить значения по умолчанию для этих свойств, обеспечивая согласованность потока данных.</p></li>
</ol>
<p><img alt="Настройка узла change" src="../_images/change_default_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_defualt_scheme.png" /></p>
<ol class="arabic simple" start="6">
<li><p><strong>Форматирование сообщения</strong>: при отправке данных во внешние системы или службы узел change может форматировать payload сообщения в требуемом формате (например, JSON, XML) или корректировать данные в соответствии с конкретными требованиями API.</p></li>
</ol>
<p><img alt="Настройка узла change" src="../_images/change_format_edit.png" /></p>
<p><img alt="Пример использования узла change" src="../_images/change_format_scheme.png" /></p>
<p>В целом, узел change является важнейшим инструментом для манипулирования данными в потоках U-Logic. Его гибкость и диапазон операций делают его важным узлом для настройки сообщений в соответствии с вашими конкретными вариантами использования и требованиями узлов в вашем потоке.</p>
</section>
<section id="id190">
<h5>Документация по узлу<a class="headerlink" href="#id190" title="Ссылка на этот заголовок"></a></h5>
<p>Устанавливать, изменять, удалять или перемещать свойства сообщения, контекста потока или глобального контекста.</p>
<p>Узел может указать несколько правил, которые будут применяться в том порядке, в котором они определены.</p>
</section>
<section id="id191">
<h5>Подробности<a class="headerlink" href="#id191" title="Ссылка на этот заголовок"></a></h5>
<p>Доступные операции:</p>
<ul class="simple">
<li><p>Установить: Задать свойство. Значение может быть различных типов или может быть взято из существующего сообщения или свойства контекста.</p></li>
<li><p>Изменить: Поиск и замена частей свойства.</p></li>
<li><p>Удалить: Удалить свойство.</p></li>
<li><p>Переместить: Переместить или переименовать свойство объекта</p></li>
</ul>
<p>Тип «выражение» использует язык запросов и выражений <a class="reference external" href="https://jsonata.org/">JSONata</a>.</p>
</section>
</section>
<section id="range">
<h4>range<a class="headerlink" href="#range" title="Ссылка на этот заголовок"></a></h4>
<section id="range-u-logic">
<h5>Для чего используется узел range в U-Logic?<a class="headerlink" href="#range-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел range в U-Logic позволяет вам сопоставлять числовое значение из одного диапазона в другой. Например, если вы хотите сопоставить мили с километрами, вы можете указать входной диапазон от 1 до 100 и целевой диапазон от 1 до 160.</p>
<p>Помимо преобразования единиц измерения, узел диапазона можно использовать для:</p>
<p><strong>Масштабирование данных</strong>: Используйте узел range для масштабирования или нормализации данных. Например, если у вас есть показания датчика в диапазоне от 0 до 1023, но вы хотите преобразовать их в процентную шкалу 0-100, вы можете использовать узел range для этого преобразования.</p>
<p><strong>Сжатие данных</strong>: Сокращение диапазона значений данных с сохранением взаимосвязей между значениями. Это может быть полезно для отображения данных в меньшем масштабе без потери важных изменений.</p>
<p><strong>Аналого-цифровое преобразование</strong>: При взаимодействии с аналоговыми датчиками можно преобразовать аналоговый диапазон напряжения в диапазон цифровых значений для обработки.</p>
<p><strong>Сглаживание данных</strong>: Сглаживание колебаний данных путем приведения значений в пределах диапазона к одному значению.</p>
</section>
<section id="id192">
<h5>Примеры для узла range<a class="headerlink" href="#id192" title="Ссылка на этот заголовок"></a></h5>
<p>Пример узла изменения, который преобразует мили в километры.</p>
<p><img alt="Пример настройки узла range" src="../_images/range_edit.png" /></p>
<p><img alt="Пример использования узла range" src="../_images/range_scheme.png" /></p>
</section>
<section id="id193">
<h5>Документация по узлу<a class="headerlink" href="#id193" title="Ссылка на этот заголовок"></a></h5>
<p>Сопоставляет числовое значение с другим диапазоном.</p>
<section id="id194">
<h6>Входные данные<a class="headerlink" href="#id194" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">payload</span></code>: payload должен быть числом. Все остальное будет пытаться быть преобразовано в число и отклонено, если это не удастся.</p></li>
</ul>
</section>
<section id="id195">
<h6>Выходные данные<a class="headerlink" href="#id195" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">payload</span></code>: Значение сопоставлено с новым диапазоном.</p></li>
</ul>
</section>
<section id="id196">
<h6>Подробности<a class="headerlink" href="#id196" title="Ссылка на этот заголовок"></a></h6>
<p>Этот узел будет линейно масштабировать полученное значение. По умолчанию «Действие» выбрано «Масштабировать msg-свойство», т.е. результат не ограничен диапазоном, определенным в узле.</p>
<p>Действие «Масштабировать и ограничить целевым диапазоном» означает, что результат никогда не выйдет за пределы указанного в целевом диапазоне диапазона.</p>
<p>Действие «Масштабировать и обернуть в целевой диапазон» означает, что результат будет перемещен в пределы целевого диапазона.</p>
<p>Действие «Scale, but drop msg if outside input range» означает, что результат будет масштабирован, но любые входные данные за пределами входного и выходного диапазона будут отброшены.</p>
<p>Например, входные данные 0–10 будут отображаться в диапазоне 0–100 в зависимости от «Действия» следующим образом:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Действие</p></th>
<th class="head"><p>Вход</p></th>
<th class="head"><p>Выход</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Масштабировать msg-свойство</p></td>
<td><p>12</p></td>
<td><p>120</p></td>
</tr>
<tr class="row-odd"><td><p>Масштабировать и ограничить целевым диапазоном</p></td>
<td><p>121</p></td>
<td><p>00</p></td>
</tr>
<tr class="row-even"><td><p>Масштабировать и обернуть в целевой диапазон</p></td>
<td><p>12</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>Scale, but drop msg if outside input range</p></td>
<td><p>12</p></td>
<td><p>Нет выходных данных</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="template">
<h4>template<a class="headerlink" href="#template" title="Ссылка на этот заголовок"></a></h4>
<p>Узел template используется для создания и управления текстовыми шаблонами. Например, для генерации HTML, файлов конфигурации и т.д.; Узел template позволяет генерировать динамический контент путем внедрения данных в предопределенные шаблоны с использованием языка шаблонов Mustache. Когда нет необходимости в динамических шаблонах, поле «Формат» можно установить как «Простой текст», что дает небольшое преимущество в производительности.</p>
<section id="id197">
<h5>Как работает узел template<a class="headerlink" href="#id197" title="Ссылка на этот заголовок"></a></h5>
<section id="id198">
<h6>Входные данные<a class="headerlink" href="#id198" title="Ссылка на этот заголовок"></a></h6>
<p>Вы можете подключить узел template к источнику данных, например, к входу HTTP или любому другому узлу, который предоставляет данные. Эти входные данные будут использоваться для заполнения шаблона.</p>
</section>
<section id="id199">
<h6>Определение шаблона<a class="headerlink" href="#id199" title="Ссылка на этот заголовок"></a></h6>
<p>В конфигурации узла template вы определяете шаблон, используя текстовые языки форматирования, такие как HTML с синтаксисом mustache. mustache — это простой язык шаблонизации, который позволяет вам вставлять переменные и выражения в ваш шаблон.</p>
<p>Например, вы можете определить шаблон следующим образом: <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;Hello</span> <span class="pre">{{payload.name}}!&lt;/p&gt;</span></code>.</p>
<p><img alt="Пример использования узла template" src="../_images/template_scheme.png" /></p>
<p>В этом примере будет выведено <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;Hello</span> <span class="pre">user!&lt;/p&gt;</span></code>.</p>
</section>
<section id="id200">
<h6>Выходные данные<a class="headerlink" href="#id200" title="Ссылка на этот заголовок"></a></h6>
<p>Когда узел template получает входные данные, он обрабатывает их и заменяет соответствующими значениями из входных данных. Полученный HTML или текст затем отправляется в качестве вывода на следующий узел в потоке.</p>
</section>
</section>
<section id="id201">
<h5>Создание JSON<a class="headerlink" href="#id201" title="Ссылка на этот заголовок"></a></h5>
<p>Узел template можно настроить на анализ результата ввода и шаблона как JSON, чтобы в дальнейшем использовать сообщение как объект, а не как строку.</p>
<section id="id202">
<h6>Входные данные<a class="headerlink" href="#id202" title="Ссылка на этот заголовок"></a></h6>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;ACME&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id203">
<h6>Конфигурация узла template<a class="headerlink" href="#id203" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p>Шаблон:</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;product&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;{{payload.0}}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;version&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{{</span><span class="nx">payload</span><span class="mf">.1</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Формат: <code class="docutils literal notranslate"><span class="pre">Mustache</span> <span class="pre">шаблон</span></code></p></li>
<li><p>Вывести как: <code class="docutils literal notranslate"><span class="pre">JSON</span></code></p></li>
</ul>
</section>
<section id="id204">
<h6>Выходные значения<a class="headerlink" href="#id204" title="Ссылка на этот заголовок"></a></h6>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;product&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ACME&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;version&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="javascript-yaml">
<h5>Генерация объекта JavaScript из YAML<a class="headerlink" href="#javascript-yaml" title="Ссылка на этот заголовок"></a></h5>
<p>U-Logic также может анализировать YAML</p>
<section id="id205">
<h6>Входные данные<a class="headerlink" href="#id205" title="Ссылка на этот заголовок"></a></h6>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nx">topic</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;U-Logic&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="mf">3000</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id206">
<h6>Конфигурация узла template<a class="headerlink" href="#id206" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p>Шаблон:</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">options</span><span class="o">:</span>
<span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="p">{{</span><span class="nx">topic</span><span class="p">}}</span>
<span class="w">    </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="p">{{</span><span class="nx">payload</span><span class="p">}}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Формат: <code class="docutils literal notranslate"><span class="pre">Mustache</span> <span class="pre">шаблон</span></code></p></li>
<li><p>Вывести как: <code class="docutils literal notranslate"><span class="pre">JSON</span></code></p></li>
</ul>
</section>
<section id="id207">
<h6>Выходные значения<a class="headerlink" href="#id207" title="Ссылка на этот заголовок"></a></h6>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;title&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;U-Logic&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;port&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">3000</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id208">
<h5>Комментарии<a class="headerlink" href="#id208" title="Ссылка на этот заголовок"></a></h5>
<p>Когда шаблон становится больше, может быть полезно добавлять комментарии к шаблону, которые не будут отображаться в выводе. Комментарии работают примерно так же, как и обычный синтаксис, с <code class="docutils literal notranslate"><span class="pre">!</span></code> после открывающихся фигурных скобок:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span><span class="o">!</span><span class="w"> </span><span class="nx">это</span><span class="w"> </span><span class="nx">не</span><span class="w"> </span><span class="nx">отобразится</span><span class="w"> </span><span class="p">}}</span>
<span class="nx">This</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">output</span>
</pre></div>
</div>
<p>Результатом будет <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">text</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">output</span></code>. Обратите внимание, что символ пустой строки (<code class="docutils literal notranslate"><span class="pre">\n</span></code>) отсутствует.</p>
</section>
<section id="id209">
<h5>Документация по узлу<a class="headerlink" href="#id209" title="Ссылка на этот заголовок"></a></h5>
<p>Устанавливает свойство на основе предоставленного шаблона.</p>
<section id="id210">
<h6>Входные данные<a class="headerlink" href="#id210" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">msg</span></code>: Объект msg, содержащий информацию для заполнения шаблона.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code>: Шаблонная строка, которая будет заполнена из msg.payload. Если она не настроена в панели редактирования, её можно установить как свойство msg.</p></li>
</ul>
</section>
<section id="id211">
<h6>Выходные данные<a class="headerlink" href="#id211" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">msg</span></code>: msg со свойством, заданным путем заполнения настроенного шаблона свойствами из входящего сообщения.</p></li>
</ul>
</section>
<section id="id212">
<h6>Подробности<a class="headerlink" href="#id212" title="Ссылка на этот заголовок"></a></h6>
<p>По умолчанию используется формат «Mustache шаблон».</p>
<p>Например, когда шаблон:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Hello</span><span class="w"> </span><span class="p">{{</span><span class="nx">payload</span><span class="p">.</span><span class="nx">name</span><span class="p">}}.</span><span class="w"> </span><span class="nx">Today</span><span class="w"> </span><span class="p">{{</span><span class="nx">date</span><span class="p">}}</span>
</pre></div>
</div>
<p>получает сообщение, содержащее:</p>
<div class="highlight-javaascript notranslate"><div class="highlight"><pre><span></span>{
  date: &quot;monday&quot;,
  payload: {
    name: &quot;Ivan&quot;
  }
}
</pre></div>
</div>
<p>Результирующее свойство будет следующим:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Hello</span><span class="p">,</span><span class="w"> </span><span class="nx">Ivan</span><span class="p">.</span><span class="w"> </span><span class="nx">Today</span><span class="w"> </span><span class="nx">monday</span>
</pre></div>
</div>
<p>Можно использовать свойство из контекста потока или глобального контекста. Просто используйте <code class="docutils literal notranslate"><span class="pre">{{flow.name}}</span></code> или <code class="docutils literal notranslate"><span class="pre">{{global.name}}</span></code></p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>По умолчанию mustache будет экранировать любые небуквенно-цифровые или HTML-сущности в значениях, которые он заменяет. Чтобы предотвратить это, используйте <code class="docutils literal notranslate"><span class="pre">{{{triple}}}</span></code>.</p>
</div>
<p>Если вам нужно использовать <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code> в вашем контенте, вы можете изменить символы, используемые для обозначения шаблонных разделов. Например, чтобы использовать <code class="docutils literal notranslate"><span class="pre">[[</span> <span class="pre">]]</span></code> вместо этого, добавьте следующую строку в верхнюю часть шаблона:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span><span class="o">=</span><span class="p">[[</span><span class="w"> </span><span class="p">]]</span><span class="o">=</span><span class="p">}}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="delay">
<h4>delay<a class="headerlink" href="#delay" title="Ссылка на этот заголовок"></a></h4>
<section id="delay-u-logic">
<h5>Для чего используется узел delay в U-Logic?<a class="headerlink" href="#delay-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел delay позволяет вам ввести задержку в поток сообщений между узлами. Он может быть полезен в различных сценариях, где вам нужно контролировать время обработки сообщений. Например, узел delay может ограничивать скорость, с которой сообщения обрабатываются дальше или задерживать их отправку. Это может быть полезно для взаимодействия с внешними системами, которые могут иметь ограничения.</p>
<p>Вот еще несколько вариантов использования узла delay:</p>
<p><strong>Пакетная обработка</strong>: если вы имеете дело с потоком входящих данных, которые вы хотите обрабатывать пакетами, вы можете использовать узел delay, чтобы ввести задержку между группами сообщений. Это может быть полезно, когда вам нужно агрегировать или анализировать данные по частям.</p>
<p><strong>Последовательная обработка</strong>: Иногда вам нужно гарантировать, что сообщения обрабатываются в определенном порядке. Узел delay может использоваться для обеспечения последовательности обработки сообщений, особенно при работе с асинхронными системами, которые могут не гарантировать порядок.</p>
<p><strong>Моделирование и тестирование</strong>: В сценариях тестирования и моделирования вы можете захотеть имитировать реальные условия синхронизации. Узел delay может помочь вам ввести задержки, которые имитируют реальные условия, позволяя вам проверить, как ваша система ведет себя с течением времени.</p>
<p><strong>Триггеры на основе времени</strong>: вы можете использовать узел delay для запуска действий в определенные временные интервалы. Например, вы можете отправлять обновление статуса каждый час или выполнять задачу очистки в конце дня.</p>
<p><strong>Автоматический выключатель</strong>: узел delay может использоваться как простая форма автоматического выключателя. Если расположенная дальше система выходит из строя или испытывает проблемы, вы можете ввести задержку перед повторной попыткой, давая системе некоторое время для восстановления.</p>
</section>
<section id="id213">
<h5>Примеры для узла delay<a class="headerlink" href="#id213" title="Ссылка на этот заголовок"></a></h5>
<p>Пример использования узла Delay для ограничения скорости http-запросов к внешнему API.</p>
<p><img alt="Пример настройки узла delay" src="../_images/delay_edit.png" /></p>
<p><img alt="Пример использования узла delay" src="../_images/delay_scheme.png" /></p>
<section id="id214">
<h6>Сброс очереди для узла задержки<a class="headerlink" href="#id214" title="Ссылка на этот заголовок"></a></h6>
<p>Узел delay может создать очередь, которая продолжит свой путь к подключенным выходным узлам. Однако есть ситуации, когда очередь необходимо очистить. Это делается путем сброса очереди. Когда свойство <code class="docutils literal notranslate"><span class="pre">msg.reset</span></code> установлено, очередь будет пустой.</p>
<p>Это полезно, когда отсутствие события может потребовать отправки уведомления. Запланируйте отправку уведомления, но разрешите положительному событию отменить уведомление. Ниже представлен такой пример: Вы хотите выключить свет, если в течение определенного периода времени не было обнаружено никакого движения, вы устанавливаете узел задержки на это время. Если обнаруживается движение, то узлу delay отправляется msg.reset, чтобы отменить включение света. Это зависит от узла inject, настроенного на отправку сообщения с интервалом для выключения света.</p>
<p><img alt="Пример использования узла delay" src="../_images/delay_example.png" /></p>
</section>
</section>
<section id="id215">
<h5>Документация по узлу<a class="headerlink" href="#id215" title="Ссылка на этот заголовок"></a></h5>
<p>Задерживает каждое сообщение, проходящее через узел, или ограничивает скорость, с которой они могут передаваться.</p>
<section id="id216">
<h6>Входные значения<a class="headerlink" href="#id216" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delay</span></code>: Устанавливает задержку в миллисекундах, применяемую к сообщению. Эта опция применяется только в том случае, если узел настроен на разрешение сообщению переопределять настроенный интервал задержки по умолчанию.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span></code>: Устанавливает значение скорости в миллисекундах между сообщениями. Этот узел перезаписывает существующее значение скорости, определенное в конфигурации узла, когда он получает сообщение, содержащее <code class="docutils literal notranslate"><span class="pre">msg.rate</span></code> значение в миллисекундах. Этот параметр применяется только в том случае, если узел настроен на разрешение сообщению переопределять настроенный интервал скорости по умолчанию.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code>: Если полученное сообщение имеет какое-либо значение этого свойства, все необработанные сообщения, удерживаемые узлом, очищаются без отправки.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flush</span></code>: Если полученное сообщение имеет это свойство, установленное на числовое значение, то это количество сообщений будет немедленно отправлено. Если установлен любой другой тип (например, логический), то все ожидающие сообщения, удерживаемые узлом, будут отправлены немедленно.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">toFront</span></code>: В режиме ограничения скорости, если полученное сообщение имеет это свойство, установленное на boolean <code class="docutils literal notranslate"><span class="pre">true</span></code>, то сообщение помещается в начало очереди и будет выпущено следующим. Это можно использовать в сочетании с <code class="docutils literal notranslate"><span class="pre">msg.flush=1</span></code> для немедленной повторной отправки.</p></li>
</ul>
</section>
<section id="id217">
<h6>Подробности<a class="headerlink" href="#id217" title="Ссылка на этот заголовок"></a></h6>
<p>При настройке задержки сообщений интервал задержки может быть фиксированным значением, случайным значением в диапазоне или динамически устанавливаться для каждого сообщения. Каждое сообщение задерживается независимо от любого другого сообщения, в зависимости от времени его прибытия.</p>
<p>При настройке на ограничение скорости сообщений их доставка распределяется по настроенному периоду времени. Статус показывает количество сообщений в очереди в данный момент. Он может опционально отбрасывать промежуточные сообщения по мере их поступления.</p>
<p>Если разрешено переопределение ставки, новая ставка будет применена немедленно и останется в силе до тех пор, пока не будет изменена снова, не будет выполнен сброс узла или не будет перезапущен поток.</p>
<p>Ограничение скорости может быть применено ко всем сообщениям или сгруппировано по их msg.topicзначению. При группировке промежуточные сообщения автоматически отбрасываются. В каждом временном интервале узел может либо выпустить самое последнее сообщение для всех тем, либо выпустить самое последнее сообщение для следующей темы.</p>
</section>
</section>
</section>
<section id="trigger">
<h4>trigger<a class="headerlink" href="#trigger" title="Ссылка на этот заголовок"></a></h4>
<section id="trigger-u-logic">
<h5>Что такое узел trigger в U-Logic?<a class="headerlink" href="#trigger-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел trigger в U-Logic облегчает инициирование и повторение сообщений с настраиваемыми интервалами, предлагая точный контроль над временем отправки сообщений, частотой их повторения и дополнительными задержками. Эта функциональность ценна для автоматизации задач и эффективного управления потоком сообщений в потоках U-Logic.</p>
</section>
<section id="trigger-inject">
<h5>Разница узлов trigger и inject<a class="headerlink" href="#trigger-inject" title="Ссылка на этот заголовок"></a></h5>
<p>Узел inject позволяет отправлять сообщения с определенными интервалами, но он запускается немедленно и продолжается бесконечно, если вручную не настроена остановка. С узлом trigger вы можете контролировать, когда узел начинает и прекращает отправлять сообщения. Тем не менее, оба узла обладают различными вариантами использования и ограничениями.</p>
</section>
<section id="id218">
<h5>Настройка узла trigger<a class="headerlink" href="#id218" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><strong>Отправить</strong>: Сообщение для передачи последующим узлам.</p></li>
<li><p><strong>затем</strong>:</p>
<ul>
<li><p><strong>ждать</strong>: Позволяет отправлять сообщение при срабатывании и затем опционально второе сообщение. Вы также можете настроить его так, чтобы он не отправлял ничего при срабатывании или для второго сообщения.</p>
<ul>
<li><p><strong>продлить при поступлении нового сообщения</strong>: включение этой опции увеличит время задержки при получении нового сообщения.</p></li>
<li><p><strong>затем отправить</strong>: Позволяет настроить отправку второго сообщения с определенной задержкой или вообще не отправлять сообщение.</p></li>
<li><p><strong>отправить второе сообщение на отдельный выход</strong>: включение этой опции добавит второй выход для получения второго сообщения от узла trigger.</p></li>
</ul>
</li>
<li><p><strong>переотправлять его каждые</strong>: позволяет повторно отправлять сообщение через определенные промежутки времени.</p></li>
<li><p><strong>ждать сброс</strong>: выбор этого параметра отправит сообщение один раз при срабатывании и будет ждать, пока оно не будет сброшено. Если сброс не произойдёт, узел не будет отправлять сообщения с тем же свойством, указанным в настройке. Если выбраны все сообщения, узел не будет отправлять никаких сообщений до тех пор, пока не будет сброшен.»</p></li>
</ul>
</li>
<li><p><strong>Сбрасывать триггер, если</strong>: Позволяет установить <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>, который при получении сбросит узел trigger. В качестве альтернативы отправка сообщения, содержащего свойство reset, сбросит узел (что является поведением по умолчанию).</p></li>
<li><p><strong>заменить задержку через <code class="docutils literal notranslate"><span class="pre">msg.delay</span></code></strong>: Включение этой опции позволит отправлять время задержки динамически с помощью msg.delay. Значение должно быть указано в миллисекундах.</p></li>
<li><p><strong>Обрабатывать</strong>: Позволяет настроить узел для обработки сообщений как отдельных потоков, используя свойство <code class="docutils literal notranslate"><span class="pre">msg</span></code> для идентификации. Выбор «Все сообщения» будет обрабатывать все типы сообщений по отдельности.</p></li>
</ul>
</section>
<section id="id219">
<h5>Варианты использования узла триггера:<a class="headerlink" href="#id219" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><strong>Повторяющиеся задачи</strong>: если у вас есть задачи, которые необходимо повторять через регулярные промежутки времени, например, опрос данных или проверка состояния устройства при срабатывании, узел trigger может справиться с этим, настроив его на повторную отправку сообщений через указанные интервалы времени.</p></li>
<li><p><strong>Обработка тайм-аутов</strong>: вы можете использовать узел trigger для управления тайм-аутами в вашем потоке. Например, вы можете запустить действие, если ответ не получен в течение определенного периода времени, или настроить механизм тайм-аута для взаимодействия с пользователем.</p></li>
<li><p><strong>Сохранение ресурсов</strong>: узел trigger может экономить энергию или системные ресурсы, автоматически инициируя действия, такие как выключение света или закрытие клапанов, после предопределенного периода бездействия или завершения задачи.</p></li>
</ul>
</section>
<section id="id220">
<h5>Примеры<a class="headerlink" href="#id220" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>В примере ниже мы смоделировали систему дверного замка. Мы используем узел ввода для ввода пароля, который затем проверяется по указанному паролю в узле коммутатора. Если введенный пароль правильный, узел триггера отправляет полезную нагрузку для открытия двери. Через 4 секунды отправляется второе сообщение для закрытия двери. Это также можно использовать для сценариев, включающих включение и выключение светодиода.</p></li>
</ol>
<p><img alt="Пример использования узла trigger" src="../_images/trigger_scheme.png" /></p>
<ol class="arabic simple" start="2">
<li><p>В примере потока ниже у нас есть узел триггера, который непрерывно опрашивает данные из API. Он опрашивает данные с определенным интервалом при получении сообщения и останавливается, если получено сообщение со свойством „сброс“. Это также можно использовать в сценариях, где вы хотите считывать данные датчика с помощью пользовательского элемента управления.</p></li>
</ol>
<p><img alt="Пример использования узла trigger" src="../_images/trigger_scheme2.png" /></p>
</section>
<section id="id221">
<h5>Документация по узлу<a class="headerlink" href="#id221" title="Ссылка на этот заголовок"></a></h5>
<p>При срабатывании может отправить сообщение, а затем опционально второе сообщение, если не будет продлено или сброшено.</p>
<section id="id222">
<h6>Входные значения<a class="headerlink" href="#id222" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delay</span></code>: Устанавливает задержку в миллисекундах, применяемую к сообщению. Эта опция применяется только в том случае, если узел настроен на разрешение сообщению переопределять настроенный интервал задержки по умолчанию.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code>: Если получено сообщение с этим свойством, любой текущий тайм-аут или повтор будут очищены, и сообщение не будет отправлено.</p></li>
</ul>
</section>
<section id="id223">
<h6>Подробности<a class="headerlink" href="#id223" title="Ссылка на этот заголовок"></a></h6>
<p>Этот узел можно использовать для создания тайм-аута в потоке. По умолчанию, когда он получает сообщение, он отправляет сообщение с <code class="docutils literal notranslate"><span class="pre">payload</span></code> равным 1. Затем он ждет 250 мс, прежде чем отправить второе сообщение с <code class="docutils literal notranslate"><span class="pre">payload</span></code> равным 0.</p>
<p><code class="docutils literal notranslate"><span class="pre">payload</span></code> каждого отправленного сообщения могут быть настроены на различные значения, включая опцию не отправлять ничего. Например, установив начальное сообщение на «ничего» и выбрав опцию продления таймера с каждым полученным сообщением, узел будет действовать как сторожевой таймер; отправляя сообщение только в том случае, если в течение установленного интервала ничего не получено.</p>
<p>Если задан строковый тип, узел поддерживает синтаксис шаблона mustache.</p>
<p>Задержку между отправкой сообщений можно переопределить при помощи <code class="docutils literal notranslate"><span class="pre">msg.delay</span></code> если эта опция включена в узле. Значение должно быть указано в миллисекундах.</p>
<p>Если узел получает сообщение со свойством <code class="docutils literal notranslate"><span class="pre">reset</span></code>, или <code class="docutils literal notranslate"><span class="pre">payload</span></code> которое соответствует настроенному в узле, любой текущий тайм-аут или повтор будет очищен, и сообщение не будет отправлено.</p>
<p>Узел можно настроить на повторную отправку сообщения через регулярные интервалы времени до тех пор, пока он не будет сброшен полученным сообщением.</p>
<p>При желании узел можно настроить на обработку сообщений так, как будто они являются отдельными потоками, используя свойство <code class="docutils literal notranslate"><span class="pre">msg</span></code> для идентификации каждого потока. Значение по умолчанию <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code>.</p>
<p>Статус указывает, что узел в данный момент активен. Если используется несколько потоков, статус указывает количество удерживаемых потоков.</p>
</section>
</section>
</section>
</section>
<section id="id224">
<h3>сеть<a class="headerlink" href="#id224" title="Ссылка на этот заголовок"></a></h3>
<section id="http-request">
<h4>http request<a class="headerlink" href="#http-request" title="Ссылка на этот заголовок"></a></h4>
<section id="http-request-u-logic">
<h5>Для чего используются узлы http request в U-Logic?<a class="headerlink" href="#http-request-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>В U-Logic узел http request позволяет вам делать HTTP-запросы к внешним серверам или службам. Это позволяет вам взаимодействовать с веб-службами, API или любыми другими конечными точками на основе HTTP.</p>
<p>При настройке узла http request вы обычно указываете метод (GET, POST, PUT, DELETE и т. д.), URL-адрес конечной точки, с которой вы хотите взаимодействовать, любые заголовки, которые вам нужно включить, и payload, если применимо. После настройки этот узел будет отправлять HTTP-запрос при срабатывании входящего сообщения или события.</p>
</section>
<section id="id225">
<h5>Настройка узла http request<a class="headerlink" href="#id225" title="Ссылка на этот заголовок"></a></h5>
<p>Ниже вы найдете ряд настроек для адаптации HTTP-запросов к потребностям различных API или веб-сервисов. В зависимости от сервиса, с которым вы работаете, некоторые параметры могут быть критически важными, а другие — необязательными.</p>
<ul class="simple">
<li><p><strong>Метод</strong>: Выберите метод HTTP для запроса (GET, POST, PUT, DELETE, HEAD). Также возможно задать его динамически с помощью <code class="docutils literal notranslate"><span class="pre">msg.method</span></code>.</p></li>
<li><p><strong>URL</strong>: Укажите URL конечной точки для связи. Динамическая настройка URL разрешена с помощью <code class="docutils literal notranslate"><span class="pre">msg.url</span></code>. Кроме того, если вы хотите создать URL со свойством сообщения, вы можете использовать теги в стиле Mustache с двойными фигурными скобками <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code>. Например, <code class="docutils literal notranslate"><span class="pre">example.com/{{topic}}</span></code>, где значение <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code> будет вставлено автоматически. Использование двойных фигурных скобок <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code> по умолчанию выполняет экранирование HTML, поэтому специальные символы в заменяемом значении будут экранированы. Однако, если вы хотите сохранить специальные символы, такие как <code class="docutils literal notranslate"><span class="pre">/</span></code> и <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> в созданном URL, вы можете использовать тройные фигурные скобки <code class="docutils literal notranslate"><span class="pre">{{{</span> <span class="pre">}}}</span></code>.</p></li>
<li><p><strong>Данные</strong>: позволяет выбрать, как полученные данные от предыдущего узла будут отправлены ​​вместе с запросом:</p>
<ul>
<li><p><strong>Игнорировать</strong>: если включено, данные будет игнорироваться.</p></li>
<li><p><strong>Добавлять к параметрам строки запроса</strong>: включение этой опции позволит отправлять параметры строки запроса URL с помощью <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>.</p></li>
<li><p><strong>Отправлять как тело запроса</strong>: отправить <code class="docutils literal notranslate"><span class="pre">payload</span></code> как часть тела запроса.</p></li>
</ul>
</li>
<li><p><strong>Включить безопасное (SSL/TLS) соединение</strong>: позволяет активировать SSL/TLS для безопасной связи. Доступны параметры конфигурации TLS. Для получения дополнительной информации см. узел конфигурации TLS.</p></li>
<li><p><strong>Использовать аутентификацию</strong>: при необходимости разрешить предоставление учетных данных для аутентификации.</p>
<ul>
<li><p>Тип: Выберите тип аутентификации.</p>
<ul>
<li><p><strong>basic</strong>: Использует базовую аутентификацию, при которой имя пользователя и пароль отправляются в заголовках запроса в кодировке Base64.</p>
<ul>
<li><p><strong>Имя польз.</strong>: Укажите имя пользователя для аутентификации.</p></li>
<li><p><strong>Пароль</strong>: Укажите пароль для аутентификации.</p></li>
</ul>
</li>
<li><p><strong>digest аутентификация</strong>: Использует дайджест-аутентификацию, которая более безопасна, чем базовая аутентификация, поскольку отправляет хэшированные пароли, а не открытый текст.</p></li>
<li><p><strong>bearer authentication</strong>: Использует аутентификацию Bearer Token, при которой токен Bearer, обычно JSON Web Token (JWT), отправляется в заголовке авторизации.</p></li>
<li><p><strong>Токен</strong>: Укажите токен предъявителя, если выбрана аутентификация по предъявителю.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Включить keep-alive соединение</strong>: Включение этой опции позволит поддерживать постоянные соединения для повышения эффективности.</p></li>
<li><p><strong>Использовать прокси</strong>: Позволяет при необходимости направлять запросы через прокси-сервер.</p></li>
<li><p><strong>Only send non-2xx responses to Catch node</strong>: Включение этой опции будет отправлять на узел catch только неуспешные ответы.</p></li>
<li><p><strong>Disable strict HTTP parsing</strong>: Включение этой опции смягчает то, как U-Logic интерпретирует HTTP-ответы. Это удобно при работе с ответами, которые не полностью соответствуют стандартному формату HTTP.</p></li>
<li><p><strong>Возврат</strong>: Позволяет выбрать формат для преобразования данных ответа.</p>
<ul>
<li><p><strong>строка UTF-8</strong>: Возвращает данные ответа в виде строки UTF-8.</p></li>
<li><p><strong>двоичный буфер</strong>: Возвращает данные ответа в виде двоичного буфера.</p></li>
<li><p><strong>объект JSON</strong>: Анализирует данные ответа как JSON и возвращает объект.</p></li>
</ul>
</li>
<li><p><strong>Заголовки</strong>: позволяет добавлять заголовки к HTTP-запросу, например content-type, accept, user agent и т. д. Вы можете динамически устанавливать заголовки с помощью <code class="docutils literal notranslate"><span class="pre">msg.headers</span></code>. Однако сброс <code class="docutils literal notranslate"><span class="pre">msg.headers</span></code> позволяет избежать непреднамеренного наследования заголовков при использовании нескольких узлов http request в одном потоке. Более того, если <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> это объект, узел автоматически устанавливает Content-Type значение `application/json.</p></li>
</ul>
</section>
<section id="id226">
<h5>Вариант использования<a class="headerlink" href="#id226" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p><strong>Интеграция API</strong>: узел http request обеспечивает бесшовную интеграцию с внешними API. Разработчики могут использовать его для извлечения данных из API с помощью запросов GET или отправки данных в API с помощью запросов POST/PUT. Например, извлечение данных о погоде из API погоды или отправка данных в службу обмена сообщениями, являются распространенными сценариями.</p></li>
<li><p><strong>Удаленное управление и управление устройствами</strong>: в системах умного дома узел http request может использоваться для упрощения удаленного управления устройствами. Он позволяет пользователям управлять различными устройствами, такими как освещение, термостаты и камеры безопасности, через веб-интерфейсы или мобильные интерфейсы, взаимодействуя с API устройств. Такие действия, как переключение устройств, настройка параметров и получение обновлений в реальном времени, могут быть выполнены через узел http request.</p></li>
</ol>
<p>Это несколько вариантов использования узла http request, но его способность взаимодействовать с другими службами является важной и ключевой возможностью. Одна эта возможность открывает дверь к разнообразному массиву различных вариантов использования.</p>
</section>
<section id="id227">
<h5>Примеры<a class="headerlink" href="#id227" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>Ниже приведен пример, показывающий, как можно создать URL-адрес со свойствами сообщения в узле http request. Пример включает отправку запроса GET.</p></li>
</ol>
<p><img alt="Пример использования узла http request" src="../_images/example1.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Ниже приведен пример, показывающий, как можно отправить HTTP POST-запрос на фиктивный API. Этот пример включает регистрацию пользователя.</p></li>
</ol>
<p><img alt="Пример использования узла http request" src="../_images/example2_edit.png" /></p>
<p><img alt="Пример использования узла http request" src="../_images/example2.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Ниже приведен пример, демонстрирующий, как можно динамически задать URL, метод и заголовки для узла http request. Кроме того, этот пример иллюстрирует отправку запроса GET на фиктивный API с токеном авторизации.</p></li>
</ol>
<p><img alt="Пример использования узла http request" src="../_images/example3_edit.png" /></p>
<p><img alt="Пример использования узла http request" src="../_images/example3.png" /></p>
<ol class="arabic simple" start="4">
<li><p>Ниже приведен пример, показывающий, как можно отправить запрос PUT с помощью узла http request.</p></li>
</ol>
<p><img alt="Пример использования узла http request" src="../_images/example4_edit.png" /></p>
<p><img alt="Пример использования узла http request" src="../_images/example4.png" /></p>
<ol class="arabic simple" start="5">
<li><p>Ниже приведен пример, показывающий, как можно отправить запрос DELETE с помощью узла http request.</p></li>
</ol>
<p><img alt="Пример использования узла http request" src="../_images/example5_edit.png" /></p>
<p><img alt="Пример использования узла http request" src="../_images/example5.png" /></p>
</section>
<section id="id228">
<h5>Документация по узлу<a class="headerlink" href="#id228" title="Ссылка на этот заголовок"></a></h5>
<p>Отправляет HTTP-запросы и возвращает ответ.</p>
<section id="id229">
<h6>Входные данные<a class="headerlink" href="#id229" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code>: Если не настроено в узле, это необязательное свойство задает URL-адрес запроса.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: Если не настроено в узле, это необязательное свойство задает метод HTTP запроса. Должен быть одним из GET, PUT, DELETE или HEAD.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code>: Устанавливает заголовки HTTP запроса. Любые заголовки, установленные в конфигурации узла, перезапишут любые соответствующие заголовки в <code class="docutils literal notranslate"><span class="pre">msg.headers</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cookies</span></code>: Если установлено, может использоваться для отправки файлов cookie вместе с запросом.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">payload</span></code>: Отправлено как текст запроса.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rejectUnauthorized</span></code>: Если установлено значение <code class="docutils literal notranslate"><span class="pre">false</span></code>, разрешается отправлять запросы на https-сайты, использующие самоподписанные сертификаты.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">followRedirects</span></code>: Если установлено в <code class="docutils literal notranslate"><span class="pre">false</span></code>, предотвращает следование перенаправлениям (HTTP 301). По умолчанию true.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requestTimeout</span></code>: Если задано положительное число миллисекунд, будет переопределен глобально заданный httpRequestTimeout параметр.</p></li>
</ul>
</section>
<section id="id230">
<h6>Выходные данные<a class="headerlink" href="#id230" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">payload</span></code>: Тело ответа. Узел можно настроить так, чтобы он возвращал тело как строку, пытался проанализировать его как строку JSON или оставлял его как двоичный буфер.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">statusCode</span></code>: Код статуса ответа или код ошибки, если запрос не может быть выполнен.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code>: Объект, содержащий заголовки ответа.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">responseUrl</span></code>: В случае, если при обработке запроса произошли перенаправления, это свойство является окончательным перенаправленным URL. В противном случае — URL исходного запроса.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">responseCookies</span></code>: Если ответ включает файлы cookie, это свойство представляет собой объект пар «имя/значение» для каждого файла cookie.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">redirectList</span></code>: Если запрос был перенаправлен один или несколько раз, накопленная информация будет добавлена ​​в это свойство. <code class="docutils literal notranslate"><span class="pre">location</span></code> — следующий пункт назначения перенаправления. <code class="docutils literal notranslate"><span class="pre">cookies</span></code> — файлы cookie, возвращаемые источником перенаправления.</p></li>
</ul>
</section>
<section id="id231">
<h6>Подробности<a class="headerlink" href="#id231" title="Ссылка на этот заголовок"></a></h6>
<p>При настройке в узле свойство URL может содержать теги в стиле mustache . Они позволяют создавать URL-адрес с использованием значений входящего сообщения. Например, если URL-адрес установлен на <code class="docutils literal notranslate"><span class="pre">example.com/{{{topic}}}</span></code>, он будет иметь значение <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code> автоматически вставленного. Использование <code class="docutils literal notranslate"><span class="pre">{{{...}}}</span></code> предотвращает экранирование mustache символов, таких как <code class="docutils literal notranslate"><span class="pre">/</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> и т. д.</p>
<p>Узел может опционально автоматически кодировать <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> параметры строки запроса для запроса GET, в этом случае <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> они должны быть объектом.</p>
<p><strong>Использование нескольких узлов HTTP-запросов</strong></p>
<p>Чтобы использовать более одного такого узла в одном потоке, необходимо внимательно относиться к свойству msg.headers. Первый узел установит это свойство, заполнив его заголовками ответа. Следующий узел затем использует эти заголовки для своего запроса, что обычно является некорректным поведением.</p>
<p>Если свойство msg.headers остаётся неизменным между узлами, второй узел его проигнорирует. Чтобы задать собственные заголовки, перед этим необходимо удалить msg.headers или сбросить его в пустой объект {}.</p>
<p><strong>Обработка файлов cookie</strong></p>
<p>Свойство cookies, переданное узлу, должно быть объектом пар «имя/значение». Значение может быть либо строкой для установки значения cookie, либо объектом с одним свойством <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<p>Все файлы cookie, возвращаемые запросом, передаются обратно в свойство <code class="docutils literal notranslate"><span class="pre">responseCookies</span></code>.</p>
<p><strong>Обработка типов контента</strong></p>
<p>Если <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> это объект, узел автоматически установит тип содержимого запроса <code class="docutils literal notranslate"><span class="pre">application/json</span></code> и закодирует тело соответствующим образом.</p>
</section>
</section>
</section>
<section id="websocket">
<h4>websocket<a class="headerlink" href="#websocket" title="Ссылка на этот заголовок"></a></h4>
<section id="websocket-u-logic">
<h5>Для чего используются узлы WebSocket в U-Logic?<a class="headerlink" href="#websocket-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>U-Logic предоставляет два узла websocket in и websocket out, которые служат различным целям и могут работать в двух режимах.</p>
<section id="id232">
<h6>Слушать на…<a class="headerlink" href="#id232" title="Ссылка на этот заголовок"></a></h6>
<p>В этом режиме U-Logic функционирует как сервер WebSocket, позволяя удаленным клиентам устанавливать соединения.</p>
<ul class="simple">
<li><p>Узел websocket in отвечает за прием сообщений, отправленных удаленными клиентами.</p></li>
<li><p>Узел websocket out обеспечивает поток сообщений либо для отправки сообщений конкретному подключенному клиенту, либо для широковещательной рассылки сообщений всем подключенным клиентам.</p></li>
</ul>
</section>
<section id="id233">
<h6>Присоединиться к…<a class="headerlink" href="#id233" title="Ссылка на этот заголовок"></a></h6>
<p>В этом режиме U-Logic действует как клиент, устанавливая соединения с удаленными серверами WebSocket.</p>
<ul class="simple">
<li><p>Узел websocket in получает сообщения, отправленные с удаленного сервера WebSocket на U-Logic.</p></li>
<li><p>Узел websocket out позволяет потоку отправлять сообщения на удаленный сервер.</p></li>
</ul>
</section>
</section>
<section id="id234">
<h5>Конфигурация узла WebSocket<a class="headerlink" href="#id234" title="Ссылка на этот заголовок"></a></h5>
<section id="id235">
<h6>Путь<a class="headerlink" href="#id235" title="Ссылка на этот заголовок"></a></h6>
<p>При использовании узла WebSocket в режиме «Слушать на…» вам придется указать путь или конечную точку, к которой удаленные клиенты будут устанавливать соединение.</p>
</section>
<section id="id236">
<h6>Отправить/Получить<a class="headerlink" href="#id236" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p>payload: эта опция отправляет или получает только данные <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> через соединение WebSocket. Она исключает любые дополнительные свойства <code class="docutils literal notranslate"><span class="pre">msg</span></code>.</p></li>
<li><p>Полное сообщение: если этот параметр включен, он позволяет отправлять или получать весь объект сообщения, включая payload и другие свойства, в виде строки в формате JSON.</p></li>
</ul>
</section>
<section id="url">
<h6>URL<a class="headerlink" href="#url" title="Ссылка на этот заголовок"></a></h6>
<p>При использовании узла WebSocket в режиме «Присоединиться к…» вам придется указать URL-адрес соединения, который должен использовать схему <code class="docutils literal notranslate"><span class="pre">ws://</span></code> или <code class="docutils literal notranslate"><span class="pre">wss://</span></code> указывать на существующий прослушиватель WebSocket.</p>
</section>
<section id="id237">
<h6>Подпротокол<a class="headerlink" href="#id237" title="Ссылка на этот заголовок"></a></h6>
<p>Эта опция позволяет указать конкретный подпротокол WebSocket, который будет использоваться во время установления соединения.</p>
</section>
<section id="send-heartbeat">
<h6>Send heartbeat<a class="headerlink" href="#send-heartbeat" title="Ссылка на этот заголовок"></a></h6>
<p>Включение этой опции позволяет указать временной интервал в секундах для отправки периодических сообщений ping от клиента к серверу для поддержания соединения. Сервер отвечает сообщением pong для подтверждения статуса соединения.</p>
<p>Это помогает предотвратить закрытие соединения из-за бездействия или проблем с сетью.</p>
</section>
</section>
<section id="id238">
<h5>Примеры<a class="headerlink" href="#id238" title="Ссылка на этот заголовок"></a></h5>
<p>Простой эхо-тест</p>
<p>Здесь показаны оба режима: один набор действует как WebSocket Echo Server, а другой подключается к этому серверу и отправляет и получает сообщения.</p>
<p><img alt="Пример использования узлов websocket in и websocket out" src="../_images/websocket_example.png" /></p>
</section>
<section id="id239">
<h5>Документация по узлу<a class="headerlink" href="#id239" title="Ссылка на этот заголовок"></a></h5>
<section id="websocket-in">
<h6>websocket in<a class="headerlink" href="#websocket-in" title="Ссылка на этот заголовок"></a></h6>
<p>По умолчанию данные, полученные от websocket in, будут в формате <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>. Сокет можно настроить на ожидание правильно сформированной строки JSON, в этом случае он проанализирует JSON и отправит полученный объект как целое сообщение.</p>
</section>
<section id="websocket-out">
<h6>websocket out<a class="headerlink" href="#websocket-out" title="Ссылка на этот заголовок"></a></h6>
<p>По умолчанию <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> будет отправлено через websocket. Сокет можно настроить для кодирования всего <code class="docutils literal notranslate"><span class="pre">msg</span></code> объекта как строки JSON и отправки его через WebSocket.</p>
<p>Если сообщение, прибывающее на этот узел, началось с узла websocket in, сообщение будет отправлено обратно клиенту, который инициировал поток. В противном случае сообщение будет передано всем подключенным клиентам.</p>
<p>Если вы хотите транслировать сообщение, начатое в узле websocket in, вам следует удалить свойство <code class="docutils literal notranslate"><span class="pre">msg._session</span></code> в потоке.</p>
<p>Этот узел конфигурации создает конечную точку сервера websocket, используя указанный путь.</p>
<p>Этот узел конфигурации подключает клиент websocket к указанному URL-адресу.</p>
</section>
</section>
</section>
<section id="tcp">
<h4>tcp<a class="headerlink" href="#tcp" title="Ссылка на этот заголовок"></a></h4>
<section id="id240">
<h5>Что такое TCP<a class="headerlink" href="#id240" title="Ссылка на этот заголовок"></a></h5>
<p>TCP (Transmission Control Protocol) — один из основных протоколов пакета протоколов Интернета (обычно называемого TCP/IP). Это протокол с установлением соединения, который обеспечивает надежную, упорядоченную и проверенную на наличие ошибок доставку пакетов данных по сети. TCP гарантирует доставку пакетов данных в том же порядке, в котором они были отправлены. Для получения дополнительной информации о TCP см. <a class="reference external" href="https://www.ietf.org/rfc/rfc9293.html">RFC 9293</a>.</p>
</section>
<section id="tcp-in-u-logic">
<h5>Для чего используются узлы tcp in в U-Logic?<a class="headerlink" href="#tcp-in-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел TCP в U-Logic позволяет устанавливать соединения с удаленными портами TCP, выступая в качестве клиента TCP для связи с внешними службами или устройствами. Кроме того, он облегчает создание сервера TCP, который может принимать входящие соединения. Эта функциональность поддерживает различные приложения, такие как взаимодействие с веб-серверами или получение потоков данных от устройств IoT. Независимо от того, работаете ли вы над проектами IoT, промышленной автоматизацией или сетевыми системами, этот узел легко интегрирует связь TCP/IP в ваши рабочие процессы U-Logic.</p>
</section>
<section id="tcp-in">
<h5>Настройка узла tcp in<a class="headerlink" href="#tcp-in" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p>Тип:</p></li>
<li><p>Слушать: позволяет узлу TCP выступать в качестве сервера, прослушивающего входящие соединения.</p></li>
<li><p>Подключиться: позволяет узлу TCP действовать как клиент, устанавливая соединения с удаленными серверами.</p></li>
<li><p>к хосту: указывает имя хоста или IP-адрес удаленного сервера при использовании типа «Подключиться».</p></li>
<li><p>порт: указывает номер порта TCP для прослушивания (при использовании типа «Слушать») или для подключения (при использовании типа «Подключиться»).</p></li>
<li><p>Включить безопасное (SSL/TLS) соединение: включение этой опции активирует SSL/TLS для безопасной связи.</p></li>
<li><p>Вывод:</p>
<ul>
<li><p>поток: При выборе этого параметра поток данных, полученный по TCP-соединению, будет выводиться как непрерывный поток сообщений.</p></li>
<li><p>одиночный: При выборе этого параметра будет выведено одно сообщение, содержащее данные, полученные по TCP-соединению.</p></li>
</ul>
</li>
<li><p>payload: Поток или отдельное сообщение данных, которые вы отправляете/получаете:</p>
<ul>
<li><p>буфер: данные отправляются/принимаются как объект буфера.</p></li>
<li><p>cтрока: данные отправляются/принимаются в виде строки.</p></li>
<li><p>cтрока Base64: данные отправляются/принимаются как строка Base64.</p>
<ul>
<li><p>разделены с: Укажите разделитель для разделения входящих потоков данных. Укажите разделитель для разделения входящих потоков данных. Обычно, <code class="docutils literal notranslate"><span class="pre">,</span></code>, <code class="docutils literal notranslate"><span class="pre">\r</span></code>, <code class="docutils literal notranslate"><span class="pre">\n</span></code>.</p></li>
<li><p>re-attach delimiter: включение этой опции приведет к повторному прикреплению разделителя на исходное место.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id241">
<h5>Варианты использования<a class="headerlink" href="#id241" title="Ссылка на этот заголовок"></a></h5>
<p><strong>Связь с серверами</strong>: узел tcp in позволяет U-Logic взаимодействовать с различными серверами через связь TCP/IP. Это позволяет приложениям, таким как извлечение данных с веб-серверов или обмен информацией с другими сетевыми службами.</p>
<p><strong>Интеграция с устройствами на базе TCP</strong>: U-Logic может легко интегрироваться с устройствами на базе TCP, такими как промышленные датчики, ПЛК (программируемые логические контроллеры) или пользовательские аппаратные контроллеры. Узел TCP-In обеспечивает двунаправленную связь, облегчая такие задачи, как отправка команд устройствам или получение потоков данных в реальном времени.</p>
</section>
<section id="id242">
<h5>Примеры<a class="headerlink" href="#id242" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>В приведенном ниже примере мы создаем базовый TCP-сервер с использованием узла tcp in.</p></li>
</ol>
<p><img alt="Пример использования узла tcp in" src="../_images/tcpin_example1.png" /></p>
<ol class="arabic simple" start="2">
<li><p>В приведенном ниже примере потока мы демонстрируем, как использовать узел tcp in вместе с другими узлами TCP для обеспечения двунаправленной связи.</p></li>
</ol>
<p><img alt="Пример использования узла tcp in" src="../_images/tcpin_example2.png" /></p>
</section>
<section id="id243">
<h5>Документация по узлу<a class="headerlink" href="#id243" title="Ссылка на этот заголовок"></a></h5>
<p>Предоставляет выбор входов TCP. Может подключаться к удаленному порту TCP или принимать входящие соединения.</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>В некоторых системах для доступа к портам ниже 1024 могут потребоваться права root или администратора.</p>
</div>
</section>
<section id="tcp-out-u-logic">
<h5>Для чего используются узлы tcp out в U-Logic?<a class="headerlink" href="#tcp-out-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Предоставляет выбор из нескольких исходящих TCP-узлов. Может подключаться к удаленному TCP-порту, принимать входящие подключения или отвечать на сообщения, полученные от узла TCP In.</p>
<p>В узле tcp out отправляются только данные <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>.</p>
<p>Если <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> является строкой, содержащей Base64-кодировку двоичных данных, опция «Расшифровать сообщение Base64?» приведет к ее преобразованию обратно в двоичный файл перед отправкой.</p>
<p>Если в узле tcp out <code class="docutils literal notranslate"><span class="pre">msg._session</span></code> отсутствует, данные отправляется всем подключенным клиентам.</p>
</section>
<section id="tcp-request-u-logic">
<h5>Для чего используются узлы tcp request в U-Logic?<a class="headerlink" href="#tcp-request-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел tcp request - отправляет <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> на tcp-порт сервера и ожидает ответа.</p>
<p>Подключается, отправляет «запрос» и читает «ответ». Он может либо подсчитать количество возвращенных символов в фиксированный буфер, сопоставить указанный символ перед возвратом, дождаться фиксированного времени ожидания от первого ответа и затем вернуться, сидеть и дожидаться данных, или отправить, а затем немедленно закрыть соединение, не дожидаясь ответа.</p>
<p>Ответ будет возвращен в <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> в виде буфера, поэтому вам может понадобиться применить к нему <code class="docutils literal notranslate"><span class="pre">.toString()</span></code>, если нужно преобразование в строку.</p>
<p>Если вы оставите tcp-хост или порт пустыми, они должны быть установлены с помощью свойств <code class="docutils literal notranslate"><span class="pre">msg.host</span></code> и <code class="docutils literal notranslate"><span class="pre">msg.port</span></code> в каждом сообщении, отправляемом узлу.</p>
</section>
</section>
<section id="udp">
<h4>udp<a class="headerlink" href="#udp" title="Ссылка на этот заголовок"></a></h4>
<section id="id244">
<h5>Что такое UDP?<a class="headerlink" href="#id244" title="Ссылка на этот заголовок"></a></h5>
<p>UDP (User Datagram Protocol) — это протокол без установления соединения в наборе протоколов Интернета. Он передает пакеты данных или датаграммы без установления соединения, отдавая приоритет скорости над надежностью. Обычно используется для приложений реального времени, таких как потоковое видео, онлайн-игры и VoIP. Простота UDP уменьшает задержку, но не гарантирует доставку пакетов данных. Для получения дополнительной информации см. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Glossary/UDP">UDP MDN Docs</a>.</p>
</section>
<section id="udp-in-u-logic">
<h5>Что такое узел udp in в U-Logic?<a class="headerlink" href="#udp-in-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел udp in в U-Logic позволяет принимать сообщения UDP от удаленных устройств или служб. Он действует как прослушиватель, ожидая входящие пакеты UDP на указанном порту. Эта функциональность имеет решающее значение для приложений реального времени, таких как прием данных IoT и сетевая связь. Независимо от того, получаете ли вы данные датчиков от устройств IoT или взаимодействуете с другими сетевыми системами, узел udp in бесшовно интегрирует связь UDP в ваши рабочие процессы U-Logic, предоставляя легкое и эффективное решение для приема данных.</p>
</section>
<section id="udp-in">
<h5>Настройка узла udp in<a class="headerlink" href="#udp-in" title="Ссылка на этот заголовок"></a></h5>
<p>Узел udp in в U-Logic предоставляет универсальные возможности конфигурации для настройки приема сообщений UDP в соответствии с конкретными требованиями:</p>
<ul class="simple">
<li><p>Слушать:</p>
<ul>
<li><p>UDP сообщения: получение стандартных UDP-сообщений от удаленных устройств или служб.</p></li>
<li><p>многоадресные сообщения: прослушивание многоадресных сообщений, позволяющее общаться с несколькими получателями одновременно.</p>
<ul>
<li><p>Группа: укажите адрес группы многоадресной рассылки.</p></li>
<li><p>Локал. IF: выберите сетевой интерфейс, который будет использоваться для получения многоадресных сообщений.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>На порте: определите номер порта, на котором узел udp in будет прослушивать входящие сообщения.</p></li>
<li><p>используя:</p>
<ul>
<li><p>ipv4: используйте адресацию IPv4 для связи.</p></li>
<li><p>ipv6: используйте адресацию IPv6 для связи, поддерживая последнюю версию IP.</p></li>
</ul>
</li>
<li><p>Выход: Выберите формат полученных данных:</p>
<ul>
<li><p>буфер: получать сообщения как объекты буфера.</p></li>
<li><p>строка: получать сообщения в виде строк.</p></li>
<li><p>строка Base64: получать сообщения, закодированные в формате base64.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>в некоторых системах для использования портов ниже 1024 и/или широковещательной передачи вам может потребоваться доступ root или администратора, а также необходимо убедиться, что ваш брандмауэр разрешает передачу данных.</p>
</div>
</section>
<section id="id245">
<h5>Выходные значения udp in<a class="headerlink" href="#id245" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>: Вывод полученных сообщений в виде буфера, строки или строки в кодировке base64.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg.fromip</span></code>: IP-адрес и порт, с которого было получено сообщение, в формате «IP:Port».</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">msg.ip</span></code> и <code class="docutils literal notranslate"><span class="pre">msg.port</span></code>: IP-адрес и порт, с которого было получено сообщение.</p></li>
</ul>
</section>
<section id="udp-out-u-logic">
<h5>Что такое узел udp-out в U-Logic?<a class="headerlink" href="#udp-out-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел udp out в U-Logic — это узел, используемый для отправки сообщений UDP в указанный сетевой пункт назначения. Когда вы добавляете узел udp-out в свой поток U-Logic, вы настраиваете его с IP-адресом и портом целевого устройства или службы. Затем любые сообщения, полученные узлом udp out, отправляются в виде пакетов UDP в этот пункт назначения. Этот узел особенно полезен для приложений, где требуется коммуникация в реальном времени или легкая передача сообщений.</p>
</section>
<section id="udp-out">
<h5>Настройка узла udp out<a class="headerlink" href="#udp-out" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p>Отправлять:</p>
<ul>
<li><p>UDP сообщение: Укажите IP-адрес целевого устройства или службы. Вы также можете указать IP-адрес динамически с помощью <code class="docutils literal notranslate"><span class="pre">msg.ip</span></code>, если это поле оставить пустым.</p></li>
<li><p>Широковещательное сообщение: Отправка сообщения всем устройствам в сети. Вы можете указать адрес как локальный широковещательный IP-адрес или использовать 255.255.255.255, который представляет собой глобальный широковещательный адрес.</p></li>
<li><p>Многоадресная рассылка: Отправка сообщения группе устройств.</p>
<ul>
<li><p>Группа: Укажите адрес группы многоадресной рассылки.</p></li>
<li><p>Локал. IF: Выберите сетевой интерфейс для отправки многоадресных сообщений.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>на порт:</p>
<ul>
<li><p>Укажите номер порта, на который будут отправляться пакеты UDP. Вы также можете указать IP-адрес динамически с помощью <code class="docutils literal notranslate"><span class="pre">msg.port</span></code>, если оставить это поле пустым.</p></li>
</ul>
</li>
<li><p>Адрес:</p>
<ul>
<li><p>ipv4: укажите адрес IPv4 для назначения.</p></li>
<li><p>ipv6: укажите адрес IPv6 для назначения.</p></li>
<li><p>привязать к случайному локальному порту: при выборе этого параметра система автоматически назначает доступный локальный порт для отправки UDP-пакетов.</p></li>
<li><p>привязать к локальному порту: при выборе этого параметра необходимо указать номер локального порта, к которому будет привязан сокет UDP.</p></li>
</ul>
</li>
<li><p>Декодировать данные кодированные в Base64?:</p>
<ul>
<li><p>Выберите, следует ли декодировать payload как Base64 перед отправкой. Эта опция полезна, если payload закодирована в формате Base64 и ее необходимо декодировать перед отправкой в ​​виде сообщения UDP.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>В некоторых системах для использования портов ниже 1024 и/или широковещательной передачи вам может потребоваться доступ root или администратора, а также необходимо убедиться, что ваш брандмауэр разрешает передачу данных</p>
</div>
</section>
<section id="id246">
<h5>Варианты использования узлов udp<a class="headerlink" href="#id246" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><strong>Сбор данных с датчиков</strong>: Получайте данные в режиме реального времени с датчиков IoT, установленных на объекте, например, показания датчиков температуры, влажности или движения.</p></li>
<li><p><strong>Мониторинг состояния устройств</strong>: Отслеживайте рабочее состояние устройств IoT, таких как подключенные приборы или промышленное оборудование, получая обновления состояния по протоколу UDP.</p></li>
<li><p><strong>Мониторинг окружающей среды</strong>: Сбор данных об окружающей среде с устройств IoT, установленных в удаленных местах, таких как датчики качества воздуха или метеостанции, для анализа и принятия решений.</p></li>
<li><p><strong>Отслеживание активов</strong>: Получайте данные о местоположении от устройств IoT, оснащенных технологией GPS или RFID, для отслеживания перемещения активов, транспортных средств или скота в режиме реального времени.</p></li>
<li><p><strong>Прием медиапотока</strong>: Прием медиапотока, например видео- или аудиоконтента, для таких приложений, как видеонаблюдение, прямая трансляция или мультимедийная связь.</p></li>
</ul>
</section>
<section id="id247">
<h5>Пример<a class="headerlink" href="#id247" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>В приведенном ниже примере у нас есть узел udp in, настроенный на прием данных, отправленных через локальный хост и порт 90, с использованием узла udp out.</p></li>
</ol>
<p><img alt="Пример использования узлов udp in и udp out" src="../_images/udp_example.png" /></p>
</section>
<section id="id248">
<h5>Документация по узлам<a class="headerlink" href="#id248" title="Ссылка на этот заголовок"></a></h5>
<p>Предоставляет выбор входов UDP. Может подключаться к удаленному порту UDP или принимать входящие соединения.</p>
</section>
</section>
</section>
<section id="id249">
<h3>последоват-ть<a class="headerlink" href="#id249" title="Ссылка на этот заголовок"></a></h3>
<section id="split">
<h4>split<a class="headerlink" href="#split" title="Ссылка на этот заголовок"></a></h4>
<section id="split-u-logic">
<h5>Для чего используется узел split в U-Logic?<a class="headerlink" href="#split-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Обработка данных на более детальном уровне важна в сценариях использования IoT, поскольку, например, несколько тегов могут быть отправлены в одном запросе на сервер. Или когда запрос SQL приводит к множеству результатов, требующих индивидуальной обработки. В U-Logic потоки основаны на сообщениях, но сообщение может быть разделено на несколько сообщений, если это необходимо, с помощью узла split. Узел split является одним из основных узлов в U-Logic. Это фундаментальный строительный блок для мощных автоматизаций.</p>
<p>Узел split используется для разделения одного сообщения на несколько сообщений на основе определенных правил.</p>
<p>Узел split в U-Logic используется для разделения входящего объекта сообщения на несколько различных объектов сообщения. Входящий объект может быть простой строкой, массивом или объектом. Узел split разделит объект на основе следующих критериев:</p>
<ul class="simple">
<li><p>Строка/Буфер: узел split разделит строку по символу-разделителю. Символ-разделитель можно указать в конфигурации узла.</p></li>
<li><p>Массив: узел split разделит массив на серию сообщений, каждое из которых содержит один элемент массива.</p></li>
<li><p>Объект: узел split разделит объект по ключам объекта. Ключи объекта можно указать в конфигурации узла.</p></li>
</ul>
<p>Узел split может использоваться для обработки данных различными способами. Например, его можно использовать для разделения строки текста на ряд сообщений, каждое из которых содержит одно слово текста. Его также можно использовать для разделения массива данных на ряд сообщений, каждое из которых содержит один элемент массива.</p>
<p>Ниже приведены некоторые примеры использования узла split:</p>
<ol class="arabic simple">
<li><p>Разбиение строки текста на серию сообщений, каждое из которых содержит одно слово текста.</p></li>
<li><p>Разбиение массива данных на серию сообщений, каждое из которых содержит один элемент массива.</p></li>
<li><p>Разделение объекта по ключам объекта для создания серии сообщений, каждое из которых содержит одну пару ключ-значение объекта.</p></li>
<li><p>Разделение сообщения по символу-разделителю для создания серии сообщений, каждое из которых содержит одну часть сообщения.</p></li>
</ol>
<p>Узел split — это мощный инструмент, который можно использовать для обработки данных различными способами. Это ценное дополнение к любому потоку U-Logic.</p>
</section>
<section id="id250">
<h5>Примеры<a class="headerlink" href="#id250" title="Ссылка на этот заголовок"></a></h5>
<section id="id251">
<h6>Разделение массивов<a class="headerlink" href="#id251" title="Ссылка на этот заголовок"></a></h6>
<p><strong>Разделение поэлементно</strong></p>
<p>Самый простой способ разбить сообщение на несколько — это когда структура входного сообщения естественным образом разбивается на несколько. Массивы являются примером таких структур. Создание выходного сообщения для каждого элемента является режимом по умолчанию для split. При вводе одного массива с <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code> содержимым в качестве, будут напечатаны 4 сообщения в следующем порядке:</p>
<p><img alt="Пример использования узла split" src="../_images/example11.png" /></p>
<p><strong>Перегруппировка элементов</strong></p>
<p>Когда требуется перегруппировка большого количества элементов, узел split можно использовать для фрагментации данных. Например, некоторые API позволяют обновлять только 20 записей за раз. Если у вас больше входных данных, разделение их подгрупп разделит их на несколько сообщений. Это делается путем установки «Фикс. длина» максимального размера подгруппы. Допустим, <code class="docutils literal notranslate"><span class="pre">payload</span></code> для разделения <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5]</span></code> установлена «Фикс. длина» ​​на 2. Это отправит 3 сообщения: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2]</span></code>, <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">4]</span></code> и <code class="docutils literal notranslate"><span class="pre">[5]</span></code>.</p>
<p><img alt="Пример использования узла split" src="../_images/example21.png" /></p>
</section>
<section id="id252">
<h6>Разделение текста<a class="headerlink" href="#id252" title="Ссылка на этот заголовок"></a></h6>
<p><strong>Разделение построчно</strong></p>
<p>Текст можно разбить несколькими способами, чаще всего построчно. Хотя их также можно разбить по фиксированной длине, что полезно, когда данные структурированы предиктивно.</p>
<p>Давайте начнем с разделения построчно, так как это стандартный способ работы узла. Оставьте значение «С помощью» в разделе «Строка/Буфер» равным \n, что является символом окончания строки в системах на базе Unix. В нашем следующем примере у нас есть список из 3 городов в Европе, которые нам нужны по отдельности.</p>
<p>Обратите внимание, что здесь мы просто используем узел template, поскольку узел inject не позволяет создавать многострочные строки.</p>
<p><img alt="Пример использования узла split" src="../_images/example31.png" /></p>
<p><strong>Разделение по слову</strong></p>
<p>Когда вы что-то разделили по строкам, вам может понадобиться разделить по словам. Просто поставьте пробел в значении «С помощью» в разделе «Строка/Буфер». Это не показывает видимый символ в форме, в отличие от символа окончания строки.</p>
<p><img alt="Пример использования узла split" src="../_images/example41.png" /></p>
</section>
<section id="id253">
<h6>Разделение объектов<a class="headerlink" href="#id253" title="Ссылка на этот заголовок"></a></h6>
<p>Оставшаяся структура данных узла Split в U-Logic — это «Объекты», которые представляют собой универсальную категорию. В U-Logic используются хеши — пары ключ-значение, где ключами являются имена свойств, а значениями — их соответствующие данные. Примером такой структуры является JSON. В приведённом ниже примере мы разделим соответствие слов «one» и «two» с их числовыми значениями.</p>
<p><img alt="Пример использования узла split" src="../_images/example51.png" /></p>
</section>
</section>
<section id="id254">
<h5>Документация по узлу<a class="headerlink" href="#id254" title="Ссылка на этот заголовок"></a></h5>
<p>Разбивает сообщение на последовательность сообщений.</p>
<section id="id255">
<h6>Входные значения<a class="headerlink" href="#id255" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">payload</span></code>: Поведение узла определяется типом <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code>:</p>
<ul>
<li><p>строка / буфер - сообщение разбивается с использованием указанного символа (по умолчанию: <code class="docutils literal notranslate"><span class="pre">\n</span></code>), последовательности буфера или на фиксированные длины.</p></li>
<li><p>массив — сообщение разбивается либо на отдельные элементы массива, либо на массивы фиксированной длины.</p></li>
<li><p>объект — сообщение отправляется для каждой пары ключ/значение объекта.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id256">
<h6>Выходные значения<a class="headerlink" href="#id256" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parts</span></code>:</p>
<ul>
<li><p>Это свойство содержит информацию о том, как сообщение было разделено с исходным сообщением. Если передать его в узел соединения , последовательность может быть повторно собрана в одно сообщение. Свойство имеет следующие свойства:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - идентификатор группы сообщений</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> - положение в группе</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code>- если известно, общее количество сообщений в группе.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - тип сообщения - строка/массив/объект/буфер</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ch</span></code> - для строки или буфера данные, используемые для разделения сообщения как строки или массива байтов</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - для объекта, ключ свойства, из которого было создано это сообщение. Узел можно настроить на копирование этого значения в другие свойства сообщения, например <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len</span></code> - длина каждого сообщения при разделении с использованием фиксированного значения длины</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="id257">
<h5>Подробности<a class="headerlink" href="#id257" title="Ссылка на этот заголовок"></a></h5>
<p>Этот узел позволяет легко создать поток, который выполняет общие действия в последовательности сообщений, прежде чем с помощью узла join объединить последовательность в одно сообщение.</p>
<p>Он использует свойство <code class="docutils literal notranslate"><span class="pre">msg.parts</span></code> для отслеживания отдельных частей последовательности.</p>
</section>
</section>
<section id="sort">
<h4>sort<a class="headerlink" href="#sort" title="Ссылка на этот заголовок"></a></h4>
<section id="id258">
<h5>Что такое узел сортировки в U-Logic?<a class="headerlink" href="#id258" title="Ссылка на этот заголовок"></a></h5>
<p>Узел сортировки в U-Logic — это функциональный узел, используемый для сортировки либо массива данных в сообщении, либо последовательности самих сообщений, в порядке возрастания или убывания.</p>
</section>
<section id="id259">
<h5>Настройка узла сортировки<a class="headerlink" href="#id259" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p>Сортировать:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">msg.&lt;property&gt;</span></code>: Укажите свойство сообщения, которое содержит данные массива и которое необходимо отсортировать.</p></li>
<li><p>последовательности сообщений: сортировка последовательности сообщений. Выбор этого узла сортировки зависит от полученных сообщений, которые должны быть установлены в <code class="docutils literal notranslate"><span class="pre">msg.parts</span></code>. Узел split генерирует это свойство, но его можно создать вручную. Он имеет следующие свойства:</p>
<ul>
<li><p>id: Идентификатор группы сообщений.</p></li>
<li><p>index: Положение в группе.</p></li>
<li><p>count: общее количество сообщений в группе.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Ключ:</p>
<ul>
<li><p>значение элемента: при выборе этого параметра массив будет отсортирован на основе значения элемента.</p></li>
<li><p>выражение: укажите выражение JSONata для сортировки значений свойств.</p></li>
</ul>
</li>
<li><p>Порядок:</p>
<ul>
<li><p>восходящий: сортирует данные в порядке возрастания.</p></li>
<li><p>нисходящий: сортирует данные в порядке убывания.</p></li>
</ul>
</li>
<li><p>как число: если этот параметр отмечен, значения рассматриваются как числа для числового упорядочения.</p></li>
</ul>
</section>
<section id="id260">
<h5>Варианты использования<a class="headerlink" href="#id260" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p><strong>Обработка данных</strong>: Узлы sort часто используются в конвейерах обработки данных, где необходимо упорядочить данные в определенном порядке перед дальнейшей обработкой. Например, сортировка списка элементов по алфавиту или по номерам перед выполнением анализа или отображением данных.</p></li>
<li><p><strong>Последовательности сообщений</strong>: При работе с последовательностями сообщений узел sort может использоваться для упорядочивания сообщений на основе определенных критериев. Это особенно полезно при работе с потоками данных, где порядок сообщений имеет значение, например, при обработке данных временных рядов или потоков событий.</p></li>
<li><p><strong>Агрегация данных</strong>: При агрегации данных из нескольких источников узел сортировки может использоваться для организации агрегированных данных осмысленным образом. Это может включать сортировку данных на основе временных меток, числовых значений или любых других соответствующих критериев.</p></li>
<li><p><strong>Фильтрация и фильтрация</strong>: Сортировка данных упрощает отфильтровывание определенных элементов или выявление выбросов. Например, вы можете использовать узел soirt для определения самых высоких или самых низких значений в наборе данных или для фильтрации элементов, которые находятся выше или ниже определенного порога.</p></li>
</ul>
</section>
<section id="id261">
<h5>Примеры<a class="headerlink" href="#id261" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>В приведенном ниже примере узел sort сортирует массив чисел и массив английского алфавита в порядке возрастания.</p></li>
</ol>
<p><img alt="Пример использования узла sort" src="../_images/example12.png" /></p>
<ol class="arabic simple" start="2">
<li><p>В приведенном ниже примере узел sort сортирует последовательности сообщений в порядке возрастания на основе <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> свойств <code class="docutils literal notranslate"><span class="pre">quantity</span></code> каждого сообщения.</p></li>
</ol>
<p><img alt="Пример использования узла sort" src="../_images/example22.png" /></p>
</section>
<section id="id262">
<h5>Документация по узлу<a class="headerlink" href="#id262" title="Ссылка на этот заголовок"></a></h5>
<p>Узел sort, сортирующий свойство сообщения или последовательность сообщений.</p>
<p>При настройке на сортировку свойств сообщения узел сортирует данные массива, на которые указывает указанное свойство сообщения.</p>
<p>При настройке на сортировку последовательности сообщений порядок сообщений будет изменен.</p>
<p>Порядок сортировки может быть следующим:</p>
<ul class="simple">
<li><p>восходящий</p></li>
<li><p>нисходящий</p></li>
</ul>
<p>Для чисел можно задать числовую сортировку с помощью флажка «как число».</p>
<p>Ключом сортировки может быть значение элемента или выражение JSONata для сортировки значения свойства, или свойство сообщения или выражение JSONata для сортировки последовательности сообщений.</p>
<p>При сортировке последовательности сообщений узел sort зависит от наличия свойства msg.parts в полученных сообщениях. Узел split автоматически создаёт это свойство, но его можно задать вручную. Оно включает следующие свойства:</p>
<ul class="simple">
<li><p>id - идентификатор группы сообщений</p></li>
<li><p>index - положение в группе</p></li>
<li><p>count - общее количество сообщений в группе</p></li>
</ul>
</section>
</section>
<section id="batch">
<h4>batch<a class="headerlink" href="#batch" title="Ссылка на этот заголовок"></a></h4>
<section id="id263">
<h5>Где и почему мы используем узел batch?<a class="headerlink" href="#id263" title="Ссылка на этот заголовок"></a></h5>
<p>Узел batch используется для группировки последовательностей сообщений в пакеты.</p>
</section>
<section id="id264">
<h5>Режимы работы<a class="headerlink" href="#id264" title="Ссылка на этот заголовок"></a></h5>
<section id="id265">
<h6>Группировать по количеству сообщений<a class="headerlink" href="#id265" title="Ссылка на этот заголовок"></a></h6>
<p>Узел batch можно настроить для группировки сообщений в пакеты на основе количества сообщений в пакете.</p>
<p>Например, если вы установите размер пакета 5, то первые 5 сообщений будут сгруппированы в пакет перед выпуском. Затем следующие 5 сообщений будут сгруппированы в пакет и т. д.</p>
<p>Ниже представлен пример того, как это выглядит на практике.</p>
<p><img alt="Пример использования узла batch" src="../_images/example13.png" /></p>
<p>Кроме того, вы можете добавить перекрытие, чтобы последнее сообщение было включено в следующий пакет.</p>
<p><img alt="Пример использования узла batch" src="../_images/example23.png" /></p>
</section>
<section id="id266">
<h6>Группировать по временному интервалу<a class="headerlink" href="#id266" title="Ссылка на этот заголовок"></a></h6>
<p>Узел batch можно настроить для группировки сообщений в пакеты на основе периода времени.</p>
<p>Например, если установить время пакета на 2 секунды, то все сообщения, полученные в течение 2 секунд, будут сгруппированы в пакет перед выпуском. Затем будет создан следующий пакет на следующие 2 секунды и т. д.</p>
<p>Ниже представлен пример того, как это выглядит на практике.</p>
<p><img alt="Пример использования узла batch" src="../_images/example32.png" /></p>
</section>
<section id="id267">
<h6>Конкатенация последовательностей<a class="headerlink" href="#id267" title="Ссылка на этот заголовок"></a></h6>
<p>Узел batch можно настроить для объединения последовательностей сообщений в одно сообщение.</p>
<p>Например, вы можете использовать это для копирования последовательности сообщений или упорядочивания их по темам.</p>
<p>Ниже представлен пример того, как это выглядит на практике.</p>
<p><img alt="Пример использования узла batch" src="../_images/example42.png" /></p>
<p><img alt="Пример использования узла batch" src="../_images/example52.png" /></p>
</section>
</section>
<section id="id268">
<h5>Документация по узлу<a class="headerlink" href="#id268" title="Ссылка на этот заголовок"></a></h5>
<p>Создает последовательности сообщений на основе различных правил.</p>
<section id="id269">
<h6>Подробности<a class="headerlink" href="#id269" title="Ссылка на этот заголовок"></a></h6>
<p>Существует три режима создания последовательностей сообщений:</p>
<p><strong>Группировать по количеству сообщений</strong>: Группирует сообщения в последовательности заданной длины. Параметр «Совпадения» указывает, сколько сообщений в конце одной последовательности должны быть повторены в начале следующей последовательности.</p>
<p><strong>Группировать по интервалу времени</strong>: Группирует сообщения, которые приходят в течение указанного интервала. Если в течение интервала не приходит ни одного сообщения, узел может опционально отправить пустое сообщение.</p>
<p><strong>Объединять последовательности</strong>: Создает последовательность сообщений путем конкатенации входящих последовательностей. Каждое сообщение должно иметь свойство <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code> и свойство <code class="docutils literal notranslate"><span class="pre">msg.parts</span></code>, идентифицирующее его последовательность. Узел настраивается со списком значений <code class="docutils literal notranslate"><span class="pre">topic</span></code> для определения порядка, в котором конкатенируются последовательности.</p>
</section>
</section>
<section id="id270">
<h5>Хранение сообщений<a class="headerlink" href="#id270" title="Ссылка на этот заголовок"></a></h5>
<p>Этот узел будет буферизовать сообщения внутри, чтобы работать с последовательностями. Настройка времени выполнения <code class="docutils literal notranslate"><span class="pre">nodeMessageBufferMaxLength</span></code> может использоваться для ограничения количества сообщений, которые будут буферизировать узлы.</p>
<p>Если получено сообщение с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.reset</span></code>, буферизованные сообщения удаляются и не отправляются.</p>
</section>
</section>
<section id="join">
<h4>join<a class="headerlink" href="#join" title="Ссылка на этот заголовок"></a></h4>
<section id="join-u-logic">
<h5>Что такое узел Join в U-Logic?<a class="headerlink" href="#join-u-logic" title="Ссылка на этот заголовок"></a></h5>
<p>Узел join в U-Logic используется для объединения последовательностей сообщений в одно сообщение. Он особенно полезен при работе с несколькими входными потоками или когда вам нужно объединить данные из разных источников в одну полезную нагрузку.</p>
</section>
<section id="id271">
<h5>Настройка узла join<a class="headerlink" href="#id271" title="Ссылка на этот заголовок"></a></h5>
<ul class="simple">
<li><p>Режим:</p>
<ul>
<li><p>автоматический: когда узел объединения соединяется с узлом разделения, он автоматически объединяет сообщения, чтобы отменить выполненное разделение.</p></li>
<li><p>ручной: позволяет вручную выбирать, как следует объединять сообщения.</p>
<ul>
<li><p>Объединить каждый: позволяет выбрать, какие свойства сообщения должны быть объединены. Дополнительно позволяет выбрать полный объект сообщения для объединения.</p>
<ul>
<li><p>чтобы создать: указывает тип выходных данных, например строку, буфер, массив, объект ключ/значение или объединенный объект.</p></li>
<li><p>Отправить сообщение:</p>
<ul>
<li><p>после ряда частей сообщения: отправляет объединенное сообщение после получения указанного количества частей.</p>
<ul>
<li><p>и каждое последующее сообщение: продолжает отправлять сообщения по мере их поступления, но применяет указанное количество частей для каждого объединенного сообщения.</p></li>
</ul>
</li>
<li><p>по истечении времени с 1го сообщения: Ожидает тайм-аут после получения первой части сообщения. Если в течение указанного тайм-аута прибудет больше частей, они будут включены в объединенное сообщение. Тайм-аут можно перезапустить, отправив сообщение с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.restartTimeout</span></code>.</p></li>
<li><p>после сообщения с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.complete</span></code>: Если получено сообщение с <code class="docutils literal notranslate"><span class="pre">msg.complete</span></code> установленным свойством, выходное сообщение завершается и отправляется. Это сбрасывает все счетчики частей. Кроме того, если получено сообщение с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.reset</span></code>, частично завершенное сообщение удаляется и не отправляется, что также сбрасывает все счетчики частей.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>агрегация последовательности</p>
<ul>
<li><p>Агрегирующее выражение: выражение, применяемое к каждому сообщению в последовательности для объединения их в одно сообщение.</p></li>
<li><p>Начальное значение: начальное значение, используемое в процессе объединения.</p></li>
<li><p>Исправляющее значение: Необязательное выражение, используемое после объединения сообщений.</p>
<ul>
<li><p>Выполнять в обратном порядке (от последнего к первому): включение этой опции объединяет сообщения в обратном порядке, начиная с последнего сообщения.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id272">
<h5>Варианты использования<a class="headerlink" href="#id272" title="Ссылка на этот заголовок"></a></h5>
<p><strong>Агрегация данных с нескольких датчиков</strong>: Предположим, у вас есть несколько датчиков (например, температуры, влажности, давления), отправляющих данные независимо. Вы можете использовать узел join, чтобы объединить эти отдельные показания в одно сообщение для анализа или хранения.</p>
<p><strong>Последовательные операции</strong>: когда вам необходимо выполнить ряд операций, зависящих друг от друга, вы можете использовать узел join, чтобы убедиться, что все необходимые данные доступны, прежде чем переходить к следующему шагу.</p>
<p><strong>Создание сложных структур данных</strong>: объединяя несколько сообщений в одно сообщение с вложенными объектами или массивами, узел join упрощает создание сложных структур данных.</p>
<p><strong>Агрегация по времени</strong>: если вам необходимо агрегировать данные за определенный период времени (например, почасовые средние значения, дневные итоги), узел join может накапливать данные в течение этого интервала и выводить агрегированные результаты.</p>
<p><strong>Обработка параллельных рабочих процессов</strong>: в рабочих процессах, где одновременно выполняется несколько задач и их результаты необходимо синхронизировать или агрегировать, узел join помогает управлять параллельным выполнением и консолидировать результаты.</p>
<p><strong>Пакетная обработка</strong>: если вы хотите обрабатывать данные пакетами, а не по отдельности, узел join может накапливать сообщения до тех пор, пока не будет достигнуто указанное количество или пороговое значение времени, а затем выдавать объединенное сообщение для пакетной обработки.</p>
</section>
<section id="id273">
<h5>Примеры<a class="headerlink" href="#id273" title="Ссылка на этот заголовок"></a></h5>
<ol class="arabic simple">
<li><p>В приведенном ниже примере узел join использует автоматический режим для повторного присоединения сообщения, разделенного узлом split.</p></li>
</ol>
<p><img alt="Пример использования узла join" src="../_images/example14.png" /></p>
<ol class="arabic simple" start="2">
<li><p>В приведенном ниже примере узел Join использует ручной режим для объединения трех свойств полезной нагрузки в одно на основе значения объекта <code class="docutils literal notranslate"><span class="pre">msg.topic</span></code>.</p></li>
</ol>
<p><img alt="Пример использования узла join" src="../_images/example24.png" /></p>
<ol class="arabic simple" start="3">
<li><p>В приведенном ниже примере узел Join вычисляет размер массива, использующий агрегирующее выражение.</p></li>
</ol>
<p><img alt="Пример использования узла join" src="../_images/example33.png" /></p>
</section>
<section id="id274">
<h5>Документация по узлу<a class="headerlink" href="#id274" title="Ссылка на этот заголовок"></a></h5>
<p>Объединяет последовательности сообщений в одно сообщение.</p>
<p>Доступны три режима:</p>
<ul class="simple">
<li><p>автоматический: При сопряжении с узлом разделения он автоматически объединяет сообщения, чтобы отменить выполненное разделение.</p></li>
<li><p>ручной: Объединяйте последовательности сообщений различными способами.</p></li>
<li><p>агрегация последовательности: Примените выражение ко всем сообщениям в последовательности, чтобы свести ее к одному сообщению.</p></li>
</ul>
<section id="id275">
<h6>Входные значения<a class="headerlink" href="#id275" title="Ссылка на этот заголовок"></a></h6>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parts</span></code>: Для автоматического присоединения последовательности сообщений, все они должны иметь это свойство. Узел split генерирует это свойство, но его можно создать вручную. Он имеет следующие свойства:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - идентификатор группы сообщений</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> - положение в группе</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code> - общее количество сообщений в группе</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - тип сообщения - строка/массив/объект/буфер</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ch</span></code> - для строки или буфера данные, используемые для разделения сообщения как строки или массива байтов</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - для объекта — ключ свойства, из которого было создано это сообщение</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len</span></code> - длина каждого сообщения при разделении с использованием фиксированного значения длины</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">complete</span></code>: Если установлено, узел добавит payload, а затем отправит выходное сообщение в его текущем состоянии. Если вы не хотите добавлять payload, удалите ее из сообщения.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code>: Если установлено, узел очистит любое частично завершенное сообщение и не отправит его.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restartTimeout</span></code>: Если установлено и на узле настроен тайм-аут, этот тайм-аут будет перезапущен.</p></li>
</ul>
</section>
<section id="id276">
<h6>Подробности<a class="headerlink" href="#id276" title="Ссылка на этот заголовок"></a></h6>
<p><strong>автоматический</strong></p>
<p>Автоматический режим использует свойство входящих сообщений <code class="docutils literal notranslate"><span class="pre">parts</span></code> для определения того, как должна быть объединена последовательность. Это позволяет автоматически отменить действие узла split.</p>
<p><strong>ручной</strong></p>
<p>При настройке на присоединение в ручном режиме узел способен объединять последовательности сообщений в ряд различных результатов:</p>
<p>строка или буфер — создаются путем объединения выбранного свойства каждого сообщения с указанными символами объединения или буфером.
массив — создается путем добавления каждого выбранного свойства или всего сообщения в выходной массив.
объект ключ /значение — создается путем использования свойства каждого сообщения для определения ключа, под которым хранится требуемое значение.
объединенный объект — создается путем объединения свойств каждого сообщения в один объект.
Остальные свойства выходного сообщения берутся из последнего сообщения, полученного перед отправкой результата.</p>
<p>Можно задать счетчик для того, сколько сообщений должно быть получено перед генерацией выходного сообщения. Для выходов объектов, как только этот счетчик будет достигнут, узел может быть настроен на отправку сообщения для каждого последующего полученного сообщения.</p>
<p>Можно задать тайм-аут для запуска отправки нового сообщения с использованием того, что было получено до сих пор. Этот тайм-аут можно перезапустить, отправив сообщение с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.restartTimeout</span></code>.</p>
<p>Если получено сообщение с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.complete</span></code>, выходное сообщение завершается и отправляется. Это сбрасывает все счетчики частей.</p>
<p>Если сообщение получено с установленным свойством <code class="docutils literal notranslate"><span class="pre">msg.reset</span></code>, частично заполненное сообщение удаляется и не отправляется. Это сбрасывает все счетчики частей.</p>
<p><strong>агрегация последовательности</strong>
При настройке на объединение в режиме сокращения выражение применяется к каждому сообщению в последовательности, а результат накапливается для создания одного сообщения.</p>
<ul class="simple">
<li><p>Начальное значение: Начальное значение накопленной величины (<code class="docutils literal notranslate"><span class="pre">$A</span></code>).</p></li>
<li><p>Агрегирующее выражение: Выражение JSONata, которое вызывается для каждого сообщения в последовательности. Результат передается следующему вызову выражения как накопленное значение. В выражении могут использоваться следующие специальные переменные:</p>
<ul>
<li><p>$A: накопленное значение</p></li>
<li><p>$I: индекс сообщения в последовательности</p></li>
<li><p>$N: количество сообщений в последовательности</p></li>
</ul>
</li>
<li><p>Исправляющее значение: Необязательное выражение JSONata, которое применяется после того, как «Агрегирующее выражение» было применено ко всем сообщениям в последовательности. В выражении могут использоваться следующие специальные переменные:</p>
<ul>
<li><p>$A: накопленное значение</p></li>
<li><p>$N: количество сообщений в последовательности</p></li>
</ul>
</li>
</ul>
</section>
<section id="id277">
<h6>Хранение сообщений<a class="headerlink" href="#id277" title="Ссылка на этот заголовок"></a></h6>
<p>Этот узел будет буферизовать сообщения внутри, чтобы работать с последовательностями. Настройка времени выполнени <code class="docutils literal notranslate"><span class="pre">nodeMessageBufferMaxLength</span></code> может использоваться для ограничения количества сообщений, которые будут буферизировать узлы.</p>
</section>
</section>
</section>
</section>
<section id="id278">
<h3>анализатор<a class="headerlink" href="#id278" title="Ссылка на этот заголовок"></a></h3>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Нижняя область">
        <a href="../guide.html" class="btn btn-neutral float-left" title="Начало работы с контроллером Uvatron 3000PRO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Предыдущая</a>
        <a href="../UI-Designer.html" class="btn btn-neutral float-right" title="UI-Designer" accesskey="n" rel="next">Следующая <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Авторские права 2025, uvatron.ru. </p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>